<html>
<head>
<title>Part 1: Building a Complete API in Go to Interact with a P2P Escrow Smart Contract using go-ethereum Client &amp; GoFiber Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç¬¬1éƒ¨åˆ†:åœ¨Goä¸­æ„å»ºä¸€ä¸ªå®Œæ•´çš„APIï¼Œä½¿ç”¨go-ethereumå®¢æˆ·ç«¯å’ŒGoFiberæ¡†æ¶ä¸P2Pæ‰˜ç®¡æ™ºèƒ½å¥‘çº¦è¿›è¡Œäº¤äº’</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/coinmonks/part-1-building-a-complete-api-in-go-to-interact-with-a-p2p-escrow-smart-contract-using-9cf1f681c860?source=collection_archive---------5-----------------------#2022-11-29">https://medium.com/coinmonks/part-1-building-a-complete-api-in-go-to-interact-with-a-p2p-escrow-smart-contract-using-9cf1f681c860?source=collection_archive---------5-----------------------#2022-11-29</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/094b4b7854f4ce57afc59360ad582edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5a1o8w31T-WzODa3Su3FcQ.png"/></div></div></figure><p id="7bae" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™æ˜¯æœ¬ç³»åˆ—ä¸¤ç¯‡æ–‡ç« çš„ç¬¬ä¸€éƒ¨åˆ†</p><ul class=""><li id="0bdb" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">ç¬¬1éƒ¨åˆ†:é¡¹ç›®æ¦‚è¿°ã€è®¾ç½®çº¤ç¨‹ã€ç”ŸæˆGoç»‘å®šã€éƒ¨ç½²åˆåŒã€æ·»åŠ get Escrow &amp; Walleté€»è¾‘åœ°å€ç«¯ç‚¹</li><li id="8524" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated"><a class="ae kn" rel="noopener" href="/coinmonks/part-2-building-a-complete-api-in-go-to-interact-with-a-p2p-escrow-smart-contract-using-fa0514531032">ç¬¬äºŒéƒ¨åˆ†:æ·»åŠ å’Œç»“æŸP2P APIç«¯ç‚¹</a></li></ul><p id="e2ed" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä½ å¯ä»¥åœ¨<a class="ae kn" href="https://github.com/alofeoluwafemi/-smart-contract-api-go-ethereum" rel="noopener ugc nofollow" target="_blank"> GitHub </a>ä¸Šæ‰¾åˆ°ä»£ç åº“ä½œä¸ºå‚è€ƒã€‚</p><p id="b31b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™é‡Œæ˜¯APIé‚®å·®é›†<a class="ae kn" href="https://www.getpostman.com/collections/362a5590ccf482592588" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a>ä¾›ä½ å¯¼å…¥ã€‚</p><h1 id="e26e" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">ä»‹ç»</h1><p id="1488" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated"><a class="ae kn" href="https://geth.ethereum.org/" rel="noopener ugc nofollow" target="_blank"> Goä»¥å¤ªåŠ</a>æ˜¯ä»¥å¤ªåŠåè®®çš„å®˜æ–¹Goå®ç°ã€‚çŸ¿å·¥å¯ä»¥ä½¿ç”¨å®ƒæ¥è¿è¡Œä»¥å¤ªåŠèŠ‚ç‚¹ï¼ŒDappå¼€å‘äººå‘˜(å¦‚æ‚¨)å¯ä»¥ä½¿ç”¨å®ƒçš„ä¸€äº›åŒ…æ¥å°†æ‚¨çš„æ™ºèƒ½åˆçº¦ç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼Œå°†å…¶éƒ¨ç½²åˆ°ç½‘ç»œï¼Œå¹¶ä½¿ç”¨å®ƒä¸æ‚¨éƒ¨ç½²çš„æ™ºèƒ½åˆçº¦è¿›è¡Œäº¤äº’ã€‚</p><p id="aadc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae kn" href="https://gofiber.io/" rel="noopener ugc nofollow" target="_blank"> Go Fiber framework </a>å¦ä¸€æ–¹é¢ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ„å»ºåœ¨Fasthttpä¹‹ä¸Šçš„Go webæ¡†æ¶ï¼Œfast httpæ˜¯Goæœ€å¿«çš„HTTPå¼•æ“ã€‚å®ƒä¸Node express frameworkçš„ç›¸ä¼¼æ€§å’Œæ˜“ç”¨æ€§ä½¿å¾—å®ƒå¯¹æ–°çš„goå¼€å‘äººå‘˜æ¥è¯´å¾ˆæœ‰å¸å¼•åŠ›ï¼Œå¯ä»¥ç”¨æ¥ä¸ºä»–ä»¬çš„é¡¹ç›®æ„å»ºAPIã€‚å°±æˆ‘ä¸ªäººè€Œè¨€ï¼Œå½“æˆ‘å¼€å§‹å†™Go langæ—¶ï¼Œæˆ‘å‘ç°å®ƒå¾ˆå®¹æ˜“ç†è§£å¹¶å¾ˆå¿«ä¸Šæ‰‹ã€‚</p><h1 id="15b2" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">ä½ å°†å­¦åˆ°ä»€ä¹ˆ</h1><p id="4490" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">å¯¹äºæœ¬æ•™ç¨‹ï¼Œæˆ‘å°†ä½¿ç”¨ç°æœ‰çš„æ™ºèƒ½åˆåŒï¼Œè¿™æ˜¯PiggyFi åœ¨<a class="ae kn" href="https://piggyfi.africa/" rel="noopener ugc nofollow" target="_blank"> Payä¸Šæ»¡è¶³P2På¹³å°çš„ç¬¬ä¸€ç¨¿ä¹‹ä¸€ï¼Œå®ƒæ˜¯åœ¨æˆ‘ä»¬å‚åŠ çš„ä¸€æ¬¡é»‘å®¢é©¬æ‹‰æ¾ä¸­ä½œä¸ºæ¦‚å¿µè¯æ˜è€Œç¼–å†™çš„ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œ</a><a class="ae kn" href="https://github.com/orignellc/piggyfi-contracts-poc" rel="noopener ugc nofollow" target="_blank">æ‰¾åˆ°ä»£ç åº“</a>å› ä¸ºè¿™ä¸ªç³»åˆ—çš„ç›®æ ‡ä¸æ˜¯å…³æ³¨æ„å»ºä¸€ä¸ªæ™ºèƒ½å¥‘çº¦ï¼Œè€Œæ˜¯ä¸€ä¸ªåœ¨goä¸­ä¸ä¹‹äº¤äº’çš„APIï¼Œè¿™ä¸ªå¥‘çº¦æœåŠ¡äºæˆ‘ä»¬çš„ä½¿ç”¨ã€‚</p><p id="4119" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä¸è¦æ‹…å¿ƒï¼Œæˆ‘å°†åœ¨ä¸‹é¢åšä¸€ä¸ªæ™ºèƒ½åˆåŒçš„åˆ†è§£</p><h1 id="e628" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">å›°éš¾</h1><ul class=""><li id="75df" class="jz ka ht jd b je lm ji ln jm lr jq ls ju lt jy ke kf kg kh dt translated">åˆå­¦âœ…</li><li id="3d67" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">ä¸­é—´âœ…</li></ul><h1 id="ea8c" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">è¦æ±‚</h1><p id="509d" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">ä¸ºäº†ä»æœ¬æ•™ç¨‹ä¸­è·å¾—æœ€ä½³æ•ˆæœï¼Œéœ€è¦å¯¹å›´æ£‹æœ‰ä¸€äº›åŸºæœ¬çš„äº†è§£ã€‚å¯¹äºæˆ‘é€‰æ‹©çš„ç¼–è¾‘å™¨ï¼Œæˆ‘å°†ä½¿ç”¨<a class="ae kn" href="https://www.jetbrains.com/go/" rel="noopener ugc nofollow" target="_blank"> go-land </a>ï¼Œåœ¨æˆ‘çœ‹æ¥è¿™æ˜¯ç›®å‰æœ€å¥½çš„go-langç¼–è¾‘å™¨ã€‚</p><p id="d953" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">é™¤äº†å®‰è£…æœ€æ–°çš„<a class="ae kn" href="https://docs.soliditylang.org/en/v0.8.9/installing-solidity.html" rel="noopener ugc nofollow" target="_blank"> solidityç¼–è¯‘å™¨</a>å’Œæ˜¾ç„¶æœ€æ–°çš„<a class="ae kn" href="https://go.dev/doc/install" rel="noopener ugc nofollow" target="_blank"> goç¼–è¯‘å™¨</a>æ˜¯ä¸€ä¸ªè¦æ±‚ã€‚</p><p id="0fac" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ­¤å¤–ï¼Œç¡®ä¿ä»Goerli å¤„è·å¾—ä¸€äº›<a class="ae kn" href="https://goerlifaucet.com/" rel="noopener ugc nofollow" target="_blank">æµ‹è¯•ETHï¼Œåœ¨éƒ¨ç½²å’Œä¸æ™ºèƒ½åˆåŒäº¤äº’æ—¶å°†éœ€è¦æ”¯ä»˜å¤©ç„¶æ°”è´¹ã€‚</a></p><h1 id="ca0c" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">ç›®å½•</h1><h2 id="78b3" class="lu kp ht bd kq lv lw lx ku ly lz ma ky jm mb mc lc jq md me lg ju mf mg lk mh dt translated">æœ¬æ–‡çš„ç¬¬1éƒ¨åˆ†åŒ…æ‹¬</h2><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="d50f" class="mr kp ht mn b be ms mt l mu mv">- Project Overview<br/>- Setup Fiber, .env &amp; Install dependecies<br/>- Deploy Smart Contracts on Goeril Testnet<br/>- Generate Go Binding for Contracts<br/>- Build out API Endpoints<br/> - POST request to Deploy Contracts<br/>  - USDC<br/>  - Factory<br/> - GET request to get CustodianWalletLogic  Address<br/> - GET request to get Escrow Contract Address</span></pre><h2 id="e469" class="lu kp ht bd kq lv lw lx ku ly lz ma ky jm mb mc lc jq md me lg ju mf mg lk mh dt translated">æœ¬æ–‡çš„ç¬¬2éƒ¨åˆ†åŒ…æ‹¬</h2><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="c2c7" class="mr kp ht mn b be ms mt l mu mv">- POST request to set USDC address on the Escrow contract<br/>- POST request to Deploy a new custodian wallet address<br/>- POST request to open a buy P2P order with USDC Balance<br/>- POST request to open a sell P2P order with USDC Balance<br/>- Handle Revert Errors in response<br/>- GET request to Get open orders for a vendor<br/>- GET request to Get order by ID </span></pre><h2 id="6d3e" class="lu kp ht bd kq lv lw lx ku ly lz ma ky jm mb mc lc jq md me lg ju mf mg lk mh dt translated">ç¬¬ä¸‰éƒ¨åˆ†DIY(è‡ªå·±åŠ¨æ‰‹)ğŸ¤“</h2><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="a4f6" class="mr kp ht mn b be ms mt l mu mv">- POST request to open a sell P2P order with USDC Balance<br/>- GET request to Get open orders for a vendor<br/>- GET request to Get order by ID<br/>- POST request to cancel P2P order</span></pre><h1 id="ba03" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">é¡¹ç›®æ¦‚è¿°</h1><p id="6192" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">Piggyfiæ™ºèƒ½åˆçº¦çš„è¿™ä¸ªç‰ˆæœ¬æ˜¯ä¸€ä¸ªç®€å•çš„æ‰˜ç®¡ç³»ç»Ÿï¼Œç”¨äºåœ¨ä¾›åº”å•†å’Œå¸Œæœ›å°†è²äºšç‰¹å…‘æ¢æˆç¾å…ƒçš„å®¢æˆ·ä¹‹é—´è¿›è¡ŒP2Päº¤æ˜“ã€‚</p><p id="c868" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> Factory: </strong>è¿™ä¸ªæ™ºèƒ½å¥‘çº¦è´Ÿè´£éƒ¨ç½²ä¸€ä¸ªæ–°çš„CustodianWalletProxyï¼Œå®ƒåœ¨æ¯æ¬¡æ–°ç”¨æˆ·æ ¹æ®ç”¨æˆ·é…ç½®æ–‡ä»¶æ³¨å†Œæ—¶å……å½“ä¾›åº”å•†æˆ–å®¢æˆ·çš„é’±åŒ…ã€‚<br/><br/><strong class="jd hu">CustodianWalletProxy:</strong>è¿™æ˜¯ä½œä¸ºé’±åŒ…éƒ¨ç½²ç»™æ¯ä¸ªç”¨æˆ·çš„å¥‘çº¦ã€‚å®ƒä½¿ç”¨å§”æ‰˜è°ƒç”¨æ¥ä½¿ç”¨CustodianWalleté€»è¾‘å¥‘çº¦ä¸­çš„å®é™…é€»è¾‘ï¼Œé™¤äº†å›è°ƒæ–¹æ³•å’Œæ„é€ å‡½æ•°ä¹‹å¤–ï¼Œå®ƒæœ¬èº«ä¸åŒ…å«ä»»ä½•æœ‰æ„ä¹‰çš„å‡½æ•°ã€‚<br/> <strong class="jd hu">ç±»å‹:</strong>è¿™ä¿å­˜äº†ä»£ç†å’Œé€»è¾‘é’±åŒ…å¥‘çº¦ä¹‹é—´å…±äº«çš„å…¬å…±å˜é‡ï¼Œä»¥é¿å…å†™å¾—ä¸å¥½çš„ä»£ç†å¥‘çº¦å¸¸è§çš„å¯æ€•çš„å­˜å‚¨è¦†ç›–é—®é¢˜ã€‚<br/> <strong class="jd hu"> USDC: </strong>è¿™ä¸ªåˆåŒä»æ¥æ²¡æœ‰éƒ¨ç½²åˆ°ç”Ÿäº§ä¸­ï¼Œå®ƒåªæ˜¯ç”¨æ¥åœ¨æµ‹è¯•ç¯å¢ƒä¸­æ¨¡ä»¿USDCï¼Œç»™æˆ‘ä»¬çµæ´»æ€§å’Œå¯¹é“¸é€ çš„æ§åˆ¶ã€‚åœ¨ç”Ÿäº§ä¸­ï¼Œè¯¥åœ°å€å°†ç”¨äºæ‰˜ç®¡åˆåŒä¸­çš„USDCã€‚</p><h1 id="46ac" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">è®¾ç½®å…‰çº¤ã€‚ç¯å¢ƒå’Œå®‰è£…ä¾èµ–é¡¹</h1><p id="3be4" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">å¦‚æœä½ æ­£åœ¨ä½¿ç”¨Goland IDEï¼Œåˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®å°±åƒæ‰“å¼€ä½ çš„IDEä¸€æ ·ç®€å•ï¼Œåœ¨èœå•ä¸Šç‚¹å‡»<strong class="jd hu">æ–‡ä»¶&gt;æ–°å»º&gt;é¡¹ç›®</strong>ã€‚ä¸è¦å¿˜è®°æŠŠé»˜è®¤çš„åå­—<code class="eh mw mx my mn b">awesomeProject</code>æ”¹æˆä½ æƒ³è¦çš„åå­—ï¼Œæˆ‘ç”¨<code class="eh mw mx my mn b">go-ethereum-api</code>ä½œä¸ºæˆ‘çš„åå­—ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mz"><img src="../Images/284a0c0939301b1fd2ed2ad5d51ea06b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3SNyK9KoZkH63ao7.png"/></div></div></figure><p id="ed3c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å¯¹äºå…¶ä»–IDEï¼Œå¦‚VScodeï¼Œåˆ›å»ºæ‚¨çš„é¡¹ç›®ä¸»ç®¡ï¼Œç„¶åä»ç»ˆç«¯è¿è¡Œä¸‹é¢çš„å‘½ä»¤æ¥ç”Ÿæˆæ‚¨çš„<code class="eh mw mx my mn b">go.mod</code>æ–‡ä»¶ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="554f" class="mr kp ht mn b be ms mt l mu mv">go mod init github.com/GITHUB_USER_NAME/go-ethereum-api</span></pre><p id="4bca" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è®°å¾—ç”¨ä½ çš„GitHubç”¨æˆ·åæ›¿æ¢<code class="eh mw mx my mn b">GITHUB_USER_NAME</code>ã€‚</p><p id="c94b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">ä¸‹ä¸€æ­¥</strong>ï¼Œè¿è¡Œå®‰è£…çº¤ç»´æ¡†æ¶</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="f5b8" class="mr kp ht mn b be ms mt l mu mv">go get github.com/gofiber/fiber/v2</span></pre><p id="8c4c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ç°åœ¨ï¼Œæ‚¨æƒ³è¦åˆ›å»ºä¸€ä¸ª<code class="eh mw mx my mn b">package main.go</code>æ–‡ä»¶å¹¶å°†ä¸‹é¢çš„ä»£ç ç²˜è´´åˆ°å…¶ä¸­ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="f465" class="mr kp ht mn b be ms mt l mu mv">package main<br/><br/>import (<br/> "github.com/gofiber/fiber/v2"<br/> "log"<br/>)<br/><br/>func main() {<br/> app := fiber.New()<br/><br/> app.Get("/", func(c *fiber.Ctx) error {<br/>  return c.SendString("Hello, World!")<br/> })<br/><br/> err := app.Listen(":3000")<br/><br/> if err != nil {<br/>  return<br/> }<br/><br/>}</span></pre><p id="311b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä»æ‚¨çš„ç»ˆç«¯è¿è¡Œ</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="f14b" class="mr kp ht mn b be ms mt l mu mv">go run server.go</span></pre><p id="7a25" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ‚¨åº”è¯¥ä¼šåœ¨ç»ˆç«¯ä¸­çœ‹åˆ°ç±»ä¼¼çš„å†…å®¹ï¼Œè¡¨æ˜ä¸€åˆ‡éƒ½è¿è¡Œè‰¯å¥½ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="92af" class="mr kp ht mn b be ms mt l mu mv"> â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” <br/> â”‚                   Fiber v2.37.0                   â”‚ <br/> â”‚               http://127.0.0.1:3000               â”‚ <br/> â”‚       (bound on host 0.0.0.0 and port 3000)       â”‚ <br/> â”‚                                                   â”‚ <br/> â”‚ Handlers ............. 2  Processes ........... 1 â”‚ <br/> â”‚ Prefork ....... Disabled  PID ............. 57556 â”‚ <br/> â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span></pre><p id="10f7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è®¿é—®<a class="ae kn" href="http://127.0.0.1:3000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:3000 </a>ä½ ä¼šçœ‹åˆ°<strong class="jd hu">ä½ å¥½ï¼Œä¸–ç•Œï¼ä¸å¤šï¼Œä½†æ˜¯ä½¿ç”¨go Fiberå»ºç«‹ä¸€ä¸ªHTTPæœåŠ¡å™¨å°±é‚£ä¹ˆå¿«ã€‚</strong></p><p id="87cc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ­£ç¡®è®¾ç½®æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç»“æ„ï¼Œä½†åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œå®‰è£…ä»¥ä¸‹ä¾èµ–é¡¹ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="3951" class="mr kp ht mn b be ms mt l mu mv">go get github.com/joho/godotenv<br/>go get github.com/ethereum/go-ethereum</span></pre><h1 id="02df" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">æ–‡ä»¶å¤¹ç»“æ„</h1><p id="f849" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">æ›´æ–°æ‚¨çš„é¡¹ç›®ç»“æ„ä»¥åŒ¹é…ä¸‹å›¾ã€‚åˆ«æ‹…å¿ƒï¼Œä¸€åˆ‡å¾ˆå¿«å°±ä¼šæœ‰æ„ä¹‰çš„ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div class="fe ff na"><img src="../Images/d995d792e0313532e2c8118f6249d400.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/0*o2Jc5mULAF-1mzDK.png"/></div></figure><p id="d5fc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">è·¯ç”±å™¨:</strong>è·¯ç”±å™¨åŒ…æ˜¯å®šä¹‰æ‰€æœ‰è·¯ç”±çš„åœ°æ–¹ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªè·¯ç”±å™¨æ¥å£ï¼Œå…è®¸æˆ‘ä»¬æ‹¥æœ‰ä¸åŒç±»å‹çš„è·¯ç”±å™¨ï¼Œå¦‚APIè·¯ç”±å™¨ã€HTTPè·¯ç”±å™¨ç­‰ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨æ¥å£ä¸Šå®šä¹‰æ‰€æœ‰è·¯ç”±å™¨éƒ½å¿…é¡»å®ç°çš„æ–¹æ³•ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥ç¡®ä¿æˆ‘ä»¬çš„è·¯ç”±å™¨å°†ä»¥æŸç§æ–¹å¼è¿è¡Œï¼Œæ­£å¦‚æ‚¨å°†åœ¨ä¸‹é¢çœ‹åˆ°çš„<code class="eh mw mx my mn b">InstallRouter</code>æ–¹æ³•çš„æƒ…å†µã€‚</p><p id="003d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">pkg/router/router _ interface . go</strong></p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="73ce" class="mr kp ht mn b be ms mt l mu mv">package router<br/><br/>import "github.com/gofiber/fiber/v2"<br/><br/>type Router interface {<br/> InstallRouter(app *fiber.App)<br/>}</span></pre><p id="0ebf" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">pkg/router/API _ router . go</strong></p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="624e" class="mr kp ht mn b be ms mt l mu mv">package router<br/><br/>import (<br/>	"github.com/alofeoluwafemi/go-ethereum-api/app/controllers"<br/>	"github.com/gofiber/fiber/v2"<br/>	"github.com/gofiber/fiber/v2/middleware/limiter"<br/>)<br/><br/>type ApiRouter struct {<br/>}<br/><br/>func (h ApiRouter) InstallRouter(app *fiber.App) {<br/>	api := app.Group("/api/v1", limiter.New())<br/><br/>	api.Get("/", controllers.RenderHello)<br/>}<br/><br/>func NewApiRouter() *ApiRouter {<br/>	return &amp;ApiRouter{}<br/>}</span></pre><p id="220c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> pkg/router/setup.go </strong></p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="7ef9" class="mr kp ht mn b be ms mt l mu mv">package router<br/><br/>import (<br/>	"github.com/gofiber/fiber/v2"<br/>)<br/><br/>func InstallRouter(app *fiber.App) {<br/>	setup(app, NewApiRouter())<br/><br/>	//If no route was matched<br/>	app.Use(func(c *fiber.Ctx) error {<br/>		err := c.SendStatus(404)<br/>		panic(err)<br/>	})<br/>}<br/><br/>func setup(app *fiber.App, router ...Router) {<br/>	for _, r := range router {<br/>		r.InstallRouter(app)<br/>	}<br/>}</span></pre><p id="0fb3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">âš ï¸:è®°å¾—ç”¨ä¸ä½ çš„<code class="eh mw mx my mn b">go.mod</code>å¯¹åº”çš„ç”¨æˆ·åæ›¿æ¢å¯¼å…¥ä¸­çš„GitHubç”¨æˆ·åã€‚</p><p id="2f7a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ‚¨ä¼šæ³¨æ„åˆ°æˆ‘ä»¬åœ¨è·¯ç”±ä¸­å¯¼å…¥äº†æ§åˆ¶å™¨åŒ…ï¼Œä½†æ˜¯å®ƒä¸èƒ½è¢«è§£æã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p id="03ef" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">æ§åˆ¶å™¨:</strong>æ§åˆ¶å™¨åŒ…çš„ç›®çš„å¾ˆç®€å•ï¼Œå°±æ˜¯ä»è·¯ç”±åŒ…ä¸­æŠ½è±¡å‡ºé€»è¾‘ï¼Œä½¿äº‹æƒ…å˜å¾—ç®€å•ã€‚</p><p id="7d74" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">app/controllers/main _ controller . go</strong></p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="cfbd" class="mr kp ht mn b be ms mt l mu mv">package controllers<br/><br/>import "github.com/gofiber/fiber/v2"<br/><br/>func RenderHello(c *fiber.Ctx) error {<br/>	return c.Status(fiber.StatusOK).JSON(fiber.Map{<br/>		"message": "Hello from api",<br/>	})<br/>}</span></pre><p id="5441" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">env:</strong>envåŒ…æ˜¯ä¸€ä¸ªåŠ©æ‰‹å·¥å…·ï¼Œå®ƒä½¿ç”¨<code class="eh mw mx my mn b">godotenv</code>åŒ…æ¥è¯»å–æˆ‘ä»¬ä¸æƒ³å‘å¸ƒçš„ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„ç§é’¥å’ŒAlchemy APIå¯†é’¥ã€‚</p><p id="fe09" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> pkg/env/env.go </strong></p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="d9ef" class="mr kp ht mn b be ms mt l mu mv">package env<br/><br/>import "github.com/joho/godotenv"<br/><br/>var Env map[string]string<br/><br/>func GetEnv(key, def string) string {<br/>	if val, ok := Env[key]; ok {<br/>		return val<br/>	}<br/>	return def<br/>}<br/><br/>func SetupEnvFile() {<br/>	envFile := ".env"<br/>	var err error<br/>	Env, err = godotenv.Read(envFile)<br/>	if err != nil {<br/>		panic(err)<br/>	}<br/><br/>}</span></pre><p id="e57e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">bootstrap:</strong>bootstrapåŒ…å°±æ˜¯ä½ æ‰€è¯´çš„appç‚¹ç«ã€‚å®ƒåˆ›å»ºä¸€ä¸ªæ–°çš„<strong class="jd hu">åº”ç”¨</strong>å‘½åå®ä¾‹ï¼Œæ³¨å†Œè·¯ç”±å™¨å’Œä¸­é—´ä»¶ï¼Œå¦‚æœä½ æƒ³åœ¨æœªæ¥åˆå§‹åŒ–ä½ çš„æ•°æ®åº“ï¼Œä½ å¯ä»¥åœ¨è¿™é‡Œè¿™æ ·åšã€‚</p><p id="47ea" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> bootstrap/bootstrap.go </strong></p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="76e6" class="mr kp ht mn b be ms mt l mu mv">package bootstrap<br/><br/>import (<br/>	"github.com/alofeoluwafemi/go-ethereum-api/pkg/env"<br/>	"github.com/alofeoluwafemi/go-ethereum-api/pkg/router"<br/>	"github.com/gofiber/fiber/v2"<br/>	"github.com/gofiber/fiber/v2/middleware/logger"<br/>	"github.com/gofiber/fiber/v2/middleware/recover"<br/>)<br/><br/>func NewApplication() *fiber.App {<br/>	env.SetupEnvFile()<br/>	app := fiber.New(fiber.Config{<br/>		AppName: "Go Ethereum API",<br/>		CaseSensitive: true,<br/>	})<br/><br/>	//Middleware<br/>	app.Use(recover.New())<br/>	app.Use(logger.New())<br/><br/>	//Setup routes<br/>	router.InstallRouter(app)<br/><br/>	return app<br/>}</span></pre><p id="b1c4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æœ€ååœ¨ä½ çš„<code class="eh mw mx my mn b">main.go</code>é‡Œç”¨è¿™ä¸ªå–ä»£ä¸€åˆ‡ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="f53d" class="mr kp ht mn b be ms mt l mu mv">package main<br/><br/>import (<br/>"fmt"<br/>"github.com/alofeoluwafemi/go-ethereum-api/bootstrap"<br/>"github.com/alofeoluwafemi/go-ethereum-api/pkg/env"<br/>"log"<br/>)<br/><br/>func main() {<br/>	app := bootstrap.NewApplication()<br/>	log.Fatal(app.Listen(<br/>		fmt.Sprintf("%s:%s",<br/>			env.GetEnv("APP_HOST", "localhost"),<br/>			env.GetEnv("APP_PORT", "3000"),<br/>		)))<br/>}</span></pre><p id="62e1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å¹¶åœ¨æ‚¨çš„<code class="eh mw mx my mn b">.env</code>æ–‡ä»¶ä¸­æ›´æ–°ç»†èŠ‚ä»¥åŒ¹é…ä»¥ä¸‹å†…å®¹ã€‚ä¸è¦æ‹…å¿ƒç§é’¥å’Œç‚¼é‡‘æœ¯Apiå¯†é’¥ï¼Œæˆ‘ä»¬ä¼šåŠæ—¶æ›´æ–°å®ƒã€‚</p><p id="a5d8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">ã€‚ç¯å¢ƒ</strong></p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="4c33" class="mr kp ht mn b be ms mt l mu mv">DEPLOYER_PRIVATE_KEY=0x0<br/>ALCHEMY_KEY=<br/>APP_HOST=localhost<br/>APP_PORT=3000</span></pre><p id="bdab" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœæ­¢å½“å‰è¿è¡Œçš„<code class="eh mw mx my mn b">go run main.go</code>è¿›ç¨‹å¹¶é‡å¯ã€‚å¦‚æœæ‚¨è®¿é—®æˆ‘ä»¬å”¯ä¸€æ³¨å†Œçš„è·¯ç”±<code class="eh mw mx my mn b">http://127.0.0.1:3000/api/v1</code>ï¼Œæ‚¨åº”è¯¥ä¼šçœ‹åˆ°JSONè¿”å›ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="ae29" class="mr kp ht mn b be ms mt l mu mv">{<br/>	"message": "Hello from api"<br/>}</span></pre><h1 id="eba4" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">åœ¨Goeril Testnetä¸Šéƒ¨ç½²æ™ºèƒ½åˆåŒ</h1><h1 id="3584" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">å…‹éš†åˆåŒ</h1><p id="9e2f" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">å°†Piggyfiæ™ºèƒ½åˆåŒåº“å…‹éš†åˆ°æˆ‘ä»¬é¡¹ç›®ä¸­çš„<code class="eh mw mx my mn b">smart-contracts</code>æ–‡ä»¶å¤¹ä¸­ã€‚ä¸ºæ­¤ï¼Œè¯·è¿è¡Œä¸‹é¢çš„å‘½ä»¤ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="b014" class="mr kp ht mn b be ms mt l mu mv">git clone https://github.com/orignellc/piggyfi-contracts-poc.git smart-contracts</span></pre><p id="b4b8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ‰“å¼€</p><h1 id="fb6c" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">æ±‡ç¼–åˆåŒ</h1><p id="72ab" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">åœ¨smart-contractsç›®å½•ä¸­è¿è¡Œ<code class="eh mw mx my mn b">npm install</code>,ä»¥è·å–openzeppelinä¾èµ–é¡¹ï¼Œè¯¥ä¾èµ–é¡¹åŒ…å«æˆ‘ä»¬çš„ä¸€äº›åˆåŒæ‰€å¼•ç”¨çš„æ™ºèƒ½åˆåŒ</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="7a49" class="mr kp ht mn b be ms mt l mu mv">solc --abi smart-contracts/contracts/*.sol -o builds --bin --include-path smart-contracts/node_modules --base-path .</span></pre><p id="8c3b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><code class="eh mw mx my mn b">--base-path</code>ä»£è¡¨ä½ è‡ªå·±æºä»£ç æ ‘çš„æ ¹ï¼Œè€Œ<code class="eh mw mx my mn b">--include-path</code>å…è®¸ä½ æŒ‡å®šåŒ…å«å¤–éƒ¨ä»£ç çš„é¢å¤–ä½ç½®ã€‚</p><p id="a622" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å¦‚æœä½ åœ¨<code class="eh mw mx my mn b">builds</code>æ–‡ä»¶å¤¹ä¸­æŸ¥çœ‹ï¼Œä½ ä¼šçœ‹åˆ°ç”Ÿæˆçš„<code class="eh mw mx my mn b">.abi</code>å’Œ<code class="eh mw mx my mn b">.bin</code>æ–‡ä»¶åˆ—è¡¨ã€‚</p><h1 id="8574" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">ç”ŸæˆåˆåŒGoç»‘å®š</h1><p id="f3f3" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">é˜¿æ¯”æ ¹æ˜¯å›´æ£‹ä»¥å¤ªåŠé™„å¸¦çš„ä¸€ä¸ªå¥—è£…ã€‚å®ƒæ˜¯ä¸€ä¸ªæºä»£ç ç”Ÿæˆå™¨ï¼Œå¯ä»¥å°†ä»¥å¤ªåŠå¥‘çº¦å®šä¹‰è½¬æ¢æˆæ˜“äºä½¿ç”¨ã€ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨çš„GoåŒ…ã€‚</p><p id="d07b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ç®€å•åœ°è¯´ï¼Œä¸ºæˆ‘ä»¬çš„æ™ºèƒ½å¥‘çº¦ç”Ÿæˆä¸€ä¸ªgoä»£ç ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç”¨goä»£ç ä¸å¥‘çº¦è¿›è¡Œäº¤äº’ã€‚</p><p id="17ac" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å®‰è£…<strong class="jd hu"> abigen </strong></p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="c0e3" class="mr kp ht mn b be ms mt l mu mv">cd $GOPATH/src/github.com/ethereum/go-ethereum/<br/>make<br/>make devtools</span></pre><p id="8d47" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä¸€æ—¦å®Œæˆï¼Œå¦‚æœä½ åœ¨å‘½ä»¤è¡Œä¸Šè¿è¡Œ<code class="eh mw mx my mn b">abigen</code>ï¼Œä½ åº”è¯¥å¾—åˆ°ä¸€ä¸ªè¾“å‡ºã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="23ee" class="mr kp ht mn b be ms mt l mu mv">Fatal: No destination package specified (--pkg)</span></pre><p id="9c50" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ç°åœ¨æˆ‘ä»¬å·²ç»å®‰è£…äº†<code class="eh mw mx my mn b">abigen</code>å·¥å…·ã€‚åœ¨<strong class="jd hu"> pkg </strong>æ–‡ä»¶å¤¹ä¸­å†åˆ›å»ºä¸¤ä¸ªæ–°åŒ…ï¼Œç¬¬ä¸€ä¸ªæ˜¯<code class="eh mw mx my mn b">go-binding</code>ã€‚</p><p id="27dc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨é‡Œé¢ï¼Œ<code class="eh mw mx my mn b">go-binding</code>åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶<code class="eh mw mx my mn b">generate_binding.go</code>ã€‚è¿™ä¸ªæ–‡ä»¶å°†åŒ…å«ä¸€ä¸ªè„šæœ¬ï¼Œå½“æˆ‘ä»¬è¿è¡Œå®ƒæ—¶ï¼Œå®ƒå°†å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆgo-bindingï¼Œæ‰€ä»¥å°†ä¸‹é¢çš„è„šæœ¬å¤åˆ¶å¹¶ç²˜è´´åˆ°æ–‡ä»¶ä¸­ã€‚è¿™æ˜¯ä¸è¨€è‡ªæ˜çš„ï¼Œä½†æˆ‘ä¼šå¾ˆå¿«ç»™å®ƒä¸€äº›èƒŒæ™¯ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="0558" class="mr kp ht mn b be ms mt l mu mv">package main<br/><br/>import (<br/>	"fmt"<br/>	"io/ioutil"<br/>	"log"<br/>	"os/exec"<br/>	"strings"<br/>)<br/><br/>const (<br/>	buildDir  = "../../builds/"<br/>	targetDir = "../ethereum/"<br/>)<br/><br/>func main() {<br/>	contractNames := []string{"CustodianWalletLogic", "Factory", "Escrow", "USDC"}<br/><br/>	cmd := exec.Command("which","abigen")<br/>	err := cmd.Run()<br/><br/>	if err != nil {<br/>		log.Fatal("ethereum-abigen is not a command: ",err)<br/>	}<br/><br/>	for _, contractName := range contractNames {<br/>		buildFilename := buildDir + contractName<br/>		bindingFilename := targetDir + contractName + ".go"<br/>		cmd = exec.Command(<br/>			"abigen", fmt.Sprintf("--bin=%s.bin", buildFilename),<br/>			fmt.Sprintf("--abi=%s.abi", buildFilename),<br/>			fmt.Sprintf("--pkg=%s", contractName),<br/>			fmt.Sprintf("--out=%s", bindingFilename),<br/>		)<br/><br/>		err := cmd.Start()<br/>		if err != nil {<br/>			log.Fatalln(err)<br/>		}<br/>		log.Printf("Running... %s", cmd)<br/>		err =  cmd.Wait()<br/>		if err != nil {<br/>			log.Fatalln(err)<br/>		}<br/>		bindFile, err := ioutil.ReadFile(bindingFilename)<br/>		if err != nil {<br/>			log.Fatalln("Cannot open: ",bindingFilename, err)<br/>		}<br/><br/>		fileOutput := strings.Replace(string(bindFile), "package " + contractName, "package ethereum", 1)<br/>		err = ioutil.WriteFile(bindingFilename, []byte(fileOutput), 0644)<br/>		if err != nil {<br/>			log.Fatalln("Cannot write to: ",bindingFilename,err)<br/>		}<br/>	}<br/>}</span></pre><p id="eec4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¯¥è„šæœ¬éå†æä¾›çš„<code class="eh mw mx my mn b">contractNames</code>ï¼Œå°†<code class="eh mw mx my mn b">.abi</code>å’Œ<code class="eh mw mx my mn b">.bin</code>é™„åŠ åˆ°æ–‡ä»¶åï¼Œç„¶åå°†å®ƒä»¬ä½œä¸ºé€‰é¡¹ä¼ é€’ç»™<code class="eh mw mx my mn b">abigen</code>å‘½ä»¤çš„<code class="eh mw mx my mn b">--abi</code>å’Œ<code class="eh mw mx my mn b">--bin</code>ï¼Œä»¥ç”Ÿæˆgoç»‘å®šã€‚</p><p id="679c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨è¿è¡Œgoæ–‡ä»¶ä¹‹å‰ï¼Œåˆ›å»ºæˆ‘å‰é¢æåˆ°çš„ç¬¬äºŒä¸ªåŒ…æ–‡ä»¶å¤¹ã€‚å–å<strong class="jd hu">ä»¥å¤ªåŠ</strong>ï¼Œåˆ«å¿˜äº†è¿™ä¸ªåº”è¯¥åœ¨<strong class="jd hu"> pkg </strong>ä¹‹ä¸‹ã€‚</p><p id="d6d5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä»æ‚¨çš„ç»ˆç«¯ï¼Œåœ¨æ‚¨çš„é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œä»¥ä¸‹å‘½ä»¤ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="fd29" class="mr kp ht mn b be ms mt l mu mv">cd pkg/go-binding <br/>go run generate_binding.go</span></pre><p id="c0ab" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨çš„è¾“å‡ºåº”è¯¥æ˜¯è¿™æ ·çš„ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nb"><img src="../Images/c5676bae70aab62562fe0e2385b28401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eN5gcC9LJ7DLlJCf.png"/></div></div></figure><p id="f59a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å¦‚æœä½ æ‰“å¼€ä»¥å¤ªåŠåŒ…æ–‡ä»¶å¤¹ï¼Œä½ ä¼šçœ‹åˆ°ä½ ç”Ÿæˆçš„go-bindingã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nc"><img src="../Images/24ff07053ecdaf874741daef49de5d1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KwyP7EyB7J5dmoVo.png"/></div></div></figure><h1 id="fa92" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">è·å–Alchemy APIå¯†é’¥</h1><p id="4637" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">Alchemyæä¾›web3å¼€å‘å·¥å…·æ¥æ„å»ºå’Œæ‰©å±•æ‚¨çš„Dappã€‚æˆ‘ä»¬å°†ä½¿ç”¨ä»–ä»¬çš„ä¸€é¡¹æœåŠ¡ï¼Œå…è®¸æ‚¨è¿æ¥åˆ°åŒºå—é“¾èŠ‚ç‚¹ï¼Œåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹æ˜¯<code class="eh mw mx my mn b">Goerli</code>ã€‚</p><p id="4350" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae kn" href="https://dashboard.alchemy.com/" rel="noopener ugc nofollow" target="_blank">åˆ›å»ºä¸€ä¸ªæ–°è´¦æˆ·</a>å¦‚æœè¿˜æ²¡æœ‰ï¼Œç‚¹å‡»<strong class="jd hu"> +åˆ›å»ºåº”ç”¨</strong>æŒ‰é’®ï¼Œé€‰æ‹©ä»¥å¤ªåŠå’ŒGoerliã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nd"><img src="../Images/b11c630353aac489ee3ea4033a4d8d9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1fiigDiGRvXEReQ3.png"/></div></div></figure><p id="02b1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åº”ç”¨ç¨‹åºåˆ›å»ºå®Œæˆåï¼Œå°†ä¼šåˆ—å‡ºæ‚¨å½“å‰æ‹¥æœ‰çš„åº”ç”¨ç¨‹åºåˆ—è¡¨ã€‚åœ¨ä½ æ–°åˆ›å»ºçš„åº”ç”¨ç¨‹åºæ—è¾¹ï¼Œç‚¹å‡»<strong class="jd hu">æŸ¥çœ‹å¯†é’¥</strong>å¹¶å°†å¯†é’¥å’ŒURLå¤åˆ¶åˆ°<code class="eh mw mx my mn b">.env</code>æ–‡ä»¶ä¸­ï¼Œä½œä¸º<strong class="jd hu"> ALCHEMY_KEY </strong>å’Œ<strong class="jd hu"> RPC_URL </strong>çš„å€¼ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ne"><img src="../Images/a562f562e2bfe92f30bf06f1b95ec134.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PlI20w3DmHIoji-c.png"/></div></div></figure><p id="4342" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ç°åœ¨ä½ çš„<code class="eh mw mx my mn b">.env</code>æ–‡ä»¶åº”è¯¥æ˜¯è¿™æ ·çš„ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="5c08" class="mr kp ht mn b be ms mt l mu mv">DEPLOYER_PRIVATE_KEY=bef9e118a31a0af39585d7e82cae42a...  <br/>ALCHEMY_KEY=obEYiMcZIMHXZC...<br/>RPC_URL=https://eth-goerli.g.alchemy.com/v2/obEYiMcZIMHXZC...<br/>APP_HOST=localhost<br/>APP_PORT=3000</span></pre><h1 id="d68e" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">åˆ›å»ºåŒ…åŒºå—é“¾</h1><p id="edf3" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">æˆ‘ä»¬éœ€è¦åœ¨<code class="eh mw mx my mn b">pkg</code>ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåŒºå—é“¾åŒ…ï¼Œå¹¶åœ¨å…¶ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„goæ–‡ä»¶<code class="eh mw mx my mn b">blockchain.go</code>ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nf"><img src="../Images/b703042893f5acbd7e3b76e95889f588.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*FB5IVVeIKyw8d6xY.png"/></div></div></figure><p id="aad7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™ä¸ªåŒ…æŠ½è±¡äº†æˆ‘ä»¬å¦‚ä½•è¿æ¥åˆ°ä»¥å¤ªåŠèŠ‚ç‚¹å¹¶ä¸æˆ‘ä»¬çš„æ™ºèƒ½åˆçº¦é€šä¿¡çš„å¤§éƒ¨åˆ†å†…å®¹ï¼Œä»¥é¿å…ä»£ç é‡å¤å¹¶ä¿æŒæ§åˆ¶å™¨ç²¾ç®€ã€‚æˆ‘å°†ç»§ç»­è§£é‡Šä»£ç çš„æ¯ä¸ªéƒ¨åˆ†ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¾åœ¨ä¸€èµ·ï¼Œçœ‹çœ‹å®ƒæ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚</p><p id="04a6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡<code class="eh mw mx my mn b">CurrentConnection</code>ï¼Œå®ƒå°†ä»è¿™ä¸ªåŒ…ä¸­å¯¼å‡ºã€‚è¿™ä¸ªå˜é‡å°†ä¿å­˜ä¸€ä¸ª<code class="eh mw mx my mn b">ClientConnection</code>çš„å®ä¾‹ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="cd5b" class="mr kp ht mn b be ms mt l mu mv">var CurrentConnection *ClientConnection</span></pre><p id="c18c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ¥ä¸‹æ¥æˆ‘ä»¬å®šä¹‰<code class="eh mw mx my mn b">ClientConnection</code> structï¼Œå®ƒä¿å­˜äº†æˆ‘ä»¬éœ€è¦ä¸ä»¥å¤ªåŠèŠ‚ç‚¹é€šä¿¡çš„ç»†èŠ‚é›†åˆï¼Œæ¯”å¦‚RPC URLã€è°ƒç”¨è¯·æ±‚é€‰é¡¹ç­‰ã€‚ä»¥åŠèŠ‚ç‚¹è¿æ¥æœ¬èº«çš„ä¸€ä¸ªå®ä¾‹ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="1e7f" class="mr kp ht mn b be ms mt l mu mv">type ClientConnection struct {<br/>	RpcURL      string<br/>	SignerKey   string<br/>	Client      *ethclient.Client<br/>	NetworkId   *big.Int<br/>	NetworkName string<br/>	ctx         context.Context<br/>	callOpts    *bind.CallOpts<br/>	trxOpts     *bind.TransactOpts<br/>}</span></pre><p id="b9fe" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä¸Šé¢çš„ä¸€äº›structå­—æ®µï¼Œæ¯”å¦‚<code class="eh mw mx my mn b">RpcURL</code>ã€<code class="eh mw mx my mn b">NetworkName</code>ã€<code class="eh mw mx my mn b">NetworkId</code>ï¼Œæ˜¯ä¸è¨€è‡ªæ˜çš„ï¼Œæˆ‘å°†èŠ±æ—¶é—´æ›´è¯¦ç»†åœ°æè¿°å…¶ä½™çš„å­—æ®µã€‚</p><p id="f298" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> SignerKey: </strong>è¿™å°†ä»ç¯å¢ƒæ–‡ä»¶ä¸­é€‰å–ï¼Œå®ƒæ˜¯ä¸å¸¦<code class="eh mw mx my mn b">0x</code>å‰ç¼€çš„æ™ºèƒ½åˆçº¦éƒ¨ç½²è€…çš„ç§é’¥ã€‚<br/> <strong class="jd hu">å®¢æˆ·ç«¯:</strong>å®ƒä¿å­˜è¿æ¥åˆ°ä»¥å¤ªåŠç‚¼é‡‘æœ¯èŠ‚ç‚¹çš„å®ä¾‹ã€‚<br/> <strong class="jd hu"> ctx: </strong>ç”¨äºæ‰€æœ‰æ™ºèƒ½åˆçº¦è°ƒç”¨çš„ä¸Šä¸‹æ–‡<br/> <strong class="jd hu"> callOpts: </strong>å®ƒæ˜¯ç”¨äºå‘å‡ºä¸æ”¹å˜çŠ¶æ€çš„åˆçº¦è°ƒç”¨è¯·æ±‚çš„é€‰é¡¹é›†åˆã€‚<br/> <strong class="jd hu"> trxOpts: </strong>æ˜¯åˆ›å»ºæœ‰æ•ˆä»¥å¤ªåŠäº¤æ˜“æ‰€éœ€çš„æˆæƒæ•°æ®çš„é›†åˆï¼Œå¼•èµ·çŠ¶æ€å˜åŒ–ã€‚</p><p id="2027" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ç„¶åæˆ‘ä»¬ç”¨<code class="eh mw mx my mn b">New()</code>æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œå¹¶åœ¨<code class="eh mw mx my mn b">ClientConnection</code>ä¸­è®¾ç½®å­—æ®µã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="4fca" class="mr kp ht mn b be ms mt l mu mv">func New() {<br/>	clientCon := new(ClientConnection)<br/>	clientCon.RpcURL = env.GetEnv("RPC_URL", "")<br/><br/>	client, err := ethclient.Dial(clientCon.RpcURL)<br/>	defer client.Close()<br/>	if err != nil {<br/>		log.Fatalln("Could not connect to client: ", err)<br/>	}<br/><br/>	clientCon.Client = client<br/>	clientCon.SignerKey = env.GetEnv("DEPLOYER_PRIVATE_KEY", "")<br/>	clientCon.NetworkName = "Goerli"<br/>	clientCon.NetworkId = new(big.Int).SetInt64(5)<br/>	clientCon.ctx = context.Background()<br/><br/>	clientCon.setTransactOpts()<br/>	clientCon.setCallOpts()<br/><br/>	CurrentConnection = clientCon<br/>}</span></pre><p id="304b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ·»åŠ ä¸€ä¸ªæ–¹æ³•æ¥ä»æˆ‘ä»¬çš„ç§é’¥ä¸­æå–å…¬é’¥ï¼Œå…¬é’¥ECDSAã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="f4cd" class="mr kp ht mn b be ms mt l mu mv">func (clientCon *ClientConnection) extractSignerKeys() (*ecdsa.PrivateKey, standardcryto.PublicKey, *ecdsa.PublicKey, error) {<br/>	privateKey, err := crypto.HexToECDSA(clientCon.SignerKey)<br/>	if err != nil {<br/>		log.Fatalln("Invalid private key: ", err)<br/>	}<br/><br/>	publicKey := privateKey.Public()<br/>	publicKeyECDSA, ok := publicKey.(*ecdsa.PublicKey)<br/><br/>	if !ok {<br/>		log.Fatalln("cannot assert type: publicKey is not of type *ecdsa.PublicKey")<br/>	}<br/><br/>	return privateKey, publicKey, publicKeyECDSA, err<br/>}</span></pre><p id="d6af" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ·»åŠ å¦ä¸€ä¸ªæ–¹æ³•æ¥è·å–ä¼ é€’ç»™å®ƒçš„ä»»ä½•åœ°å€çš„ä¸‹ä¸€ä¸ª<code class="eh mw mx my mn b">Nonce</code>ã€‚æˆ‘ä»¬ä¸»è¦å¹¶ä¸”å¯èƒ½åªéœ€è¦å®ƒæ¥è·å–éƒ¨ç½²è€…åœ°å€çš„éšæœºæ•°ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="9d6a" class="mr kp ht mn b be ms mt l mu mv">func (clientCon *ClientConnection) nonceAt(address common.Address) uint64 {<br/><br/>	nonce, err := clientCon.Client.PendingNonceAt(clientCon.ctx, address)<br/><br/>	if err != nil {<br/>		log.Fatalln("Cannot get nonce: ", err)<br/>	}<br/><br/>	return nonce<br/>}</span></pre><p id="8ff5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æœ€åï¼Œæˆ‘ä»¬éœ€è¦åœ¨<code class="eh mw mx my mn b">ClientConnection</code>ä¸Šè®¾ç½®<code class="eh mw mx my mn b">callOpts</code> <code class="eh mw mx my mn b">trxOpts</code>å­—æ®µçš„æ–¹æ³•ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="3538" class="mr kp ht mn b be ms mt l mu mv">func (clientCon *ClientConnection) setTransactOpts() *bind.TransactOpts {<br/>	signer, _, publicKeyECDSA, _ := clientCon.extractSignerKeys()<br/><br/>	from := crypto.PubkeyToAddress(*publicKeyECDSA)<br/><br/>	opts, err := bind.NewKeyedTransactorWithChainID(signer, clientCon.NetworkId)<br/>	if err != nil {<br/>		log.Fatalln("Error with NewKeyedTransactorWithChainID ", err)<br/>	}<br/><br/>	priorityFee, err := clientCon.Client.SuggestGasTipCap(clientCon.ctx)<br/>	if err != nil {<br/>		log.Fatalln("Cannot suggest Tip: ", err)<br/>	}<br/><br/>	opts.Nonce = new(big.Int).SetUint64(clientCon.nonceAt(from))<br/>	opts.GasTipCap = priorityFee<br/><br/>	clientCon.trxOpts = opts<br/><br/>	return opts<br/>}</span></pre><pre class="ng mm mn mo bn mp mq bi"><span id="7507" class="mr kp ht mn b be ms mt l mu mv">func (clientCon *ClientConnection) setCallOpts() *bind.CallOpts {<br/>	opts := new(bind.CallOpts)<br/>	return opts<br/>}</span></pre><p id="580f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æŠŠè¿™äº›æ”¾åœ¨ä¸€èµ·ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="fa58" class="mr kp ht mn b be ms mt l mu mv">package blockchain<br/><br/>import (<br/>	"context"<br/>	standardcryto "crypto"<br/>	"crypto/ecdsa"<br/>	"github.com/alofeoluwafemi/go-ethereum-api/pkg/env"<br/>	"github.com/alofeoluwafemi/go-ethereum-api/pkg/ethereum"<br/>	"github.com/ethereum/go-ethereum/accounts/abi/bind"<br/>	"github.com/ethereum/go-ethereum/common"<br/>	"github.com/ethereum/go-ethereum/core/types"<br/>	"github.com/ethereum/go-ethereum/crypto"<br/>	"github.com/ethereum/go-ethereum/ethclient"<br/>	"log"<br/>	"math/big"<br/>)<br/><br/>var CurrentConnection *ClientConnection<br/><br/>type ClientConnection struct {<br/>	RpcURL      string<br/>	SignerKey   string<br/>	Client      *ethclient.Client<br/>	NetworkId   *big.Int<br/>	NetworkName string<br/>	ctx         context.Context<br/>	callOpts    *bind.CallOpts<br/>	trxOpts     *bind.TransactOpts<br/>}<br/><br/>func New() {<br/>	clientCon := new(ClientConnection)<br/>	clientCon.RpcURL = env.GetEnv("RPC_URL", "")<br/><br/>	client, err := ethclient.Dial(clientCon.RpcURL)<br/>	defer client.Close()<br/>	if err != nil {<br/>		log.Fatalln("Could not connect to client: ", err)<br/>	}<br/><br/>	clientCon.Client = client<br/>	clientCon.SignerKey = env.GetEnv("DEPLOYER_PRIVATE_KEY", "")<br/>	clientCon.NetworkName = "Goerli"<br/>	clientCon.NetworkId = new(big.Int).SetInt64(5)<br/>	clientCon.ctx = context.Background()<br/><br/>	clientCon.setTransactOpts()<br/>	clientCon.setCallOpts()<br/><br/>	CurrentConnection = clientCon<br/>}<br/><br/>func (clientCon *ClientConnection) nonceAt(address common.Address) uint64 {<br/><br/>	nonce, err := clientCon.Client.PendingNonceAt(clientCon.ctx, address)<br/><br/>	if err != nil {<br/>		log.Fatalln("Cannot get nonce: ", err)<br/>	}<br/><br/>	return nonce<br/>}<br/><br/>func (clientCon *ClientConnection) setTransactOpts() *bind.TransactOpts {<br/>	signer, _, publicKeyECDSA, _ := clientCon.extractSignerKeys()<br/><br/>	from := crypto.PubkeyToAddress(*publicKeyECDSA)<br/><br/>	opts, err := bind.NewKeyedTransactorWithChainID(signer, clientCon.NetworkId)<br/>	if err != nil {<br/>		log.Fatalln("Error with NewKeyedTransactorWithChainID ", err)<br/>	}<br/><br/>	priorityFee, err := clientCon.Client.SuggestGasTipCap(clientCon.ctx)<br/>	if err != nil {<br/>		log.Fatalln("Cannot suggest Tip: ", err)<br/>	}<br/><br/>	opts.Nonce = new(big.Int).SetUint64(clientCon.nonceAt(from))<br/>	opts.GasTipCap = priorityFee<br/><br/>	clientCon.trxOpts = opts<br/><br/>	return opts<br/>}<br/><br/>func (clientCon *ClientConnection) setCallOpts() *bind.CallOpts {<br/>	opts := new(bind.CallOpts)<br/>	return opts<br/>}<br/><br/>func (clientCon *ClientConnection) extractSignerKeys() (*ecdsa.PrivateKey, standardcryto.PublicKey, *ecdsa.PublicKey, error) {<br/>	privateKey, err := crypto.HexToECDSA(clientCon.SignerKey)<br/>	if err != nil {<br/>		log.Fatalln("Invalid private key: ", err)<br/>	}<br/><br/>	publicKey := privateKey.Public()<br/>	publicKeyECDSA, ok := publicKey.(*ecdsa.PublicKey)<br/><br/>	if !ok {<br/>		log.Fatalln("cannot assert type: publicKey is not of type *ecdsa.PublicKey")<br/>	}<br/><br/>	return privateKey, publicKey, publicKeyECDSA, err<br/>}<br/><br/>func (clientCon *ClientConnection) DeployUSDC() (common.Address, *types.Transaction) {<br/>	contract, trx, _, err := ethereum.DeployUSDC(clientCon.trxOpts, clientCon.Client)<br/><br/>	if err != nil {<br/>		log.Fatalln("Could not deploy USDC contract: ", err)<br/>	}<br/><br/>	return contract, trx<br/>}</span></pre><p id="50ad" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ç°åœ¨æˆ‘ä»¬å·²ç»æœ‰äº†è¿™äº›æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹åœ¨æˆ‘ä»¬çš„æ™ºèƒ½å¥‘çº¦ä¸Šè°ƒç”¨æ–¹æ³•ã€‚æ‰“å¼€ä»¥å¤ªåŠåŒ…ä¸‹çš„<code class="eh mw mx my mn b">USDC.go</code>æ–‡ä»¶ï¼Œåœ¨ç¬¬<code class="eh mw mx my mn b">46</code>è¡Œä½ ä¼šæ³¨æ„åˆ°å‡½æ•°<code class="eh mw mx my mn b">DeployUSDC</code>ï¼Œå¯ä»¥è°ƒç”¨å®ƒæ¥éƒ¨ç½²<code class="eh mw mx my mn b">USDC</code>å¥‘çº¦ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nb"><img src="../Images/163b11bb4ebf78dcd94c9cf3db3a5ebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*F0o4TwWqRvQf8BcV.png"/></div></div></figure><p id="5fcb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æˆ‘ä»¬éœ€è¦ä»ä¸€ä¸ªæ§åˆ¶å™¨è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶å‘å®ƒä¼ é€’æ‰€éœ€çš„ä¸¤ä¸ªå‚æ•°ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶æä¾›è¿™ä¸¤è€…ï¼Œä½†æ˜¯é¦–å…ˆåœ¨controllersä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„goæ–‡ä»¶<code class="eh mw mx my mn b">deployer_controller.go</code>ï¼Œç„¶åæ·»åŠ ä»¥ä¸‹å†…å®¹æ¥å®šä¹‰ä¸€ä¸ªå°†ä»<code class="eh mw mx my mn b">/api/v1/deploy/usdc</code>è°ƒç”¨çš„<code class="eh mw mx my mn b">DeployUSDC</code>æ§åˆ¶å™¨ã€‚</p><p id="ede4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å†…éƒ¨<code class="eh mw mx my mn b">deployer_controller.go</code>æŠŠè¿™ä¸ªç²˜è´´è¿›å»ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="9ce7" class="mr kp ht mn b be ms mt l mu mv">package controllers<br/><br/>import (<br/>	"github.com/alofeoluwafemi/go-ethereum-api/pkg/blockchain"<br/>	"github.com/gofiber/fiber/v2"<br/>)<br/><br/>func DeployUSDC(c *fiber.Ctx) error {<br/><br/>	conn := blockchain.CurrentConnection<br/><br/>	address, transaction := conn.DeployUSDC()<br/><br/>	return c.Status(fiber.StatusOK).JSON(fiber.Map{<br/>		"address": address.String(),<br/>		"hash":    transaction.Hash(),<br/>	})<br/>}</span></pre><p id="3311" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åŒºå—é“¾åŒ…çš„<code class="eh mw mx my mn b">DeployUSDC</code>æ–¹æ³•å°šæœªå®šä¹‰ã€‚è®©æˆ‘ä»¬é€šè¿‡å®šä¹‰å®ƒæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå®ƒç®€å•åœ°è°ƒç”¨<code class="eh mw mx my mn b">USDC.go</code>ä¸Šçš„<code class="eh mw mx my mn b">DeployUSDC</code>å‡½æ•°ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="b917" class="mr kp ht mn b be ms mt l mu mv">func (clientCon *ClientConnection) DeployUSDC() (common.Address, *types.Transaction) {<br/>	contract, trx, _, err := ethereum.DeployUSDC(clientCon.trxOpts, clientCon.Client)<br/><br/>	if err != nil {<br/>		log.Fatalln("Could not deploy USDC contract: ", err)<br/>	}<br/><br/>	return contract, trx<br/>}</span></pre><p id="0e7d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨<code class="eh mw mx my mn b">api_router.go</code>ä¸­ï¼Œä¸ºæ–°çš„URLæ·»åŠ ä¸€ä¸ªè·¯ç”±å™¨</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="837e" class="mr kp ht mn b be ms mt l mu mv">deploy := api.Group("/deploy")<br/>	deploy.Get("/usdc", controllers.DeployUSDC)</span></pre><p id="5cf4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æœ€åï¼Œå¦‚æœæ‚¨åœæ­¢å¹¶é‡æ–°è¿è¡Œè¯¥å‘½ä»¤ï¼Œä½¿ç”¨ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="72f0" class="mr kp ht mn b be ms mt l mu mv">go run main.go</span></pre><p id="4f29" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å½“æ‚¨è®¿é—®<a class="ae kn" href="http://127.0.0.1:3000/api/v1/deploy/usdc" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/deploy/usdc</a>æ—¶ï¼Œæ‚¨å°†è·å¾—ä¸€ä¸ªå“åº”ï¼Œå…¶ä¸­åŒ…å«åˆåŒåœ°å€å’Œç”¨äºéƒ¨ç½²usdcåˆåŒåœ°å€çš„äº‹åŠ¡çš„å“ˆå¸Œã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="cd47" class="mr kp ht mn b be ms mt l mu mv">{<br/>	"address": "0xb3f2504110eeea6a522218048D0519B829788DDD",<br/>	"hash": "0xaeabc29be2bb6d2e84466edebf8e38b0ca833f250bc70eeb733509365b5f787b"<br/>}</span></pre><p id="fe9a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œå¦‚æœæˆ‘è®¿é—®Etherscanå¹¶ä½¿ç”¨äº‹åŠ¡æ•£åˆ—è¿›è¡Œæœç´¢ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nb"><img src="../Images/6dd85ae6b244e24dbc3358c1157981fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uGXUaDiHSfG-mkEx.png"/></div></div></figure><h1 id="c4e7" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">ä½¿ç”¨POSTè€Œä¸æ˜¯GET</h1><p id="6bd3" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">æˆ‘ä»¬åœ¨éƒ¨ç½²USDCè·¯ç”±ä¸Šä½¿ç”¨çš„å½“å‰HTTPæ–¹æ³•æ˜¯GETï¼Œç°åœ¨å°†å…¶æ”¹ä¸ºPOSTï¼Œè¿™æ ·ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="31a8" class="mr kp ht mn b be ms mt l mu mv">deploy.Post("/usdc", controllers.DeployUSDC)</span></pre><p id="17a3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å†æ¬¡é‡å¯æœåŠ¡å™¨ï¼Œä»Postmanå‘<a class="ae kn" href="http://127.0.0.1:3000/api/v1/deploy/usdc" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/deploy/usdc</a>å‘å‡ºGETè¯·æ±‚ï¼Œä¸€ä¸ªæ–°çš„æ™ºèƒ½åˆçº¦å°†è¢«éƒ¨ç½²ã€‚æ‚¨å¯ä»¥ä½¿ç”¨äº‹åŠ¡å“ˆå¸Œè¿›è¡Œç¡®è®¤ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nh"><img src="../Images/5e5d185a1dbd6355ff76146a3445114b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1eimgLs8TNcrbcS5.png"/></div></div></figure><p id="bbc5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¯·åŠ¡å¿…è®°ä¸‹å·²éƒ¨ç½²å¥‘çº¦çš„åœ°å€ï¼Œä¾›æˆ‘ä»¬ä»¥åä½¿ç”¨ã€‚</p><p id="546b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„è·¯ç”±æ¥éƒ¨ç½²å·¥å‚å¥‘çº¦ã€‚åœ¨<code class="eh mw mx my mn b">DeployUSDC</code>çš„æ­£ä¸‹æ–¹æ·»åŠ è¯¥æ§åˆ¶å™¨åŠŸèƒ½ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="fb0f" class="mr kp ht mn b be ms mt l mu mv">func DeployFactory(c *fiber.Ctx) error {</span></pre><pre class="ng mm mn ni nj aw nk dt"><span id="a66c" class="lu kp ht mn b fv nl nm l nn mv">	conn := blockchain.CurrentConnection</span><span id="2d85" class="lu kp ht mn b fv no nm l nn mv">	address, transaction := conn.DeployFactory()</span><span id="c25c" class="lu kp ht mn b fv no nm l nn mv">	return c.Status(fiber.StatusOK).JSON(fiber.Map{<br/>		"address": address.String(),<br/>		"hash":    transaction.Hash(),<br/>	})<br/>}</span></pre><p id="83d8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å®ƒä¸ä¹‹å‰çš„æ§åˆ¶å™¨åŠŸèƒ½æ²¡æœ‰ä»»ä½•ä¸åŒï¼Œå› æ­¤æ— éœ€è§£é‡Šã€‚</p><p id="14b5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™åŒæ ·é€‚ç”¨äºåŒºå—é“¾ä¸€æ½å­æƒåˆ©ä¸‹çš„<code class="eh mw mx my mn b">DeployUSDC</code>æ–¹æ³•ã€‚æ·»åŠ ä¸€ä¸ªæ–°æ–¹æ³•<code class="eh mw mx my mn b">DeployFactory</code>ï¼Œå®ƒè°ƒç”¨Factory.goæ–‡ä»¶ä¸­çš„DeployFactoryã€‚<code class="eh mw mx my mn b">DeployFactory</code>è¿˜éƒ¨ç½²äº†<code class="eh mw mx my mn b">Escrow</code>å’Œ<code class="eh mw mx my mn b">CustodianWalletLogic</code>åˆåŒï¼Œæ‚¨å°†åœ¨åé¢çœ‹åˆ°ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="5f70" class="mr kp ht mn b be ms mt l mu mv">func (clientCon *ClientConnection) DeployFactory() (common.Address, *types.Transaction) {<br/>	contract, trx, _, err := ethereum.DeployFactory(clientCon.trxOpts, clientCon.Client)<br/><br/>	if err != nil {<br/>		log.Fatalln("Could not deploy Factory contract: ", err)<br/>	}<br/><br/>	return contract, trx<br/>}</span></pre><p id="e142" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">é‡å¯fiberæœåŠ¡å™¨ï¼Œåœ¨Postmanä¸­å‘<a class="ae kn" href="http://127.0.0.1:3000/api/v1/deploy/factory" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/deploy/Factory</a>å‘å‡ºPOSTè¯·æ±‚ï¼Œå·¥å‚å¥‘çº¦å°†è¢«éƒ¨ç½²ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff np"><img src="../Images/d379801704777ce1fbc1dbb8bc1508ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WfS1zC5yRpcpB7VT.png"/></div></div></figure><p id="0b44" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¯·è®°ä½ï¼Œæˆ‘æåˆ°è¿‡éƒ¨ç½²å·¥å‚å¥‘çº¦ä¹Ÿè¦éƒ¨ç½²æ‰˜ç®¡&amp; WalletLogicå¥‘çº¦ã€‚æ‚¨å¯ä»¥é€šè¿‡æŸ¥çœ‹å·¥å‚åˆåŒæ„é€ å‡½æ•°æ¥ç¡®è®¤è¿™ä¸€ç‚¹ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nq"><img src="../Images/1db9a822356deaefb2fa72ea92020ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CGeXZR8iwkUXDjsJ.png"/></div></div></figure><h1 id="e3ca" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">è·å–CustodianWalletLogicåœ°å€</h1><p id="bc54" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">ä¸ºäº†ä½¿ç”¨å·¥å‚åˆåŒï¼Œæˆ‘ä»¬å°†åœ¨åŒºå—é“¾åŒ…ä¸­åˆ›å»ºä¸€ä¸ª<code class="eh mw mx my mn b">factory.go</code>æ–‡ä»¶ã€‚å°±åƒåœ¨<code class="eh mw mx my mn b">blockchain.go</code>æ–‡ä»¶ä¸­æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªå•ä¾‹å˜é‡æ¥ä¿å­˜è¿æ¥å®ä¾‹ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå°†å®šä¹‰ä¸€ä¸ªå˜é‡<code class="eh mw mx my mn b">FactoryInstance</code>æ¥ä¿å­˜å·²éƒ¨ç½²å·¥å‚å¥‘çº¦çš„å®ä¾‹ã€‚</p><p id="83e3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ç„¶åä¸€ä¸ª<code class="eh mw mx my mn b">NewFactory</code>æ–¹æ³•ä½¿ç”¨å¥‘çº¦åœ°å€å¾—åˆ°ä¸€ä¸ªå®ä¾‹ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="7024" class="mr kp ht mn b be ms mt l mu mv">var FactoryInstance *Factory<br/><br/>type Factory struct {<br/>	Address  common.Address<br/>	Instance *ethereum.Factory<br/>}<br/><br/>func (clientCon ClientConnection) NewFactory(address string) {<br/>	FactoryInstance = new(Factory)<br/><br/>	contractAddress := common.HexToAddress(address)<br/><br/>	FactoryInstance.Address = contractAddress<br/><br/>	instance, err := ethereum.NewFactory(contractAddress, clientCon.Client)<br/>	if err != nil {<br/>		log.Fatalln("Cannot get Factory contract at address ", address, " due to: ", err)<br/>	}<br/><br/>	FactoryInstance.Instance = instance<br/>}</span></pre><p id="b203" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æœ€åæ˜¯<code class="eh mw mx my mn b">GetLogicAddress</code>æ–¹æ³•ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="6d7f" class="mr kp ht mn b be ms mt l mu mv">func (clientCon ClientConnection) GetLogicAddress() common.Address {<br/><br/>	address, err := FactoryInstance.Instance.CustodianWalletLogic(clientCon.callOpts)<br/><br/>	if err != nil {<br/>		log.Fatalln("Cannot make call to Factory at ", FactoryInstance.Address, "due to: ", err)<br/>	}<br/><br/>	return address<br/>}</span></pre><p id="e93f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å°†æ‰€æœ‰è¿™äº›æ”¾åœ¨ä¸€èµ·<code class="eh mw mx my mn b">pkg/blockchain/factory.go</code>çœ‹èµ·æ¥åº”è¯¥å®Œå…¨æ˜¯è¿™æ ·çš„ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="4789" class="mr kp ht mn b be ms mt l mu mv">package blockchain<br/><br/>import (<br/>	"github.com/alofeoluwafemi/go-ethereum-api/pkg/ethereum"<br/>	"github.com/ethereum/go-ethereum/common"<br/>	"log"<br/>)<br/><br/>var FactoryInstance *Factory<br/><br/>type Factory struct {<br/>	Address  common.Address<br/>	Instance *ethereum.Factory<br/>}<br/><br/>func (clientCon ClientConnection) NewFactory(address string) {<br/>	FactoryInstance = new(Factory)<br/><br/>	contractAddress := common.HexToAddress(address)<br/><br/>	FactoryInstance.Address = contractAddress<br/><br/>	instance, err := ethereum.NewFactory(contractAddress, clientCon.Client)<br/>	if err != nil {<br/>		log.Fatalln("Cannot get Factory contract at address ", address, " due to: ", err)<br/>	}<br/><br/>	FactoryInstance.Instance = instance<br/>}<br/><br/>// GetLogicAddress 0x505A066E89Be22D3e56f16e1666de31f9328572e<br/>func (clientCon ClientConnection) GetLogicAddress() common.Address {<br/><br/>	address, err := FactoryInstance.Instance.CustodianWalletLogic(clientCon.callOpts)<br/><br/>	if err != nil {<br/>		log.Fatalln("Cannot make call to Factory at ", FactoryInstance.Address, "due to: ", err)<br/>	}<br/><br/>	return address<br/>}</span></pre><p id="2ab0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨<code class="eh mw mx my mn b">api_router.go</code>æ–‡ä»¶ä¸­ï¼Œæ·»åŠ è·¯ç”±ä»¥è°ƒç”¨åˆšåˆšæ·»åŠ çš„æ–°æ§åˆ¶å™¨æ–¹æ³•ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="5940" class="mr kp ht mn b be ms mt l mu mv">api.Get("/wallet-logic-address", controllers.GetCustodianWalletLogicAddress)</span></pre><p id="2f39" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><code class="eh mw mx my mn b">GetCustodianWalletLogicAddress</code>æ§åˆ¶å™¨æ–¹æ³•å°šæœªå®šä¹‰ã€‚è®©æˆ‘ä»¬å°†å·¥å‚é€»è¾‘ä»ä¸»æ§åˆ¶å™¨å’Œéƒ¨ç½²è€…æ§åˆ¶å™¨ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œå‡ºäºè¿™äº›åŸå› ï¼Œåˆ›å»ºä¸€ä¸ªæ–°çš„æ§åˆ¶å™¨<code class="eh mw mx my mn b">factory_controller.go</code>å¹¶å°†å…¶ç²˜è´´åˆ°å†…éƒ¨ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="c6fe" class="mr kp ht mn b be ms mt l mu mv">package controllers<br/><br/>import (<br/>	"github.com/alofeoluwafemi/go-ethereum-api/pkg/blockchain"<br/>	"github.com/gofiber/fiber/v2"<br/>)<br/><br/>func GetCustodianWalletLogicAddress(c *fiber.Ctx) error {<br/>	conn := blockchain.CurrentConnection<br/><br/>	address := conn.GetLogicAddress()<br/><br/>	return c.Status(fiber.StatusOK).JSON(fiber.Map{<br/>		"address": address.String(),<br/>	})<br/>}</span></pre><p id="8d09" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æœ€ååœ¨<code class="eh mw mx my mn b">factory.go</code>ä¸­æ·»åŠ ä»æ§åˆ¶å™¨è°ƒç”¨çš„æ–¹æ³•ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="4d06" class="mr kp ht mn b be ms mt l mu mv">func (clientCon ClientConnection) GetLogicAddress() common.Address {<br/><br/>	address, err := getFactory().CustodianWalletLogic(clientCon.callOpts)<br/><br/>	if err != nil {<br/>		log.Fatalln("Cannot make call to Factory at ", FactoryInstance.Address, "due to: ", err)<br/>	}<br/><br/>	return address<br/>}</span></pre><p id="67d2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">é‡å¯å…‰çº¤æœåŠ¡å™¨å¹¶ä½¿ç”¨Postmanå‘<a class="ae kn" href="http://127.0.0.1:3000/api/v1/wallet-logic-address" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/wallet-logic-address</a>å‘å‡ºGETè¯·æ±‚ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff nr"><img src="../Images/d3bb39f8811afae8a262fd9b3e45fd23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*z9R1L3t4mOgjaYlH.png"/></div></div></figure><p id="8725" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ·»åŠ ä¸€ä¸ªæ–°çš„ç±»ä¼¼è·¯ç”±ï¼Œä»¥è·å–å·¥å‚éƒ¨ç½²çš„æ‰˜ç®¡åˆåŒåœ°å€ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="093e" class="mr kp ht mn b be ms mt l mu mv">api.Get("/escrow-address", controllers.GetEscrowAddress)</span></pre><p id="1638" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨å·¥å‚æ§åˆ¶å™¨ä¸­åˆ›å»º<code class="eh mw mx my mn b">GetEscrowAddress</code>å‡½æ•°ï¼Œå‡ ä¹å’ŒGetLogicAddressæ§åˆ¶å™¨ä¸€æ ·ã€‚</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="6af3" class="mr kp ht mn b be ms mt l mu mv">func GetEscrowAddress(c *fiber.Ctx) error {  <br/>   conn := blockchain.CurrentConnection  <br/>  <br/>  address := conn.GetEscrowAddress()  <br/>  <br/>   return c.Status(fiber.StatusOK).JSON(fiber.Map{  <br/>      "address": address.String(),  <br/>   })  <br/>}</span></pre><p id="d6f2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æœ€åï¼Œå°†<code class="eh mw mx my mn b">GetEscrowAddress</code>æ–¹æ³•æ·»åŠ åˆ°<code class="eh mw mx my mn b">factory.go</code>ä¸­</p><pre class="mi mj mk ml fq mm mn mo bn mp mq bi"><span id="9ae2" class="mr kp ht mn b be ms mt l mu mv">func (clientCon ClientConnection) GetEscrowAddress() common.Address {  <br/>  <br/>   address, err := getFactory().EscrowContractAddress(clientCon.callOpts)  <br/>  <br/>   if err != nil {  <br/>      log.Fatalln("Cannot make call to Factory at ", FactoryInstance.Address, "due to: ", err)  <br/>   }  <br/>  <br/>   return address  <br/>}</span></pre><p id="c9f5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">é‡å¯å…‰çº¤æœåŠ¡å™¨å¹¶ä½¿ç”¨Postmanå‘<a class="ae kn" href="http://127.0.0.1:3000/api/v1/escrow-address" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/escrow-address</a>å‘å‡ºGETè¯·æ±‚ã€‚</p><figure class="mi mj mk ml fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ns"><img src="../Images/26fffbe6e3ad4331d90340b555a121c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KNlMarXEsUgAGWMd.png"/></div></div></figure><p id="be64" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»åšåˆ°äº†ä»¥ä¸‹å‡ ç‚¹:</p><ul class=""><li id="0ed4" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated">è®¾ç½®Go Fiberæ¡†æ¶å¹¶æ„å»ºå®ƒä»¥æ„å»ºAPI</li><li id="00f5" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">è®¾ç½®APIç«¯ç‚¹ä»¥éƒ¨ç½²å·¥å‚å’ŒUSDCåˆåŒ</li><li id="749e" class="jz ka ht jd b je ki ji kj jm kk jq kl ju km jy ke kf kg kh dt translated">è®¾ç½®APIç«¯ç‚¹ï¼Œä»¥ä¾¿åœ¨éƒ¨ç½²å·¥å‚åˆåŒæ—¶éƒ¨ç½²æ‰˜ç®¡å’Œé’±åŒ…é€»è¾‘åœ°å€ã€‚æˆ‘ä»¬ç›´æ¥ä»éƒ¨ç½²çš„å·¥å‚åˆåŒä¸­è¯»å–è¿™äº›ä¿¡æ¯</li></ul><p id="e185" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨æœ€åä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å®Œæˆä¸æ‰˜ç®¡å¥‘çº¦äº¤äº’çš„å¦ä¸€ä¸ªç«¯ç‚¹ï¼Œä»¥æ‰§è¡Œä¸è®¢å•ç›¸å…³çš„æ“ä½œã€‚</p><p id="ff20" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ„Ÿè°¢ä½ åšæŒåˆ°ç°åœ¨ï¼Œå¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥é€šè¿‡ä¸ºè¿™ç¯‡æ–‡ç« é¼“æŒå’Œè®¢é˜…æˆ‘çš„<a class="ae kn" href="https://www.youtube.com/channel/UCO3mWoCZ_iqRPRvUeg9oG2A" rel="noopener ugc nofollow" target="_blank"> youtubeé¢‘é“</a>æ¥æ”¯æŒæˆ‘ã€‚</p><blockquote class="nt"><p id="6bf9" class="nu nv ht bd nw nx ny nz oa ob oc jy ek translated">äº¤æ˜“æ–°æ‰‹ï¼Ÿå°è¯•<a class="ae kn" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">åŠ å¯†äº¤æ˜“æœºå™¨äºº</a>æˆ–<a class="ae kn" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">å¤åˆ¶äº¤æ˜“</a></p></blockquote></div></div>    
</body>
</html>