<html>
<head>
<title>Blockchain Oracles: why do you need them</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">区块链神谕:你为什么需要它们</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/oracles-bring-the-external-world-to-the-blockchain-59c3bf9a6daf?source=collection_archive---------7-----------------------#2022-09-15">https://medium.com/coinmonks/oracles-bring-the-external-world-to-the-blockchain-59c3bf9a6daf?source=collection_archive---------7-----------------------#2022-09-15</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="c8aa" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">理解为什么智能合约不能管理现实世界的信息，以及Oracles如何试图解决这个问题。</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/672da281d2bc7afdf460a97e3fb1c5e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WGzANTto5JMNW8JW.jpg"/></div></div></figure><h1 id="c44b" class="ju jv ht bd jw jx jy jz ka kb kc kd ke iz kf ja kg jc kh jd ki jf kj jg kk kl dt translated">为什么是神谕</h1><p id="6beb" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">“神谕”一词来自希腊神话，指的是一个通过与神交流可以预见未来事件的人。</p><p id="1ebc" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">区块链环境中的oracle是一个可以为以太坊智能合约提供外部数据源的系统。</p><blockquote class="ln"><p id="9ea8" class="lo lp ht bd lq lr ls lt lu lv lw lh ek translated">但是为什么智能合约不能管理链外/现实世界的信息呢？</p></blockquote><p id="5cff" class="pw-post-body-paragraph km kn ht ko b kp lx iu kr ks ly ix ku kv lz kx ky kz ma lb lc ld mb lf lg lh hm dt translated">以太坊虚拟机是以太坊平台的关键组件，能够在遵守共识规则的同时，在分散网络中的任何节点上执行程序并更新以太坊的状态。</p><p id="a3e6" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">为了保持一致，EVM的执行必须是完全确定的，并且完全基于以太坊状态和已签名的交易。这是因为当执行事务时，网络上的每个节点必须能够产生相同的结果。如果在不同的节点执行给出不同的输出，就永远达不到共识。</p><blockquote class="ln"><p id="578f" class="lo lp ht bd lq lr ls lt lu lv lw lh ek translated">非决定论导致共识的失败</p></blockquote><p id="ddc9" class="pw-post-body-paragraph km kn ht ko b kp lx iu kr ks ly ix ku kv lz kx ky kz ma lb lc ld mb lf lg lh hm dt translated">这有两个重要的含义:</p><ul class=""><li id="e0e0" class="mc md ht ko b kp li ks lj kv me kz mf ld mg lh mh mi mj mk dt translated">没有随机性的内在来源，</li><li id="e7a9" class="mc md ht ko b kp ml ks mm kv mn kz mo ld mp lh mh mi mj mk dt translated">外部数据只能作为事务的数据负载引入。</li></ul><p id="8032" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">外部信息，如随机来源、价格信息、天气预报等，只能作为数据包含在发送到网络的交易中。但是，这样的信息是不可信的，因为它来自不可信的来源。结果，我们只是推迟了这个问题。一位先知试图解决这个问题。</p><h1 id="350f" class="ju jv ht bd jw jx jy jz ka kb kc kd ke iz kf ja kg jc kh jd ki jf kj jg kk kl dt translated">Oracles设计模式</h1><p id="b860" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">首先要不断重复的是，Oracle不是一种产品或特定的智能合约实施，而是:</p><blockquote class="ln"><p id="cbc5" class="lo lp ht bd lq lr ls lt lu lv lw lh ek translated">Oracle是一种设计模式！</p></blockquote><p id="9f14" class="pw-post-body-paragraph km kn ht ko b kp lx iu kr ks ly ix ku kv lz kx ky kz ma lb lc ld mb lf lg lh hm dt translated">oracles的主要功能是:</p><ul class=""><li id="9b9e" class="mc md ht ko b kp li ks lj kv me kz mf ld mg lh mh mi mj mk dt translated">从外链来源收集信息</li><li id="8271" class="mc md ht ko b kp ml ks mm kv mn kz mo ld mp lh mh mi mj mk dt translated">使用签名消息在链上发送数据</li><li id="a4ce" class="mc md ht ko b kp ml ks mm kv mn kz mo ld mp lh mh mi mj mk dt translated">将数据放入智能合约的存储中，使其可用</li></ul><p id="d1ea" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">一旦数据存储在智能合约中，其他智能合约就可以使用消息调用来访问它。</p><p id="4839" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">设计Oracle的三个主要选项是:</p><ul class=""><li id="0194" class="mc md ht ko b kp li ks lj kv me kz mf ld mg lh mh mi mj mk dt translated">即时阅读</li><li id="2a88" class="mc md ht ko b kp ml ks mm kv mn kz mo ld mp lh mh mi mj mk dt translated">发布-订阅</li><li id="7318" class="mc md ht ko b kp ml ks mm kv mn kz mo ld mp lh mh mi mj mk dt translated">请求-响应</li></ul><h2 id="ee05" class="mq jv ht bd jw mr ms mt ka mu mv mw ke kv mx my kg kz mz na ki ld nb nc kk nd dt translated">即时阅读神谕</h2><p id="8bc7" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">这种Oracle仅在其合同存储中存储一次数据，并且数据很少更新。那些希望查询这类数据的人通常是在“即时”的基础上这样做的；当需要信息时执行查找，并且可能永远不会重复。</p><p id="88a1" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">这些Oracless的例子包括那些存储由组织发布的信息的Oracle，如学术证书、机构文档、自治id等。</p><p id="f3eb" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">出于效率以及最重要的隐私原因，建议不要将oracle提供的原始数据存储在智能合约的存储中。</p><p id="c0ba" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">设计这种服务的一种有效方法是对数据进行散列，并且只将散列存储在智能契约的存储中。</p><h2 id="db0e" class="mq jv ht bd jw mr ms mt ka mu mv mw ke kv mx my kg kz mz na ki ld nb nc kk nd dt translated">发布-订阅Oracles</h2><p id="d504" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">当预计数据会定期频繁地发生变化时，发布-订阅Oracle可能是解决方案。它遵循与RSS提要相似的模式，oracle使用新信息进行更新，一个“标志”表明新数据对那些认为自己“已订阅”的人可用。</p><p id="60e5" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">要确定最新信息是否已更改，相关方必须轮询或监听oracle contracts的更新。</p><p id="762e" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">虽然在web服务器的世界中轮询效率非常低，但是在区块链生态系统的环境中，对数据更改的轮询只是对同步客户端的简单本地调用。然后，以太坊事件日志使应用程序特别容易寻找Oracle更新。</p><p id="27a5" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">这些Oracless的例子包括那些管理诸如价格馈送、天气信息、经济或社会统计、交通数据等信息的Oracle。</p><h2 id="a1bd" class="mq jv ht bd jw mr ms mt ka mu mv mw ke kv mx my kg kz mz na ki ld nb nc kk nd dt translated">请求-响应神谕</h2><p id="c4bf" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">当数据空间太大而无法保存在智能合同中，并且用户一次只想使用整个数据集的一小部分时，这种oracle非常适合。</p><p id="61cb" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">它通常由两部分组成，包括:</p><ul class=""><li id="81f7" class="mc md ht ko b kp li ks lj kv me kz mf ld mg lh mh mi mj mk dt translated">链上智能合约</li><li id="3dc0" class="mc md ht ko b kp ml ks mm kv mn kz mo ld mp lh mh mi mj mk dt translated">链外基础设施</li></ul><p id="85b0" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">数据请求通常是一个包含几个步骤的异步过程。</p><p id="2b45" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">首先，一个EOA与一个分散的应用程序<strong class="ko hu"> (1) </strong>进行交互，这是一个对Oracle smart contract中定义的函数的调用，带有一些相关的参数，如回调函数和调度参数。该功能实现了一个区块链交易<strong class="ko hu"> (2) </strong>。一旦这个交易被确认，离线基础设施就开始发挥作用。它用于监控Oracle请求<strong class="ko hu"> (3) </strong>(这可以被观察为Oracle契约发出的EVM事件，或者状态变化)。参数用于执行链外数据源<strong class="ko hu"> (4) </strong>的实际查询。最后，结果数据在一个事务中被交付给发出请求的分散式应用程序<strong class="ko hu"> (5) </strong>。</p><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ne"><img src="../Images/d3039d5ab6e0158fa811074946af34c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ugugnIxn36jIpyG5"/></div></div></figure><p id="0598" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">oracle还可能要求支付处理请求的费用、回调的汽油费用以及访问所请求数据的权限。</p><h1 id="050d" class="ju jv ht bd jw jx jy jz ka kb kc kd ke iz kf ja kg jc kh jd ki jf kj jg kk kl dt translated">Oracle示例</h1><p id="a7f4" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">下面是一个由<a class="ae nf" href="https://provable.xyz/" rel="noopener ugc nofollow" target="_blank">Provable</a>实现的请求-响应Oracle的基本示例。原代码可以在GitHub上的这里<a class="ae nf" href="https://github.com/provable-things/ethereum-examples/blob/master/solidity/DieselPrice.sol" rel="noopener ugc nofollow" target="_blank">找到。</a></p><p id="02cf" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">要与Provable集成，合同<strong class="ko hu"> DieselPrice </strong>必须是使用Provable 的<strong class="ko hu">的子<br/>。usingProvable contract在<a class="ae nf" href="https://github.com/provable-things/ethereum-api/blob/master/provableAPI.sol" rel="noopener ugc nofollow" target="_blank"> <strong class="ko hu"> provableAPI.sol </strong> </a>文件中定义。</strong></p><figure class="jj jk jl jm fq jn"><div class="bz el l di"><div class="ng nh l"/></div></figure><p id="c2b9" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">EOA通过调用<strong class="ko hu"> update() </strong>契约函数来请求数据。</p><p id="51c1" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">数据实际上是由<strong class="ko hu"> provable_query </strong>函数请求的。这是一个重载函数，至少需要两个参数:</p><ul class=""><li id="6399" class="mc md ht ko b kp li ks lj kv me kz mf ld mg lh mh mi mj mk dt translated">要使用的受支持的数据源(在这种情况下是URL，但也可以使用WolframAlpha、IPFS或其他数据源)</li><li id="37ca" class="mc md ht ko b kp ml ks mm kv mn kz mo ld mp lh mh mi mj mk dt translated">给定数据源的参数，可能包括使用<br/> JSON或XML解析帮助器</li></ul><p id="0c21" class="pw-post-body-paragraph km kn ht ko b kp li iu kr ks lj ix ku kv lk kx ky kz ll lb lc ld lm lf lg lh hm dt translated">一旦从所需的外部源中检索到数据，由被允许调用回调函数的Provable控制的帐户调用<strong class="ko hu"> __callback() </strong>函数；它传入响应值和一个唯一的<strong class="ko hu"> _myId </strong>参数，例如，它可以用于处理和跟踪Provable的多个挂起的回调。</p><h1 id="3532" class="ju jv ht bd jw jx jy jz ka kb kc kd ke iz kf ja kg jc kh jd ki jf kj jg kk kl dt translated">结论</h1><p id="b227" class="pw-post-body-paragraph km kn ht ko b kp kq iu kr ks kt ix ku kv kw kx ky kz la lb lc ld le lf lg lh hm dt translated">Oracles通过将外部事实带入等式中，在智能契约执行中发挥了重要作用。另一方面，它们也带来了潜在的巨大风险。采用这种方法，不仅要信任提供这种服务的甲骨文公司，还要信任服务提供商(例如fueleconomy.gov)。Oracle服务公司可能是恶意的，或者数据可能已损坏。这样，他们提供的契约就暴露给了潜在的错误输入，从而影响了它的执行。</p><blockquote class="ln"><p id="ee2c" class="lo lp ht bd lq lr ls lt lu lv lw lh ek translated">交易新手？试试<a class="ae nf" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或者<a class="ae nf" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>