<html>
<head>
<title>Explaining Metamask and its “Approve” transaction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解释元掩码及其“批准”事务</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/for-evm-networks-users-on-why-approve-tx-is-so-tricky-4563bd21c33f?source=collection_archive---------56-----------------------#2022-10-03">https://medium.com/coinmonks/for-evm-networks-users-on-why-approve-tx-is-so-tricky-4563bd21c33f?source=collection_archive---------56-----------------------#2022-10-03</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="cc13" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你好。假设你或多或少已经是一个<a class="ae jo" href="https://ethereum.org/en/" rel="noopener ugc nofollow" target="_blank">以太坊</a>虚拟机用户，那么很可能你已经熟悉在你的<a class="ae jo" href="https://metamask.io/" rel="noopener ugc nofollow" target="_blank"> Metamask </a>或任何其他EVM钱包上的“批准”交易，无论你何时处理各种可能的<a class="ae jo" href="https://ethereum.org/en/developers/docs/smart-contracts/#:~:text=A%20%22smart%20contract%22%20is%20simply,be%20the%20target%20of%20transactions." rel="noopener ugc nofollow" target="_blank">智能合约</a>。</p><h1 id="1d7a" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">什么是批准交易？</h1><p id="65a5" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hm dt translated">对于那些不知道该功能的人来说，这基本上是在以太坊链或其他符合ERC-20令牌标准的<a class="ae jo" href="https://ethereum.org/en/developers/docs/evm/" rel="noopener ugc nofollow" target="_blank"> EVM兼容</a>链上的任何DeFi智能合约中传输数据之前必须进行的第一笔交易。</p><h1 id="0d4f" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">这是为了什么？</h1><p id="805f" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hm dt translated">因为我们正在处理智能合约，所以我们必须将某些数据(例如令牌)传递给智能合约，以便以后自己处理它们。为了做到这一点，我们必须事先“批准”或“允许”这种情况发生，而不要求我们在DeFi应用程序中确认任何内部交易。每次我们确认这些交易时，我们都必须允许智能合约“消费”一定数量的代币。</p><p id="976f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在这个场景中，我们有两个身份参与其中:</p><p id="0c78" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="ks">值</em> —我们批准的智能合约将从我们的钱包中获取的<strong class="is hu">无限或有限* </strong>数量的令牌。</p><p id="c089" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="ks"> Spender </em> —我们允许接受代币的智能合约的地址。</p><p id="d950" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> *如果我们限制代币的消费金额，并且已经达到限额，下次我们必须“批准”或“允许”更多代币的智能合同。<br/>这让我们思考，为什么我们不允许智能合约从一开始就一次性使用我们所有的资金……</strong></p><h1 id="50aa" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">这种方法的利弊</h1><p id="e6f0" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hm dt translated">这里最大的难题是我们必须将安全、成本和便利分开。</p><p id="acd2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">从安全的角度来看，考虑到我们正在处理一个代码，我们应该只允许我们真正想花的钱。代码是年轻的，所以可能会被破坏或被黑客攻击。</p><p id="ee0b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">就便利性和成本而言，以太坊上的交易有时会变得昂贵，所以当我们不得不在钱包上额外点击时，我们可以感觉到我们的令牌是如何蒸发的。而且，如果每次点击的价格很贵，交易之间的时间可以更长，这会让我们感到恼火。</p><h1 id="061a" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">如何(不)被骗！</h1><p id="e90b" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hm dt translated">正如我之前提到的，代码可能会被黑客攻击，我们的钱会消失。在这里，只允许有限数量的资金可能是一个明智的选择，但是，如果我们已经被恶意的“批准”交易抓住了怎么办？在许多情况下，我们没有批准有效的tx，而是在一会儿后就没有了资金。我们确认，由于处理了错误的智能合同地址，我们没有在metamask(或其他)钱包上进行验证。</p><p id="89b5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们看看“批准”tx是什么样子，以及我们如何决定我们是否在处理合法的智能合同，并指定我们可以给它的金额。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="fe ff kt"><img src="../Images/69ec3528e5289bb8e7f038dccf9e39ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*aOjEG4Z3WRYehTPg"/></div><figcaption class="lb lc fg fe ff ld le bd b be z ek">Approve transaction before depositing 50 USDC into a smart contract</figcaption></figure><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="fe ff lf"><img src="../Images/44015c1f31dbb7d108a18e1fb316e4d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/0*Cc9agEaGFZu1D9lY"/></div><figcaption class="lb lc fg fe ff ld le bd b be z ek">We can edit permission for the contract address above the red rectangle</figcaption></figure><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="fe ff lf"><img src="../Images/cb2215d3a4fe980d35c230521f02d7d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/0*KUoWM_P4Vq5v7qDs"/></div><figcaption class="lb lc fg fe ff ld le bd b be z ek">Here we can specify how many tokens we allow a smart contract to operate for us</figcaption></figure><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="fe ff lf"><img src="../Images/a27afa45abacd8a03f8e73dc54b68456.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/0*CP1lo0bJvf3rO887"/></div><figcaption class="lb lc fg fe ff ld le bd b be z ek">Here I approved a maximum of 100USDC for a smart contract to operate. This means, whatever would happen it cannot take more money from my wallet than what is approved by me.</figcaption></figure><h1 id="e006" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">签署交易…</h1><p id="755d" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hm dt translated">最后一种经常发生的交易是符号交易。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div class="fe ff lf"><img src="../Images/630e6de7ce9d5938354e5af62a1e4a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:722/0*sgtKh5kd8WtCJjjL"/></div><figcaption class="lb lc fg fe ff ld le bd b be z ek">Example from 1inch aggregator</figcaption></figure><p id="b9b7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在上面的矩形中，我们已经看到了从哪个帐户到哪个服务的交互。在下方的矩形中，解释了我们要签名的内容。</p><h1 id="da34" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">硬件钱包怎么样，如何修改已经批准的交易？</h1><p id="0c71" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hm dt translated">简而言之，硬件钱包与此无关，一旦确认的交易不需要交互。但是，有一种方法可以修改我们的批准并允许区块链中的txs。<br/>我们可以使用一些服务来调用过去的txs。其中最受欢迎的是<a class="ae jo" href="https://revoke.cash/" rel="noopener ugc nofollow" target="_blank"> Revoke cash </a>，我们可以在大多数EVM网络中使用，非常简单易用。它提供了一个简单的用户界面和不断发展的UX。</p><figure class="ku kv kw kx fq ky fe ff paragraph-image"><div role="button" tabindex="0" class="lh li di lj bf lk"><div class="fe ff lg"><img src="../Images/a4a31f0d1696250c241e4f2a35d53067.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xls_ZjvGqe6R-m1J"/></div></div></figure><blockquote class="ll lm ln"><p id="b594" class="iq ir ks is b it iu iv iw ix iy iz ja lo jc jd je lp jg jh ji lq jk jl jm jn hm dt translated"><em class="ht">交易新手？试试</em> <a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a"> <em class="ht">密码交易机器人</em> </a> <em class="ht">或</em> <a class="ae jo" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c"> <em class="ht">复制交易</em> </a> <em class="ht">上</em> <a class="ae jo" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769"> <em class="ht">最好的密码交易所</em> </a></p></blockquote><blockquote class="lr"><p id="e056" class="ls lt ht bd lu lv lw lx ly lz ma jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jo" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h1 id="2e6f" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka mb kc kd ke mc kg kh ki md kk kl km dt translated">另外，阅读</h1><ul class=""><li id="e75c" class="me mf ht is b it kn ix ko jb mg jf mh jj mi jn mj mk ml mm dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/free-crypto-signals-48b25e61a8da">免费加密信号</a> | <a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a></li><li id="42a1" class="me mf ht is b it mn ix mo jb mp jf mq jj mr jn mj mk ml mm dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币</a>终极指南</li><li id="55b1" class="me mf ht is b it mn ix mo jb mp jf mq jj mr jn mj mk ml mm dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/top-17-folding-electric-bikes-5e296f0918cb"> 16款最佳折叠电动自行车</a></li><li id="d79e" class="me mf ht is b it mn ix mo jb mp jf mq jj mr jn mj mk ml mm dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/the-28-best-electric-bikes-review-and-buying-guide-in-2023-7bb3146cb403"> 28款最佳电动自行车点评</a></li><li id="8894" class="me mf ht is b it mn ix mo jb mp jf mq jj mr jn mj mk ml mm dt translated">前三名<a class="ae jo" rel="noopener" href="/coinmonks/top-3-binance-futures-trading-bots-e6031f84b3f9">币安期货交易机器人</a></li></ul></div></div>    
</body>
</html>