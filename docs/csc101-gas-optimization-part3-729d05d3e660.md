# CSC101-气体优化第 3 部分

> 原文：<https://medium.com/coinmonks/csc101-gas-optimization-part3-729d05d3e660?source=collection_archive---------38----------------------->

智能合同天然气优化是智能合同开发的最重要部分之一。这对我们减少能源消耗很有帮助。

为了成功，我们需要学习稳健如何处理我们的变量和功能。在本教程中，我们想谈谈坚固性优化方法。

这篇文章将为你提供一些在智能合同中减少汽油消耗的技巧。

![](img/78db353f85d00a7149d8bc2b6bc3c9de.png)

## 事件

如果您有在智能协定上创建的数据，但不需要由智能协定读取，那么事件是一个很好的选择。事件比状态变量消耗更少的气体。

## 装配

当您编译 Solidity 智能合约时，它会被转换为一系列 EVM(以太坊虚拟机)操作码。使用汇编语言，你可以编写非常接近操作码级别的代码。在如此低的级别编写代码并不容易，但好处是您可以手动优化操作码，并且在某些情况下胜过 Solidity 字节码。

我们已经在本教程中讨论了汇编:

[](/coinmonks/csc101-assembly-458e7324c021) [## CSC 101-装配

### 汇编或汇编语言表示一种低级编程语言，可以通过…

medium.com](/coinmonks/csc101-assembly-458e7324c021) 

## 常数

你可以在你的状态变量中有一些不变的值。常量值可用于气体优化。

这里举个例子:

*   用 const: 21420 gas 读取状态变量
*   读取无常量的状态变量:23541 气体

```
pragma solidity ^0.8.10
contract MyContract {
    //Gas cost : 21420 
    address public constant ADDR = 0x0........;
}

contract NoConstContract{
    //Gas Cost: 23541
    address public addr = 0x5B38Da6a701c568545dCfcB03FcB875f56beddC4;
}
```

## 图书馆

外在比内在好。如果您有许多使用相同功能的智能合约，您应该将所有这些功能提取到一个库中并部署它。
现在，所有智能合约都可以引用已部署的库，而不是一次又一次地部署相同的代码，并增加字节码长度。
因为这是一个已部署的库，所以要确保所有的函数都是`external`

## 固定大小的数组

如果我们知道数组应该有多长，我们指定一个固定的大小:

```
uint128[12] ID;
```

同样的规则也适用于字符串。一个`string`或`bytes`变量是动态调整大小的；如果我们的字符串足够短，我们应该使用一个`byte32`。

如果我们绝对需要一个动态数组，最好将我们的函数构造成加法而不是减法。扩展数组消耗的是常量气体，而截断数组消耗的是线性气体。

## 不要分配你永远不会用到的值

固体中的每一个变量赋值都要耗费汽油。在初始化变量时，我们经常浪费时间去指定永远不会用到的默认值。

`uint256 X;`比`uint256 X = 0;`便宜。

> 交易新手？尝试[加密交易机器人](/coinmonks/crypto-trading-bot-c2ffce8acb2a)或[复制交易](/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c)