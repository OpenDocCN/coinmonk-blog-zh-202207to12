<html>
<head>
<title>Ethereum data — EVM Traces simplified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太坊数据—简化的EVM轨迹</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethereum-data-evm-traces-simplified-5e297e4f40a4?source=collection_archive---------1-----------------------#2022-07-07">https://medium.com/coinmonks/ethereum-data-evm-traces-simplified-5e297e4f40a4?source=collection_archive---------1-----------------------#2022-07-07</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/b39e5be07fd3d8d62e99ba01008c753a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z-xBeHuEa2PoQozYOBKqug.png"/></div></div></figure><p id="9334" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">以太坊虚拟机(EVM)跟踪为事务的每个步骤提供详细的运行时数据，包括诸如使用的气体、结果、错误值等信息。与状态和事务不同，EVM跟踪不是区块链的一部分，不需要保存在节点上。</p><pre class="jz ka kb kc fq kd ke kf kg aw kh dt"><span id="d69c" class="ki kj ht ke b fv kk kl l km kn">💁‍♂️ Etherscan runs an instrumented EVM, allowing us to view traces from various clients (<a class="ae ko" href="https://etherscan.io/vmtrace?txhash=0xda8c0b80d8e240a83c8f6b067c4656babeb13e8e0ece4fd4292aa06252f1285c&amp;type=parity#raw" rel="noopener ugc nofollow" target="_blank">parity</a>, <a class="ae ko" href="https://etherscan.io/vmtrace?txhash=0xda8c0b80d8e240a83c8f6b067c4656babeb13e8e0ece4fd4292aa06252f1285c&amp;type=gethtrace2" rel="noopener ugc nofollow" target="_blank">geth</a>)</span></pre><h1 id="7441" class="kp kj ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">痕迹有什么帮助？</h1><h2 id="04a7" class="ki kj ht bd kq lm ln lo ku lp lq lr ky jm ls lt lc jq lu lv lg ju lw lx lk ly dt translated">调试错误</h2><p id="dbe7" class="pw-post-body-paragraph jb jc ht jd b je lz jg jh ji ma jk jl jm mb jo jp jq mc js jt ju md jw jx jy hm dt translated">当交易在EVM恢复时，状态被记录在交易收据中。但是，没有描述失败原因的其他信息。唯一的选择是检查痕迹以确定原因。</p><figure class="jz ka kb kc fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff me"><img src="../Images/b4c32c41d844fee6d918810275848d6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HZ453MGgmMKp0oB3RyvZYg.png"/></div></div><figcaption class="mf mg fg fe ff mh mi bd b be z ek">Parity VM trace — out of gas — <a class="ae ko" href="https://etherscan.io/vmtrace?txhash=0xda8c0b80d8e240a83c8f6b067c4656babeb13e8e0ece4fd4292aa06252f1285c&amp;type=parity#raw" rel="noopener ugc nofollow" target="_blank">Etherscan</a></figcaption></figure><h2 id="70cc" class="ki kj ht bd kq lm ln lo ku lp lq lr ky jm ls lt lc jq lu lv lg ju lw lx lk ly dt translated">内部通话/转接</h2><p id="3a11" class="pw-post-body-paragraph jb jc ht jd b je lz jg jh ji ma jk jl jm mb jo jp jq mc js jt ju md jw jx jy hm dt translated">任何智能合约的执行都始于外部账户发起的交易。反过来，智能合约可以与其他合约交互或进行转移。这些活动在区块链没有记录。例如，智能合同可以向一组用户空投令牌(即发送免费令牌)，但这一活动在区块链中不会被记录为交易。对于这样的活动，契约可以选择发出事件，然后可以在日志中查看这些事件。否则，观察它们的唯一方法就是监控痕迹。</p><blockquote class="mj mk ml"><p id="3c37" class="jb jc mm jd b je jf jg jh ji jj jk jl mn jn jo jp mo jr js jt mp jv jw jx jy hm dt translated">交易新手？试试<a class="ae ko" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或者<a class="ae ko" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote><p id="6615" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">需要监控的一些常见操作有:</p><p id="fa55" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">调用</strong>跟踪类型指示智能合约何时将以太网转移到另一个帐户或调用另一个合约的方法。</p><figure class="jz ka kb kc fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mq"><img src="../Images/94b7fc3e9cd3c015a64ecaa086dfa41b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OCwDtA_v6hs3gaeKtVBYMA.png"/></div></div><figcaption class="mf mg fg fe ff mh mi bd b be z ek">CALL — contract calling another contract</figcaption></figure><figure class="jz ka kb kc fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mr"><img src="../Images/a71cf4543ba698c6c559d254e31d6efd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wPZ0SHwwcKYu-mfw0snWLQ.png"/></div></div><figcaption class="mf mg fg fe ff mh mi bd b be z ek">Parity VM trace — CALL — <a class="ae ko" href="https://etherscan.io/vmtrace?txhash=0x0d13800319458a403500d407226328bbedbd8a10ff3d26a18c67872ac1f94ea7&amp;type=parity#raw" rel="noopener ugc nofollow" target="_blank">Etherscan</a></figcaption></figure><p id="1854" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">创建</strong>跟踪类型指示智能合约何时部署到以太网。智能合同可以由EOA帐户或其他智能合同部署。</p><figure class="jz ka kb kc fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ms"><img src="../Images/339df81914e87502ff4c67d8128036c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CshHSNl4zHlzpwrG5AQPAg.png"/></div></div><figcaption class="mf mg fg fe ff mh mi bd b be z ek">Parity VM Trace — CREATE — Smart contract deploys another contract — <a class="ae ko" href="https://etherscan.io/vmtrace?txhash=0xc5454999500f63794d593f2c995943ab0e8697dc9b2f61062ead1d875fdd0921&amp;type=parity#raw" rel="noopener ugc nofollow" target="_blank">Etherscan</a></figcaption></figure><p id="cc1a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">其他可能令人感兴趣的痕迹类型是自毁(合同从区块链删除)和奖励(对矿工的奖励)。通过检查跟踪数据，可以更好地理解事务中发生的事情。</p><h2 id="3385" class="ki kj ht bd kq lm ln lo ku lp lq lr ky jm ls lt lc jq lu lv lg ju lw lx lk ly dt translated">为什么轨迹不存储在大多数节点中？</h2><p id="a105" class="pw-post-body-paragraph jb jc ht jd b je lz jg jh ji ma jk jl jm mb jo jp jq mc js jt ju md jw jx jy hm dt translated">跟踪是一个耗时且耗费资源的过程。该节点必须能够存储和检索大量的跟踪数据。它还会降低节点同步整个区块链历史的能力。因为块验证或挖掘不需要存储跟踪，所以大多数节点在没有启用跟踪的情况下运行。</p><h2 id="2aa4" class="ki kj ht bd kq lm ln lo ku lp lq lr ky jm ls lt lc jq lu lv lg ju lw lx lk ly dt translated">如何找回EVM的痕迹？</h2><p id="b65c" class="pw-post-body-paragraph jb jc ht jd b je lz jg jh ji ma jk jl jm mb jo jp jq mc js jt ju md jw jx jy hm dt translated">有几种方法可以检索事务的EVM跟踪。</p><p id="073f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> a)在一个完整/归档节点中重放事务:</strong>以太坊客户端公开一些方法，这些方法试图以与先前执行事务相同的方式重新运行事务，并收集跟踪信息。虽然检索结果需要时间，但是只要有足够的信息来运行事务，节点就不需要存储跟踪。</p><p id="1abb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> b)运行启用跟踪的归档节点:</strong>以太坊客户端支持运行启用跟踪的节点。这将允许节点存储跟踪，以便可以快速检索它们，而不必重新执行事务。然而，这是以较高的成本和较慢的节点性能为代价的。</p><p id="ce97" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> c)使用API:</strong>诸如Infura或Alchemy之类的第三方服务管理启用跟踪的节点，并提供API端点来收集事务跟踪。虽然这是最简单的，但缺点是你必须依赖一个中央实体。</p><p id="e16d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="mm">我希望这篇文章已经让你对EVM痕迹有了更好的了解。如果您有任何问题或意见，请随时联系我们。</em><a class="ae ko" href="https://twitter.com/kirubakumaresh" rel="noopener ugc nofollow" target="_blank"><em class="mm">Twitter</em></a><em class="mm">|</em><a class="ae ko" href="https://www.linkedin.com/in/kirubakumaresh/" rel="noopener ugc nofollow" target="_blank"><em class="mm">LinkedIn</em></a></p></div></div>    
</body>
</html>