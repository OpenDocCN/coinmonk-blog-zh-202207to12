<html>
<head>
<title>CSC101- Gas Optimization Part3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CSC101-气体优化第3部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/csc101-gas-optimization-part3-729d05d3e660?source=collection_archive---------38-----------------------#2022-09-27">https://medium.com/coinmonks/csc101-gas-optimization-part3-729d05d3e660?source=collection_archive---------38-----------------------#2022-09-27</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="c692" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">智能合同天然气优化是智能合同开发的最重要部分之一。这对我们减少能源消耗很有帮助。</p><p id="9798" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了成功，我们需要学习稳健如何处理我们的变量和功能。在本教程中，我们想谈谈坚固性优化方法。</p><p id="5ba4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这篇文章将为你提供一些在智能合同中减少汽油消耗的技巧。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/78db353f85d00a7149d8bc2b6bc3c9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nYib8N6wIy-Papn96wyEKg.png"/></div></div></figure><h2 id="c2bb" class="ka kb ht bd kc kd ke kf kg kh ki kj kk jb kl km kn jf ko kp kq jj kr ks kt ku dt translated">事件</h2><p id="e1e1" class="pw-post-body-paragraph iq ir ht is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hm dt translated">如果您有在智能协定上创建的数据，但不需要由智能协定读取，那么事件是一个很好的选择。事件比状态变量消耗更少的气体。</p><h2 id="dd5b" class="ka kb ht bd kc kd ke kf kg kh ki kj kk jb kl km kn jf ko kp kq jj kr ks kt ku dt translated">装配</h2><p id="6354" class="pw-post-body-paragraph iq ir ht is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hm dt translated">当您编译Solidity智能合约时，它会被转换为一系列EVM(以太坊虚拟机)操作码。使用汇编语言，你可以编写非常接近操作码级别的代码。在如此低的级别编写代码并不容易，但好处是您可以手动优化操作码，并且在某些情况下胜过Solidity字节码。</p><p id="af21" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们已经在本教程中讨论了汇编:</p><div class="la lb fm fo lc ld"><a rel="noopener follow" target="_blank" href="/coinmonks/csc101-assembly-458e7324c021"><div class="le ab ej"><div class="lf ab lg cl cj lh"><h2 class="bd hu fv z el li eo ep lj er et hs dt translated">CSC 101-装配</h2><div class="lk l"><h3 class="bd b fv z el li eo ep lj er et ek translated">汇编或汇编语言表示一种低级编程语言，可以通过…</h3></div><div class="ll l"><p class="bd b gc z el li eo ep lj er et ek translated">medium.com</p></div></div><div class="lm l"><div class="ln l lo lp lq lm lr jy ld"/></div></div></a></div><h2 id="6479" class="ka kb ht bd kc kd ke kf kg kh ki kj kk jb kl km kn jf ko kp kq jj kr ks kt ku dt translated">常数</h2><p id="5e84" class="pw-post-body-paragraph iq ir ht is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hm dt translated">你可以在你的状态变量中有一些不变的值。常量值可用于气体优化。</p><p id="0113" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这里举个例子:</p><ul class=""><li id="dc33" class="ls lt ht is b it iu ix iy jb lu jf lv jj lw jn lx ly lz ma dt translated">用const: 21420 gas读取状态变量</li><li id="fc84" class="ls lt ht is b it mb ix mc jb md jf me jj mf jn lx ly lz ma dt translated">读取无常量的状态变量:23541气体</li></ul><pre class="jp jq jr js fq mg mh mi mj aw mk dt"><span id="5a28" class="ka kb ht mh b fv ml mm l mn mo">pragma solidity ^0.8.10<br/>contract MyContract {<br/>    //Gas cost : 21420 <br/>    address public constant ADDR = 0x0........;<br/>}<br/><br/>contract NoConstContract{<br/>    //Gas Cost: 23541<br/>    address public addr = 0x5B38Da6a701c568545dCfcB03FcB875f56beddC4;<br/>}</span></pre><h2 id="4d67" class="ka kb ht bd kc kd ke kf kg kh ki kj kk jb kl km kn jf ko kp kq jj kr ks kt ku dt translated">图书馆</h2><p id="bdc7" class="pw-post-body-paragraph iq ir ht is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hm dt translated">外在比内在好。如果您有许多使用相同功能的智能合约，您应该将所有这些功能提取到一个库中并部署它。<br/>现在，所有智能合约都可以引用已部署的库，而不是一次又一次地部署相同的代码，并增加字节码长度。<br/>因为这是一个已部署的库，所以要确保所有的函数都是<code class="eh mp mq mr mh b">external</code></p><h2 id="2e3d" class="ka kb ht bd kc kd ke kf kg kh ki kj kk jb kl km kn jf ko kp kq jj kr ks kt ku dt translated">固定大小的数组</h2><p id="4fb1" class="pw-post-body-paragraph iq ir ht is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hm dt translated">如果我们知道数组应该有多长，我们指定一个固定的大小:</p><pre class="jp jq jr js fq mg mh mi mj aw mk dt"><span id="f0e5" class="ka kb ht mh b fv ml mm l mn mo">uint128[12] ID;</span></pre><p id="dd11" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">同样的规则也适用于字符串。一个<code class="eh mp mq mr mh b">string</code>或<code class="eh mp mq mr mh b">bytes</code>变量是动态调整大小的；如果我们的字符串足够短，我们应该使用一个<code class="eh mp mq mr mh b">byte32</code>。</p><p id="ace5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果我们绝对需要一个动态数组，最好将我们的函数构造成加法而不是减法。扩展数组消耗的是常量气体，而截断数组消耗的是线性气体。</p><h2 id="bcd3" class="ka kb ht bd kc kd ke kf kg kh ki kj kk jb kl km kn jf ko kp kq jj kr ks kt ku dt translated">不要分配你永远不会用到的值</h2><p id="b7a9" class="pw-post-body-paragraph iq ir ht is b it kv iv iw ix kw iz ja jb kx jd je jf ky jh ji jj kz jl jm jn hm dt translated">固体中的每一个变量赋值都要耗费汽油。在初始化变量时，我们经常浪费时间去指定永远不会用到的默认值。</p><p id="46fa" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh mp mq mr mh b">uint256 X;</code>比<code class="eh mp mq mr mh b">uint256 X = 0;</code>便宜。</p><blockquote class="ms"><p id="38df" class="mt mu ht bd mv mw mx my mz na nb jn ek translated">交易新手？尝试<a class="ae nc" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae nc" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>