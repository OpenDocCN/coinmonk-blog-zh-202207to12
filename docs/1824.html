<html>
<head>
<title>How to Write a Smart Contract in Solidity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Solidity中写一份聪明的合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-write-a-smart-contract-in-solidity-c560ee34af7?source=collection_archive---------11-----------------------#2022-08-06">https://medium.com/coinmonks/how-to-write-a-smart-contract-in-solidity-c560ee34af7?source=collection_archive---------11-----------------------#2022-08-06</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="27a5" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">用Solidity编写智能合同的初学者指南</h2></div><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div role="button" tabindex="0" class="jo jp di jq bf jr"><div class="fe ff ji"><img src="../Images/ac9b5930006ad7221a3abdee5f2aeb3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNw12PgXF0Urr5SsnwoPkA.jpeg"/></div></div></figure><h2 id="cb62" class="ju jv ht bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">什么是智能合同？</h2><p id="ef21" class="pw-post-body-paragraph ks kt ht ku b kv kw iu kx ky kz ix la kf lb lc ld kj le lf lg kn lh li lj lk hm dt translated">智能协定包含业务逻辑和状态。它是用Solidity这样的高级语言编写的，被编译成以太坊虚拟机(EVM)字节码，并部署到以太坊、Polygon、币安智能链、Cardano、Tron等EVM兼容的区块链上。</p><blockquote class="ll lm ln"><p id="4760" class="ks kt lo ku b kv lp iu kx ky lq ix la lr ls lc ld lt lu lf lg lv lw li lj lk hm dt translated">可靠意义上的契约是代码(其<em class="ht">函数</em>)和数据(其<em class="ht">状态</em>)的集合，它们驻留在与EVM兼容的区块链上的特定地址。</p></blockquote><p id="1c74" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">通过调用修改状态的智能合约函数，生成事务，并且事务是可跟踪的、透明的和不可逆的。</p><blockquote class="ll lm ln"><p id="19a1" class="ks kt lo ku b kv lp iu kx ky lq ix la lr ls lc ld lt lu lf lg lv lw li lj lk hm dt translated">智能合同是执行合同条款的计算机化交易协议。</p><p id="2dee" class="ks kt lo ku b kv lp iu kx ky lq ix la lr ls lc ld lt lu lf lg lv lw li lj lk hm dt translated">智能合同设计的一般目标是满足常见的合同条件(如支付条款、留置权、保密性，甚至强制执行)，最大限度地减少恶意和意外的例外，并最大限度地减少对可信中介的需求。</p><p id="e359" class="ks kt lo ku b kv lp iu kx ky lq ix la lr ls lc ld lt lu lf lg lv lw li lj lk hm dt translated">相关的经济目标包括降低欺诈损失、仲裁和执行成本以及其他交易成本— <a class="ae lx" href="https://www.fon.hum.uva.nl/rob/Courses/InformationInSpeech/CDROM/Literature/LOTwinterschool2006/szabo.best.vwh.net/smart.contracts.html" rel="noopener ugc nofollow" target="_blank">尼克·萨伯</a></p></blockquote><h2 id="9229" class="ju jv ht bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">智能合约(Solidity)是什么样子的？</h2><figure class="jj jk jl jm fq jn fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/cf96ae3ff2c180fa654d0894da428f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*oJqZQvMwpcxQaTGk5AG-QA.png"/></div><figcaption class="lz ma fg fe ff mb mc bd b be z ek">High-level contract structure</figcaption></figure><p id="347d" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">第一行告诉你合同是根据哪一个<strong class="ku hu">许可</strong>发布的，因此在什么条件下你可以使用代码。你可以在这里找到一个许可证列表<a class="ae lx" href="https://freedomdefined.org/Licenses#List_of_licenses" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="147d" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">在第二行中，您可以找到受支持的编译器<strong class="ku hu">版本</strong>。</p><p id="bbdf" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated"><strong class="ku hu">状态变量</strong>，所有在函数之外定义的变量都是状态变量。在上面的契约中，只有<em class="lo"> _proposalVotes </em>是状态变量。</p><p id="6603" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">之后，声明一个<strong class="ku hu">枚举</strong>，它包含一个命名常量列表，每个常量都有一个从0开始的整数值。比如反对= 0，赞成= 1，弃权= 2。</p><p id="71ad" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated"><strong class="ku hu"> Struct </strong>是由多个变量组成的复合数据类型，相关变量可以像用户或投票一样分组在一起。</p><p id="9780" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">映射是一个键值存储，为不存在的条目返回默认值。一个更简单的映射:</p><pre class="jj jk jl jm fq md me mf mg aw mh dt"><span id="68ed" class="ju jv ht me b fv mi mj l mk ml">mapping(address =&gt; uint256) public userBalances;</span></pre><p id="41a8" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">如果您尝试输入一个尚未添加的地址，您将收到0，这是uint的默认初始化。</p><p id="fa3f" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated"><strong class="ku hu">函数</strong>封装了契约的逻辑。他们可以访问状态和内联定义的内存变量。可以被修饰词改变。具有可见性，并且可以定义访问级别。可以引发事件，也可以保存控制语句。并且它们可以向调用者返回值。</p><p id="73b6" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">示例<em class="lo"> proposalVotes </em>中的函数具有访问级别视图，这意味着它不会改变状态，因此不会生成记录在区块链上的事务。</p><p id="3f68" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">如果一个功能具有访问级别<strong class="ku hu">视图</strong>，它不能执行以下操作:</p><ul class=""><li id="483d" class="mm mn ht ku b kv lp ky lq kf mo kj mp kn mq lk mr ms mt mu dt translated">写入状态变量</li><li id="3768" class="mm mn ht ku b kv mv ky mw kf mx kj my kn mz lk mr ms mt mu dt translated">收到付款</li><li id="819f" class="mm mn ht ku b kv mv ky mw kf mx kj my kn mz lk mr ms mt mu dt translated">上升事件</li><li id="ef99" class="mm mn ht ku b kv mv ky mw kf mx kj my kn mz lk mr ms mt mu dt translated">创建新合同</li><li id="da53" class="mm mn ht ku b kv mv ky mw kf mx kj my kn mz lk mr ms mt mu dt translated">调用另一个没有用访问级别视图或pure标记的函数</li></ul><h2 id="cde7" class="ju jv ht bd jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr dt translated">什么是气体？</h2><p id="c19c" class="pw-post-body-paragraph ks kt ht ku b kv kw iu kx ky kz ix la kf lb lc ld kj le lf lg kn lh li lj lk hm dt translated">每当在区块链上部署合同或记录交易时，费用都以天然气的形式收取。</p><p id="091b" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">Gas的数量取决于EVM在执行事务或部署契约时花费的计算资源。</p><p id="10dd" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">目前以太坊的煤气费相当高，而其他区块链像多边形和币安智能链有低得多的煤气费。</p><p id="a45d" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">您可以在下面的列表中查看实际的燃气费，我在撰写本文时添加了正常的燃气费以获得快速印象，这些费用和执行时间是平均的:</p><ul class=""><li id="fffc" class="mm mn ht ku b kv lp ky lq kf mo kj mp kn mq lk mr ms mt mu dt translated"><a class="ae lx" href="https://cointool.app/gasPrice/eth" rel="noopener ugc nofollow" target="_blank">以太坊</a>(正常0.50美元，执行时间1分钟)</li><li id="e1f8" class="mm mn ht ku b kv mv ky mw kf mx kj my kn mz lk mr ms mt mu dt translated"><a class="ae lx" href="https://cointool.app/gasPrice/matic" rel="noopener ugc nofollow" target="_blank">多边形</a>(普通$0.0006948991，执行时间5秒)</li><li id="d486" class="mm mn ht ku b kv mv ky mw kf mx kj my kn mz lk mr ms mt mu dt translated"><a class="ae lx" href="https://cointool.app/gasPrice/bsc" rel="noopener ugc nofollow" target="_blank">币安智能链</a>(正常0.0323美元，执行时间5秒)</li></ul><p id="2485" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">以太坊目前比其他区块链更贵、更慢，但相比之下也是最安全的网络。</p><p id="da10" class="pw-post-body-paragraph ks kt ht ku b kv lp iu kx ky lq ix la kf ls lc ld kj lu lf lg kn lw li lj lk hm dt translated">您可以在这里更深入地了解智能合约的基础知识<a class="ae lx" href="https://docs.soliditylang.org/en/v0.8.15/introduction-to-smart-contracts.html" rel="noopener ugc nofollow" target="_blank">。</a></p><blockquote class="na"><p id="8b64" class="nb nc ht bd nd ne nf ng nh ni nj lk ek translated"><em class="nk">加入Coinmonks </em> <a class="ae lx" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank"> <em class="nk">电报频道</em> </a> <em class="nk">和</em> <a class="ae lx" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> <em class="nk"> Youtube频道</em> </a> <em class="nk">了解加密交易和投资</em></p></blockquote><h1 id="9c01" class="nl jv ht bd jw nm nn no ka np nq nr ke iz ns ja ki jc nt jd km jf nu jg kq nv dt translated">另外，阅读</h1><ul class=""><li id="018c" class="mm mn ht ku b kv kw ky kz kf nw kj nx kn ny lk mr ms mt mu dt translated"><a class="ae lx" rel="noopener" href="/coinmonks/3commas-review-an-excellent-crypto-trading-bot-2020-1313a58bec92">3商业评论</a> | <a class="ae lx" href="https://coincodecap.com/pionex-review-exchange-with-crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"> Pionex评论</a> | <a class="ae lx" rel="noopener" href="/coinmonks/coinrule-review-2021-a-beginner-friendly-crypto-trading-bot-daf0504848ba"> Coinrule评论</a></li><li id="d6a1" class="mm mn ht ku b kv mv ky mw kf mx kj my kn mz lk mr ms mt mu dt translated"><a class="ae lx" rel="noopener" href="/coinmonks/ledger-vs-ngrave-zero-7e40f0c1d694">莱杰vs n rave</a>|<a class="ae lx" rel="noopener" href="/coinmonks/ledger-nano-s-vs-x-battery-hardware-price-storage-59a6663fe3b0">莱杰nano s vs x </a> | <a class="ae lx" rel="noopener" href="/coinmonks/binance-review-ee10d3bf3b6e">币安评论</a></li><li id="7d11" class="mm mn ht ku b kv mv ky mw kf mx kj my kn mz lk mr ms mt mu dt translated"><a class="ae lx" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a> | <a class="ae lx" href="https://coincodecap.com/bingbon-review" rel="noopener ugc nofollow" target="_blank"> Bingbon评论</a></li><li id="3361" class="mm mn ht ku b kv mv ky mw kf mx kj my kn mz lk mr ms mt mu dt translated"><a class="ae lx" rel="noopener" href="/coinmonks/bybit-exchange-review-dbd570019b71"> Bybit Exchange审查</a> | <a class="ae lx" href="https://coincodecap.com/bityard-reivew" rel="noopener ugc nofollow" target="_blank"> Bityard审查</a> | <a class="ae lx" href="https://coincodecap.com/jet-bot-review" rel="noopener ugc nofollow" target="_blank"> Jet-Bot审查</a></li></ul></div></div>    
</body>
</html>