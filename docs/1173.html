<html>
<head>
<title>Comprehensive Hardhat Solidity Environment Setup for Beginners</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向初学者的全面的Hardhat Solidity环境设置</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/comprehensive-hardhat-solidity-environment-setup-for-beginners-2a284706beaa?source=collection_archive---------9-----------------------#2022-07-24">https://medium.com/coinmonks/comprehensive-hardhat-solidity-environment-setup-for-beginners-2a284706beaa?source=collection_archive---------9-----------------------#2022-07-24</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="f828" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><em class="jo">对于大多数刚开始学习Web3 &amp; Solidity的开发人员来说，选择最好的开发环境可能会很困难，并可能成为学习进度的障碍。在本文中，我们将学习如何使用</em> <a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank"> <em class="jo">【安全帽】</em> </a> <em class="jo">来设置您的开发环境。</em></p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff jq"><img src="../Images/866e1c3313ee9226d42d921638282794.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SpR6Ctgkw2n71UtmNWzGKg.jpeg"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Hardhat image from<a class="ae jp" href="https://hardhat.org/card.jpg" rel="noopener ugc nofollow" target="_blank"> Hardhat Image</a></figcaption></figure><h1 id="a6a0" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">什么是安全帽？</h1><p id="a5dc" class="pw-post-body-paragraph iq ir ht is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated"><a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank"> Hardhat </a>是dApps的开发环境。它由不同的组件组成，用于编辑、编译、调试、测试和部署您的智能合约和dApps，所有这些组件共同创建一个完整的开发环境。</p><p id="392e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">就您最终使用的工具而言，Hardhat 并不流行，但它确实带有一些内置的默认设置。我们将使用内置的默认值和一些额外的插件。大多数情况下你需要的插件都包含在这个设置中。</p><h2 id="e0f9" class="lj kh ht bd ki lk ll lm km ln lo lp kq jb lq lr ku jf ls lt ky jj lu lv lc lw dt translated"><strong class="ak">系统要求</strong></h2><p id="30d6" class="pw-post-body-paragraph iq ir ht is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">因为<a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank"> Hardhat </a>库和工具都是用JavaScript写的。你必须在你的系统中安装<a class="ae jp" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>和<a class="ae jp" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>。任何代码编辑器都应该工作，但我个人更喜欢<a class="ae jp" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank"> Visual Studio代码</a>编辑器，因为它有<a class="ae jp" href="https://marketplace.visualstudio.com/items?itemName=NomicFoundation.hardhat-solidity" rel="noopener ugc nofollow" target="_blank"> Solidity + Hardhat </a>扩展，提供Solidity语言支持和Hardhat集成。</p><h1 id="9cf3" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated"><strong class="ak">建立安全帽项目</strong></h1><p id="3bae" class="pw-post-body-paragraph iq ir ht is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">创建新的空目录，然后进入。首先，我们使用<a class="ae jp" href="https://www.npmjs.com/" rel="noopener ugc nofollow" target="_blank"> npm </a>初始化fresh <a class="ae jp" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>项目:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="31c5" class="lj kh ht ly b fv mc md l me mf">npm init -y</span></pre><p id="d138" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后你需要安装<a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank">安全帽</a>:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="a49f" class="lj kh ht ly b fv mc md l me mf">npm install --save-dev hardhat</span></pre><p id="82e2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在运行<code class="eh mg mh mi ly b">npx hardhat</code>，然后你会看到一些选项:</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff mj"><img src="../Images/762bc5acb5a8597656b457b7ddd1b48b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*Oe2HNkglwx3gqibP9ly0Cw.png"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">options to facilitate project creation</figcaption></figure><p id="7fc6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">选择<em class="jo">创建Javascript项目</em>选项，然后选择<em class="jo"> (y) </em>添加<code class="eh mg mh mi ly b">.gitignore</code>。然后，您将使用以下结构初始化项目:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="78e3" class="lj kh ht ly b fv mc md l me mf">contracts/ <br/>scripts/ <br/>test/ <br/>hardhat.config.js</span></pre><p id="ebb0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这些是安全帽项目的默认路径。</p><ul class=""><li id="76d0" class="mk ml ht is b it iu ix iy jb mm jf mn jj mo jn mp mq mr ms dt translated"><code class="eh mg mh mi ly b">contracts/</code>是您的合同的源文件所在的位置。</li><li id="869d" class="mk ml ht is b it mt ix mu jb mv jf mw jj mx jn mp mq mr ms dt translated"><code class="eh mg mh mi ly b">test/</code>是你的测试应该去的地方。</li><li id="c5f4" class="mk ml ht is b it mt ix mu jb mv jf mw jj mx jn mp mq mr ms dt translated"><code class="eh mg mh mi ly b">scripts/</code>是简单自动化脚本的去处。</li></ul><h1 id="d812" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated"><strong class="ak">依赖项和插件安装</strong></h1><p id="53ef" class="pw-post-body-paragraph iq ir ht is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">现在我们将安装必要的依赖项和一些有用的插件。</p><p id="0d0f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae jp" href="https://hardhat.org/hardhat-runner/plugins/nomicfoundation-hardhat-toolbox" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">安全帽工具箱</strong> </a></p><p id="e995" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这些依赖项中最重要的是<a class="ae jp" href="https://hardhat.org/hardhat-runner/plugins/nomicfoundation-hardhat-toolbox" rel="noopener ugc nofollow" target="_blank"> Hardhat Toolbox </a>，这个插件捆绑了几乎所有你开始开发dApps所需的东西。运行以下命令:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="35cf" class="lj kh ht ly b fv mc md l me mf">npm install --save-dev "hardhat@^2.10.1" "@nomicfoundation/hardhat-toolbox@^1.0.2"</span></pre><p id="6f2a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个插件非常重要，因为它捆绑了所有常用的包，以前我们必须单独安装这些包才能开始使用<a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank"> Hardhat </a>进行开发，比如:</p><ul class=""><li id="4f4b" class="mk ml ht is b it iu ix iy jb mm jf mn jj mo jn mp mq mr ms dt translated"><code class="eh mg mh mi ly b">hardhat-ethers</code>使用<a class="ae jp" href="https://docs.ethers.io/" rel="noopener ugc nofollow" target="_blank"> ethers.js </a>与合同交互的插件。</li><li id="b976" class="mk ml ht is b it mt ix mu jb mv jf mw jj mx jn mp mq mr ms dt translated"><a class="ae jp" href="https://www.chaijs.com/" rel="noopener ugc nofollow" target="_blank">柴</a>和<a class="ae jp" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank">摩卡</a>测试你的智能合约。</li><li id="9bed" class="mk ml ht is b it mt ix mu jb mv jf mw jj mx jn mp mq mr ms dt translated"><code class="eh mg mh mi ly b">hardhat-etherscan</code>验证智能合约源代码的插件。</li><li id="d3cb" class="mk ml ht is b it mt ix mu jb mv jf mw jj mx jn mp mq mr ms dt translated"><code class="eh mg mh mi ly b">hardhat-gas-reporter</code>智能合同使用的天然气指标插件。</li><li id="a550" class="mk ml ht is b it mt ix mu jb mv jf mw jj mx jn mp mq mr ms dt translated">用<code class="eh mg mh mi ly b">solidity-coverage</code>测量测试覆盖率。</li></ul><p id="f872" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将在后面讨论这些插件的用法和功能。</p><p id="13f1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">注意:</strong>请安装版本高于<code class="eh mg mh mi ly b">1.0.2</code>的<code class="eh mg mh mi ly b">@hardhat-toolbox</code>以避免安装问题。</p><p id="e75e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae jp" href="https://github.com/prettier-solidity/prettier-plugin-solidity" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">美观结实</strong> </a></p><p id="1027" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">虽然你可以说这个插件可能不是必要的，但是使用prettier尽早自动格式化你的代码是代码可读性的一个很好的实践，并且遵循最佳实践来编写你的Solidity代码。</p><p id="c01e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">运行以下命令安装<code class="eh mg mh mi ly b">prettier</code>和<code class="eh mg mh mi ly b">prettier-plugin-solidity</code>:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="c79c" class="lj kh ht ly b fv mc md l me mf">npm install --save-dev prettier prettier-plugin-solidity</span></pre><p id="245a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">(可选)</strong>您可以根据自己的偏好覆盖更漂亮的默认配置，在根项目目录中创建<code class="eh mg mh mi ly b">.prettierrc</code>文件，并将配置放在那里:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="83f6" class="lj kh ht ly b fv mc md l me mf">{</span><span id="bea7" class="lj kh ht ly b fv my md l me mf">  "tabWidth": 4,  <br/>  "useTabs": false,  <br/>  "semi": false,  <br/>  "singleQuote": false</span><span id="9f33" class="lj kh ht ly b fv my md l me mf">}</span></pre><p id="0328" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这些行只是基于我的偏好的例子，你可以在<a class="ae jp" href="https://prettier.io/docs/en/configuration.html" rel="noopener ugc nofollow" target="_blank">更漂亮的文档</a>中阅读更多关于你可以配置的内容。</p><p id="cac7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae jp" href="https://github.com/wighawag/hardhat-deploy" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">安全帽部署</strong> </a></p><p id="280c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个<a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank"> Hardhat </a>插件增加了一个将合同部署到任何网络的机制，跟踪它们并复制相同的测试环境，以及许多改善开发人员部署智能合同体验的功能。</p><p id="0700" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh mg mh mi ly b">hardhat-deploy</code>允许您在<code class="eh mg mh mi ly b">deploy</code>文件夹中编写部署脚本。然后用<code class="eh mg mh mi ly b">deploy</code>命令执行，而不是默认的<code class="eh mg mh mi ly b">run</code>脚本。</p><p id="c218" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要安装<code class="eh mg mh mi ly b">hardhat-deploy</code>，运行以下命令:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="92f1" class="lj kh ht ly b fv mc md l me mf">npm install -D hardhat-deploy</span><span id="1bf7" class="lj kh ht ly b fv my md l me mf">// then run this command to install hardhat-deploy-ethers</span><span id="13c4" class="lj kh ht ly b fv my md l me mf">npm install --save-dev  <a class="ae jp" href="http://twitter.com/nomiclabs/hardhat-ethers" rel="noopener ugc nofollow" target="_blank">@nomiclabs/hardhat-ethers</a>@npm:hardhat-deploy-ethers ethers</span></pre><p id="6271" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Dotenv</p><p id="8502" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh mg mh mi ly b">dotenv </code>是一个零依赖模块，将环境变量从<code class="eh mg mh mi ly b">.env</code>文件加载到<code class="eh mg mh mi ly b"><a class="ae jp" href="https://nodejs.org/docs/latest/api/process.html#process_process_env" rel="noopener ugc nofollow" target="_blank">process.env</a></code>中。因为在开发dApps时，我们将大量使用外部API和wallet。最佳实践是将您的wallet私有密钥和API密钥存储在位于您的根项目目录中的<code class="eh mg mh mi ly b">.env</code>上，然后以编程方式将其加载到您的代码中。</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="afbc" class="lj kh ht ly b fv mc md l me mf">npm install dotenv --save --force</span></pre><p id="e72b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">注意:</strong>请把你的<code class="eh mg mh mi ly b">.env</code>放入你的<code class="eh mg mh mi ly b">.gitignore</code>档，为了你的发展，永远使用单独的“不那么重要”的钱包。千万不要分享和暴露自己的钱包私钥！</p><p id="eaa8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这应该会完成依赖项和插件的安装。</p><h1 id="9951" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">安全帽配置</h1><p id="56f7" class="pw-post-body-paragraph iq ir ht is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated"><a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank">安全帽</a>项目设置管理集中在<code class="eh mg mh mi ly b">hardhat.config.js</code>中。前面初始化项目时生成的一个<code class="eh mg mh mi ly b">.js</code>文件。当配置开发环境时，我们将主要在这个文件中工作。</p><p id="8cf6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">导入插件</strong></p><p id="9bd3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你可以简单地导入所有在<code class="eh mg mh mi ly b">hardhat.config.js</code>顶部有<code class="eh mg mh mi ly b">require</code>行的插件</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="7a08" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">配置编译器</strong></p><p id="7c5e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您需要定制Solidity编译器选项，您可以通过<code class="eh mg mh mi ly b">hardhat.config.js</code>中的<code class="eh mg mh mi ly b">solidity</code>字段进行更改:</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="af97" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你可以简单地定义单个编译器，或者如果你需要多个编译器，你可以把它放在<code class="eh mg mh mi ly b">compilers</code>数组中，如代码示例所示。</p><p id="736a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">网络配置</strong></p><p id="20af" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank">安全帽</a>内置一个叫做<code class="eh mg mh mi ly b">hardhat</code>的特殊网络。使用此网络时，当您运行任务、部署或测试智能合约时，将会创建一个Hardhat网络实例。</p><p id="5d1d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">虽然内置网络有助于快速部署和测试，但在实际场景中，您希望智能合约可在实际网络中访问，<a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank"> Hardhat </a>支持您连接基于JSON-PRC的网络，以满足该场景。</p><p id="370a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh mg mh mi ly b">hardhat.config.js</code>中的<code class="eh mg mh mi ly b">networks</code>配置字段是放置网络配置的地方。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="ddc1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">通过设置配置的<code class="eh mg mh mi ly b">defaultNetwork</code>字段，您可以自定义运行Hardhat时默认使用的网络。如果省略这个配置，它的默认值是<code class="eh mg mh mi ly b">"hardhat"</code>。但我更喜欢明确定义为<code class="eh mg mh mi ly b">"hardhat"</code>。</p><p id="15a0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后，在<code class="eh mg mh mi ly b">networks</code>字段中，您定义您想要使用的所有网络，在本例中为Rinkeby。放置<code class="eh mg mh mi ly b">url</code> JSON-RPC、<code class="eh mg mh mi ly b">accounts</code>私钥和<code class="eh mg mh mi ly b">chainId</code>。你可以在<a class="ae jp" href="https://hardhat.org/hardhat-runner/docs/config#networks-configuration" rel="noopener ugc nofollow" target="_blank">文档</a>中阅读更多关于网络配置的信息。</p><p id="60e1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">气体报告器</strong></p><p id="c408" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh mg mh mi ly b">hardhat-gas-reporter</code>提供关于单位测试气体使用量、方法调用和部署指标以及自定义国家货币成本的报告。这些信息对于您创建优化的智能合同至关重要且非常有用。</p><p id="fa43" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">至少，您只需要将带有<code class="eh mg mh mi ly b">enabled : true</code>的<code class="eh mg mh mi ly b">gasReporter</code>字段放在<code class="eh mg mh mi ly b">hardhat.config.js</code>中，但是您也可以自定义<code class="eh mg mh mi ly b">gasReporter</code>来使用您自己的货币，或者将输出写在项目目录中。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="32ab" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您想使用自定义货币，如“USD ”,您需要创建<a class="ae jp" href="https://coinmarketcap.com/api/documentation/v1/" rel="noopener ugc nofollow" target="_blank"> CoinMarketCap </a>帐户并获取API密钥，在<code class="eh mg mh mi ly b">coinmarketcap</code>字段中提供密钥，然后就可以开始了。</p><p id="f7a8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae jp" href="https://etherscan.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu">以太扫描</strong> </a> <strong class="is hu">验证</strong></p><p id="a5b3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh mg mh mi ly b">hardhat-etherscan</code>插件帮助您在<a class="ae jp" href="https://etherscan.io/" rel="noopener ugc nofollow" target="_blank"> Etherscan </a>上验证您的Solidity合同的源代码。感谢<a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank">安全帽</a>和<a class="ae jp" href="https://hardhat.org/hardhat-runner/plugins/nomicfoundation-hardhat-toolbox" rel="noopener ugc nofollow" target="_blank">安全帽工具箱</a>，我们只需要在配置文件的<code class="eh mg mh mi ly b">etherscan</code>字段中提供<code class="eh mg mh mi ly b">apiKey</code>。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="5390" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你只需创建<a class="ae jp" href="https://etherscan.io/" rel="noopener ugc nofollow" target="_blank"> Etherscan </a>账户就可以获得API密匙。</p><p id="75ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">设置调配账户</strong></p><p id="aa58" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了让<code class="eh mg mh mi ly b">hardhat-deploy</code>工作，我们需要为部署者定义<code class="eh mg mh mi ly b">namedAccounts</code>字段。它基本上说明了我们在钱包中使用哪个地址作为智能合同部署者，在本例中，我选择第一个帐户。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="61f7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这应该会完成依赖项和插件的安装。</p><h1 id="9104" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">开发流程设置</h1><p id="61c5" class="pw-post-body-paragraph iq ir ht is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">Hardhat的开发周期通常从开发Solidity smart契约开始，然后定义测试单元，创建部署脚本，最后运行管道。</p><p id="e844" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">虽然在<a class="ae jp" href="https://hardhat.org/hardhat-runner/docs/getting-started#overview" rel="noopener ugc nofollow" target="_blank"> Hardhat文档</a>中已经明确定义了开发和定义测试单元，但是部署脚本过程是不同的，因此我们需要创建一些调整来设置我们的管道。</p><p id="6bb9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">验证脚本</strong></p><p id="ccb8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">首先，我们在您需要在根项目目录中创建的新的<code class="eh mg mh mi ly b">utils</code>文件夹中创建验证脚本，以便轻松地将其导入并放入我们的部署管道中。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="7e36" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">创建部署脚本</strong></p><p id="cec4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在项目根目录下创建一个名为<code class="eh mg mh mi ly b">deploy</code>的新目录，并在该目录下创建一个名为<code class="eh mg mh mi ly b">01-deploy-sample.js</code>的新文件。</p><figure class="jr js jt ju fq jv"><div class="bz el l di"><div class="mz na l"/></div></figure><p id="ee81" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh mg mh mi ly b">01-deploy-sample.js</code>基本上是我们初始化项目时生成的<code class="eh mg mh mi ly b">scripts/deploy.js</code>文件的<code class="eh mg mh mi ly b">hardhat-deploy</code>版本。部署将按字母数字顺序运行，因此命名惯例至关重要，为此我们在<code class="eh mg mh mi ly b">.js</code>文件的开头使用编号。</p><p id="084f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">注意:</strong>由于最初我们没有在测试或实际网络上部署智能合约，我们应该注释<code class="eh mg mh mi ly b">verify</code>行。</p><p id="6747" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">运行测试</strong></p><p id="f12c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用生成的<code class="eh mg mh mi ly b">Lock.sol</code>合同，并在<code class="eh mg mh mi ly b">test</code>文件夹中生成测试单元。我们现在可以运行:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="ff52" class="lj kh ht ly b fv mc md l me mf">npx hardhat test</span></pre><p id="9a4b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">并且结果还应该包括<strong class="is hu">气体报告:</strong></p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div role="button" tabindex="0" class="jw jx di jy bf jz"><div class="fe ff nb"><img src="../Images/3defe96a5e4d134c9579eabd02c30909.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*su4MlNry-nUsoIAO82OcSw.png"/></div></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Test result with Gas Report</figcaption></figure><p id="61ca" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">检查测试覆盖率</strong></p><p id="12ff" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">检查测试覆盖范围以确保单元测试覆盖所有智能合约功能:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="9765" class="lj kh ht ly b fv mc md l me mf">npx hardhat coverage</span></pre><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff nc"><img src="../Images/cdc154064b04184605fc68264de8829e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*5N2pPM_FG3yzx2RFhoqNMg.png"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Coverage output</figcaption></figure><p id="6e2b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">运行部署</strong></p><p id="e7c8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在您可以使用以下命令运行<code class="eh mg mh mi ly b">deploy</code>脚本:</p><pre class="jr js jt ju fq lx ly lz ma aw mb dt"><span id="c932" class="lj kh ht ly b fv mc md l me mf">npx hardhat deploy</span></pre><p id="6a40" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">部署应该运行，输出如下(基于您的<code class="eh mg mh mi ly b">deploy</code>脚本)</p><figure class="jr js jt ju fq jv fe ff paragraph-image"><div class="fe ff nd"><img src="../Images/4cae28d6974253697b1be7dee718ee03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*L1QbKCRmr2hpv3u3mh-60w.png"/></div><figcaption class="kc kd fg fe ff ke kf bd b be z ek">Deploy Output</figcaption></figure><h1 id="2306" class="kg kh ht bd ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld dt translated">后续步骤</h1><p id="77a2" class="pw-post-body-paragraph iq ir ht is b it le iv iw ix lf iz ja jb lg jd je jf lh jh ji jj li jl jm jn hm dt translated">恭喜你！现在，您可以专注于编写您的智能合同和测试单元，并使用<a class="ae jp" href="https://hardhat.org/" rel="noopener ugc nofollow" target="_blank"> Hardhat </a>遵循开发、测试和部署的周期。从这里，你可以提高你对发展的可靠性的认识。<a class="ae jp" href="https://www.chaijs.com/" rel="noopener ugc nofollow" target="_blank">柴</a>和<a class="ae jp" href="https://mochajs.org/" rel="noopener ugc nofollow" target="_blank">摩卡</a>测试你的智能合约。</p><p id="0c2f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你可以在这个<a class="ae jp" href="https://github.com/said017/hardhat-kit" rel="noopener ugc nofollow" target="_blank"> <strong class="is hu"> github repo </strong> </a>里查看完整的项目代码。</p><blockquote class="ne"><p id="7626" class="nf ng ht bd nh ni nj nk nl nm nn jn ek translated">交易新手？尝试<a class="ae jp" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae jp" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>