<html>
<head>
<title>What the heck is Replay Protection?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">重播保护到底是什么？</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/what-the-heck-is-replay-protection-aae910f2a3cb?source=collection_archive---------5-----------------------#2022-09-20">https://medium.com/coinmonks/what-the-heck-is-replay-protection-aae910f2a3cb?source=collection_archive---------5-----------------------#2022-09-20</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/69cc4729bd70195585fa162ecc80eda4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lvVDsD9Zm7eNoqPvlkIMmw.png"/></div></div></figure><p id="645e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">合并</strong>！它终于发生了。</p><p id="40b0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><a class="ae jz" href="https://etherscan.io/block/15537394" rel="noopener ugc nofollow" target="_blank"> <strong class="jd hu"> 15537394 </strong> </a>是以太坊上第一个使用利益一致证明机制验证的区块。</p><p id="d14b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">向PoS的迁移非常成功，然而，这并不是没有争议的，因为一些偏好PoW的矿工决定分叉链并继续使用PoW共识机制。</p><p id="b0fd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这意味着我们在合并点有一个硬分叉和一个链分裂。</p><p id="aecd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">每当这样的链分裂发生时，其他的例子是ETH &amp; ETC分裂，BTC &amp; BCH我们开始听到“<strong class="jd hu">重放保护</strong>”这样的话。</p><p id="50fe" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在本文中，我们深入探讨重放攻击，以及防范此类攻击的重要性。</p><h1 id="313d" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">什么是重放攻击？</h1><p id="ca23" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">单链中的重放攻击是一种简单的攻击，攻击者可以复制您的有效事务并将其再次发送到网络。导致你的资金被借记两次。</p><p id="8bec" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">想象一下这个场景。</strong></p><p id="25b6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ld"> 0xBob </em>想要发送<strong class="jd hu"> 10个令牌</strong>给<em class="ld"> 0xEvil </em>。交易时，<em class="ld"> 0xBob </em>的账户下有20个代币。</p><p id="6da1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ld"> 0xBob </em>向<em class="ld"> 0xEvil </em>创建10个代币的交易，签署该交易，并将其发送到网络。</p><p id="38fc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ld"> 0xEvil </em>收到10个代币，但他是邪恶的，他接受相同的交易并再次将其发送到网络，现在如果链没有处理重放保护，由于<em class="ld"> 0xBob </em>的帐户中仍有10个代币，重放的交易将继续，并且<em class="ld"> 0xBob </em>将丢失另外10个代币。</p><p id="7ee8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">一般来说，所有的链都通过添加一个序列号<strong class="jd hu"> nonce </strong>以及处理<strong class="jd hu">重复事务散列</strong>来处理这些类型的情况(没有两个事务可以有相同的散列)。添加了这两样东西后，<em class="ld"> 0xEvil </em>的重放事务将会失败，因为…</p><ul class=""><li id="fe3a" class="le lf ht jd b je jf ji jj jm lg jq lh ju li jy lj lk ll lm dt translated">无效/重复的随机数。</li><li id="a1e1" class="le lf ht jd b je ln ji lo jm lp jq lq ju lr jy lj lk ll lm dt translated">重复的事务哈希。</li></ul><h1 id="9da9" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">交叉链重放攻击</h1><p id="100a" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">这是事情开始变得有点有趣的地方。当出现硬分叉时，链条会一分为二。</p><p id="018c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里，整个状态按原样从原始链复制到分叉链。他们有一个共同的历史，直到分叉点。</p><p id="f9b2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这意味着如果<em class="ld"> 0xBob </em>在原始链上有20个令牌，他在分叉链上也将有20个令牌。很好，不是吗？</p><p id="a2f8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，如果分叉链没有添加必要的解决方案(稍后我们将讨论该解决方案是什么)，两个链都将暴露于重放攻击。</p><p id="6120" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这就是分叉链中重放攻击的工作方式，准备好了吗？</p><p id="19ad" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">继续我们之前的例子。现在，<em class="ld"> 0xBob </em>在<strong class="jd hu"> C1 </strong>(原链)上有<strong class="jd hu"> 20个代币</strong>，在<strong class="jd hu"> C2 </strong>(叉链)上有<strong class="jd hu"> 20个代币</strong>。</p><p id="9ce1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ld"> 0xBob </em>决定在<strong class="jd hu"> C2 </strong>上发送<strong class="jd hu"> 20个令牌</strong>给<em class="ld"> 0xEvil </em>。<em class="ld"> 0xBob </em>签署交易并将其发送到<strong class="jd hu"> C2 </strong>网络。</p><p id="c06a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在，<em class="ld"> 0xEvil </em> being evil将复制该已签名交易的内容，并提交给原始链<strong class="jd hu"> C1 </strong>。这个从C2到C1的复制交易将完全有效，它将把<em class="ld"> 0xBob </em>在C1网络上的20个令牌转移到<em class="ld"> 0xEvil </em>。</p><figure class="lt lu lv lw fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ls"><img src="../Images/6680e78ccf5aeea070729893725b349c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uWPRU38KSmk1t6EbXFdgMQ.png"/></div></div><figcaption class="lx ly fg fe ff lz ma bd b be z ek">Cross Chain Replay Attack</figcaption></figure><p id="6646" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这就是交易有效的原因。</p><p id="7a5a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们假设在链分裂时，<em class="ld"> 0xBob </em>的随机数为0。当<em class="ld"> 0xBob </em>在<strong class="jd hu"> C2 </strong>上进行原始交易时，随机数增加到1。然而，<strong class="jd hu"> C1(原始链)</strong>上<em class="ld"> 0xBob </em>的nonce仍然在<strong class="jd hu"> 0 </strong>。因此，nonce为0<strong class="jd hu">的交易将在那里被接受。</strong></p><p id="342f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">除此之外，复制的事务的散列在C1上也是唯一的，因为原始事务是在C2链上提交的。</p><h1 id="ef19" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">如何防范跨链重放攻击？</h1><p id="ce5b" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">现在我们已经了解了重放攻击是如何工作的，让我们看看如何添加重放保护来防御硬分叉后的跨链重放攻击。</p><p id="1489" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这些类型的攻击可以通过以对每个分叉链都是唯一的方式修改交易数据来防止。这可能只是在签名和提交事务之前添加到事务构造中的随机位(随机信息)。</p><p id="ed9e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">通常，这是通过两种方式完成的，第一种是<strong class="jd hu">强重放保护</strong>，其中一个分叉链将强制更改事务中的一些信息，以使其在网络上有效。</p><p id="1c70" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">第二种方式是<strong class="jd hu">选择加入回复保护</strong>，用户必须对事务进行手动更改，以确保它们不会被重放。</p><p id="dc8b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">添加这条附加信息会使事务数据、签名和散列在另一条链上无效。</p><h1 id="6e7a" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">结论</h1><p id="4cf6" class="pw-post-body-paragraph jb jc ht jd b je ky jg jh ji kz jk jl jm la jo jp jq lb js jt ju lc jw jx jy hm dt translated">重放攻击通常在链经历硬分叉时开始发挥作用，因此当这样的事件即将发生时，我们开始听到更多关于它们的消息。</p><p id="ece5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在ETH和ETH classic之间的第一次以太坊分裂中，这成为一个问题，因为ETH Classic没有内置重放保护。然而，ETH社区通过引入一个名为<strong class="jd hu"> ChainID </strong>的字段解决了这一问题，该字段对每个EVM连锁店都是唯一的。</p><p id="2fc8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ETHW社区已经决定使用ChainID <strong class="jd hu"> 10001 </strong>。从而自动保护链免受重放攻击。</p><p id="cab4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ld">大家好，我是</em> <a class="mb mc gr" href="https://medium.com/u/42b12d9f05b0?source=post_page-----aae910f2a3cb--------------------------------" rel="noopener" target="_blank"> <em class="ld">拉希尔·谢赫</em> </a> <em class="ld">，一名计算机工程师，一名比特币的学生。如果你喜欢这篇文章，请给我一个关注</em><a class="ae jz" href="https://twitter.com/rahil471" rel="noopener ugc nofollow" target="_blank"><em class="ld">rahil 471</em></a><em class="ld">。</em></p><blockquote class="md"><p id="adcc" class="me mf ht bd mg mh mi mj mk ml mm jy ek translated">交易新手？尝试<a class="ae jz" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae jz" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>