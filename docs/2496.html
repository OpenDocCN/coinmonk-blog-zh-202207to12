<html>
<head>
<title>Ethernaut-Telephone Who is there?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谁在那里？</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethernaut-telephone-who-are-there-a2a24c65a129?source=collection_archive---------39-----------------------#2022-08-20">https://medium.com/coinmonks/ethernaut-telephone-who-are-there-a2a24c65a129?source=collection_archive---------39-----------------------#2022-08-20</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="41b3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我在<a class="ae jo" rel="noopener" href="/@eszymi/ethernaut-fallback-thus-lets-talk-about-receiving-of-ether-in-smart-contract-5d9f67c53c7b">之前的帖子</a>中写道，每一个智能合同和每一个想要与区块链交流的人都有自己唯一的地址。</p><p id="125b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们可以像在现实世界中思考我们的名字一样思考它(当然让我们想象只有一个人的名字是鲍勃、爱丽丝等等)。所以，当我们想要从鲍勃那里得到什么东西时，我们说‘鲍勃，你能给我吗？’或者“鲍勃，你能不能…？”。当鲍勃割草时，我们说“鲍勃割草”。区块链也是如此。我们可以说0x123...A4你能调用函数xyz()？'或者“合同0x123…A4给我发回一份乙醚”。酷毙了。</p><p id="c097" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">但是在现实生活中，有时我们不得不要求某人要求其他人来做，就像“鲍勃，你能要求爱丽丝割草吗？”。如此相似，我们可以问‘0x 123…A4，你能让0x45B…42调用函数XYZ()？’。看起来一样，不是吗？</p><h1 id="5238" class="jp jq ht bd jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km dt translated">特殊变量和函数</h1><p id="e3e8" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hm dt translated">在很多情况下，如果我们能知道谁想制造某样东西，或者谁是第一个要求得到某样东西的人，那就太好了。幸运的是，坚固性给了我们获取这些信息的工具。我来介绍一下特殊的全局变量和函数。它们主要用于提供有关区块链的信息，或者是通用的实用函数。现在让我重点介绍其中的两个:msg.sender和tx.origin。</p><p id="77fd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">msg.sender包含需要某些东西的对象的地址。tx.origin包含第一个请求的对象的地址。为了更好地理解这种差异，让我们看一下图表。</p><figure class="kt ku kv kw fq kx fe ff paragraph-image"><div class="fe ff ks"><img src="../Images/34d3796a6e7688d25175e0b1e514e9c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*eoNJQiBa1ht4-Db99p1tpA.png"/></div><figcaption class="la lb fg fe ff lc ld bd b be z ek">Example of call chain invoked by someone with address 0x123…AB</figcaption></figure><p id="0b0b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们怎么看，有个0x123…AB地址的人在不同契约之间启动了一个函数调用链。查看每个契约中msg.sender和tx.origin的值，我们注意到tx.origin仍然是相同的，并且包含第一个的地址。msg.sender的情况不同。它包含以前合同的地址。</p><p id="a674" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这里是说一些重要事情的好地方。当你写你自己的智能合同时，不要使用tx.origin。它是黑客攻击你的合同的场所。怎么会？想象一下，只有你可以使用一些函数，并且为了确定你使用了函数<br/><em class="le">require(tx . origin = = your address，"你不能使用这个函数")<br/> </em>太好了，但是现在想象一下，有人让你将交易发送到他的合同，该合同与你的合同相关联。因为tx.origin包含您的地址，所以这个恶意契约可以使用您的函数。</p><h2 id="750d" class="lf jq ht bd jr lg lh li jv lj lk ll jz jb lm ln kd jf lo lp kh jj lq lr kl ls dt translated">其他特殊变量和函数</h2><p id="411b" class="pw-post-body-paragraph iq ir ht is b it kn iv iw ix ko iz ja jb kp jd je jf kq jh ji jj kr jl jm jn hm dt translated">msg.sender和tx.origin不仅仅是始终存在于全局名称空间中的特殊变量和函数。另一个是:</p><ul class=""><li id="81fa" class="lt lu ht is b it iu ix iy jb lv jf lw jj lx jn ly lz ma mb dt translated"><code class="eh mc md me mf b">blockhash(uint blockNumber) returns (bytes32)</code>:当<code class="eh mc md me mf b">blocknumber</code>是256个最近的块之一时，给定块的散列；否则返回零</li><li id="7f12" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">block.basefee</code> ( <code class="eh mc md me mf b">uint</code>):当前区块的基础费用(<a class="ae jo" href="https://eips.ethereum.org/EIPS/eip-3198" rel="noopener ugc nofollow" target="_blank"> EIP-3198 </a> <strong class="is hu">和</strong> <a class="ae jo" href="https://eips.ethereum.org/EIPS/eip-1559" rel="noopener ugc nofollow" target="_blank"> EIP-1559 </a>)。它是指包含该区块交易所需的最小<a class="ae jo" href="https://www.coindesk.com/learn/what-are-ethereum-gas-fees/" rel="noopener ugc nofollow" target="_blank"> gas </a>量。</li><li id="aa08" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">block.chainid</code> ( <code class="eh mc md me mf b">uint</code>):当前链id。每个区块链都有不同的id。它就像区块链的一个名字。例如，以太坊主网的id是1，多边形主网的id是137，以太坊经典主网的id是61。</li><li id="bf76" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">block.coinbase</code> ( <code class="eh mc md me mf b">address payable</code>):当前闭塞矿工的地址</li><li id="f4dc" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">block.difficulty</code> ( <code class="eh mc md me mf b">uint</code>):当前块<a class="ae jo" href="https://www.investopedia.com/terms/d/difficulty-cryptocurrencies.asp" rel="noopener ugc nofollow" target="_blank">难度</a></li><li id="0223" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">block.gaslimit</code> ( <code class="eh mc md me mf b">uint</code>):当前块<a class="ae jo" href="https://www.blocknative.com/blog/ethereum-transaction-gas-limit" rel="noopener ugc nofollow" target="_blank">气体极限</a></li><li id="1b51" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">block.number</code> ( <code class="eh mc md me mf b">uint</code>):当前块号</li><li id="67e0" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">block.timestamp</code> ( <code class="eh mc md me mf b">uint</code>):当前块时间戳，自<a class="ae jo" href="https://en.wikipedia.org/wiki/Unix_time" rel="noopener ugc nofollow" target="_blank"> unix纪元</a>以来的秒数</li><li id="5216" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">gasleft() returns (uint256)</code>:剩余气体</li><li id="ddc9" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">msg.data</code> ( <code class="eh mc md me mf b">bytes calldata</code>):完整的调用数据。它包含我们与交易一起发送的信息。</li><li id="0bc8" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">msg.sig</code>(<code class="eh mc md me mf b">bytes4</code>):call data的前四个字节(即函数标识符)</li><li id="80ec" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">msg.value</code> ( <code class="eh mc md me mf b">uint</code>):随消息发送的<a class="ae jo" href="https://www.investopedia.com/terms/w/wei.asp" rel="noopener ugc nofollow" target="_blank">魏</a>号</li><li id="4289" class="lt lu ht is b it mg ix mh jb mi jf mj jj mk jn ly lz ma mb dt translated"><code class="eh mc md me mf b">tx.gasprice</code> ( <code class="eh mc md me mf b">uint</code>):交易的气价</li></ul><p id="625d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个列表来自于<a class="ae jo" href="https://docs.soliditylang.org/en/develop/units-and-global-variables.html?highlight=special%20variables%20and%20functions#special-variables-and-functions" rel="noopener ugc nofollow" target="_blank">固化</a>的文档。括号中是返回值的类型。</p></div><div class="ab cl ml mm hb mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="hm hn ho hp hq"><p id="613e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我希望这篇文章对你有用。如果你有任何想法，我如何能使我的帖子更好，请告诉我。我随时准备学习。你可以在<a class="ae jo" href="https://pl.linkedin.com/in/szymon-skrzy%C5%84ski-881462214" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae jo" href="https://t.me/eszymi" rel="noopener ugc nofollow" target="_blank"> Telegram </a>上和我联系。</p><p id="0b39" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你想和我谈论这个话题或者我写的其他话题，请随意。我乐于交谈。</p><p id="f9fe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">快乐学习！</p><blockquote class="ms"><p id="c369" class="mt mu ht bd mv mw mx my mz na nb jn ek translated">交易新手？尝试<a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae jo" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>