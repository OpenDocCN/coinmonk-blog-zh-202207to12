<html>
<head>
<title>Zero-to-Hero Full-Stack DApp Development in 10 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">10分钟内完成从零到英雄的全栈DApp开发</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/zero-to-hero-full-stack-dapp-development-in-10-minutes-8e42d58b7d91?source=collection_archive---------3-----------------------#2022-07-09">https://medium.com/coinmonks/zero-to-hero-full-stack-dapp-development-in-10-minutes-8e42d58b7d91?source=collection_archive---------3-----------------------#2022-07-09</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/81bac4f8d39ab8c104ccce3a329d929e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pKQh_85YsizFu1D99VaVKw.png"/></div></div></figure><h1 id="cfc8" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">欢迎光临！</h1><p id="fea2" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">本指南旨在为您提供2022年开始开发全栈以太坊(EVM)分散式应用(dApps)所需的工具和现代技术的全面覆盖。无论是你的第一次，还是你想重温现代DApp堆栈，这个指南是给你的！</p><p id="3f16" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">我们将使用以下新框架和技术启动dApp堆栈:</p><ul class=""><li id="4669" class="lc ld ht kb b kc kx kg ky kk le ko lf ks lg kw lh li lj lk dt translated"><strong class="kb hu"> React NextJS </strong> —负责我们的前端开发和部署</li><li id="5202" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated"><strong class="kb hu">打字稿</strong> —用于打字安全和清洁代码；)</li><li id="4fc2" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated"><strong class="kb hu">安全帽</strong> —用于我们的智能合同开发、测试和部署</li><li id="b6b4" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated">ChakraUI  —作为我们的UI组件库(尽管你可以很容易地把它换成你喜欢的库！)</li></ul><h2 id="094a" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">你需要知道的是</h2><p id="7d58" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">我们将尝试涵盖本指南中的所有内容，但是，有一些先验知识会让您的生活更轻松:</p><ul class=""><li id="5baf" class="lc ld ht kb b kc kx kg ky kk le ko lf ks lg kw lh li lj lk dt translated">React是大多数dApp前端的核心，你应该对React开发的基础有所了解。</li><li id="1ba5" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated"><strong class="kb hu">节点</strong> —本指南要求熟悉并安装节点。我们正在使用<code class="eh me mf mg mh b">v16.15.x</code>，然而其他版本<em class="mi">应该</em>也可以。</li><li id="96a9" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated"><strong class="kb hu">对DApp的基本了解</strong>——熟悉DApps或之前使用过DApps将对你的理解有很大帮助。我们还将假设您已经安装了<a class="ae mj" href="https://metamask.io/" rel="noopener ugc nofollow" target="_blank">元掩码</a>，并且对它有一个基本的了解！</li></ul><h2 id="dfbb" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">我们将涵盖的内容:</h2><p id="442f" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">— 1.<a class="ae mj" href="#202d" rel="noopener ugc nofollow">我们在建设什么</a> <br/> — 2。<a class="ae mj" href="#5df5" rel="noopener ugc nofollow">设置我们的项目</a> <br/> — 3。<a class="ae mj" href="#2a83" rel="noopener ugc nofollow">模板概述</a> <br/> — 4。<a class="ae mj" href="#8ce0" rel="noopener ugc nofollow">运行模板</a> <br/> — 5。<a class="ae mj" href="#e2b9" rel="noopener ugc nofollow">实现我们自己的反DApp </a> <br/> — 6。<a class="ae mj" href="#5f5d" rel="noopener ugc nofollow">将其部署到全球</a></p></div><div class="ab cl mk ml hb mm" role="separator"><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp mq"/><span class="mn bw bk mo mp"/></div><div class="hm hn ho hp hq"><h1 id="202d" class="jb jc ht bd jd je mr jg jh ji ms jk jl jm mt jo jp jq mu js jt ju mv jw jx jy dt translated">1.我们正在建造的东西</h1><p id="9f69" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">我们将为一个简单的计数器应用程序构建智能合约、前端和区块链交互逻辑。尽管是一个简单的dApp，你将学到的技能可以很容易地应用到使用相同技术的大型项目中。</p><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/1c0a594025dc2bb220efd0c7953a898c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LC_nbYitsOBdmbsy085_Ng.gif"/></div></div></figure><p id="dced" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">为了做到这一点，我们将制定一个dApp模板，其中包含所有可供我们使用的核心技术。这个模板足够灵活，我们可以根据它构建任何我们想要的dApp。</p><div class="nb nc fm fo nd ne"><a href="https://github.com/gmulhearn/dapp-stack-template" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab ej"><div class="ng ab nh cl cj ni"><h2 class="bd hu fv z el nj eo ep nk er et hs dt translated">GitHub-gmulhearn/dapp-stack-template:hard hat next js React Chakra-UI在Typescript模板中！</h2><div class="nl l"><h3 class="bd b fv z el nj eo ep nk er et ek translated">以下项目旨在使基于EVM的分散式web应用程序的引导变得像…</h3></div><div class="nm l"><p class="bd b gc z el nj eo ep nk er et ek translated">github.com</p></div></div><div class="nn l"><div class="no l np nq nr nn ns iz ne"/></div></div></a></div><h1 id="5df5" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">2.设置我们的项目</h1><h2 id="b677" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">装置</h2><p id="b756" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">让我们从首先拉下模板项目并在VS代码(或者您选择的IDE)中打开它开始。</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="a73d" class="lq jc ht mh b fv nx ny l nz oa">git clone <a class="ae mj" href="https://github.com/gmulhearn/dapp-stack-template.git" rel="noopener ugc nofollow" target="_blank">https://github.com/gmulhearn/dapp-stack-template.git</a> counter-dapp &amp;&amp; cd counter-dapp</span></pre><p id="8369" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">接下来，我们需要为hardhat项目和NextJS/前端项目安装包依赖项:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="f9e1" class="lq jc ht mh b fv nx ny l nz oa">cd hardhat &amp;&amp; npm install &amp;&amp; cd ..<br/>cd nextjs &amp;&amp; npm install &amp;&amp; cd ..</span></pre><p id="bba9" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">现在安装我们的智能合同开发环境hardhat:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="24ff" class="lq jc ht mh b fv nx ny l nz oa">npm install -g hardhat-shorthand </span></pre><h2 id="b0c1" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">配置</h2><p id="f8af" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">我们需要给hardhat一个基于以太坊的钱包，通过输入一个秘密的助记符种子短语到<code class="eh me mf mg mh b">hardhat</code>目录下的<code class="eh me mf mg mh b">.env</code>文件中来使用。首先，我们需要为开发生成一个种子短语。这可以使用已经安装在我们的hardhat项目中的bip39来完成:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="b4c6" class="lq jc ht mh b fv nx ny l nz oa">node -e 'console.log(require("bip39").generateMnemonic())'</span></pre><p id="9010" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">由此输出的12-24个单词是您的种子短语，将用于打开您的部署以太坊钱包。如果您在生产部署中使用这个种子短语，那么对这个短语保密是非常重要的！</p><p id="0d49" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">使用这个短语，在项目的<code class="eh me mf mg mh b">hardhat</code>目录中创建一个<code class="eh me mf mg mh b">.env</code>文件(<code class="eh me mf mg mh b">touch .env</code>，并将其填写如下:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="d57e" class="lq jc ht mh b fv nx ny l nz oa">MNEMONIC="&lt;insert your 12-24 word mnemonic seed phrase&gt;"</span></pre><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/928b807c247d66516e61c2830239d899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zBNLRwwfbyatCeLJ8xUSbg.gif"/></div></div><figcaption class="ob oc fg fe ff od oe bd b be z ek">Note — file structure in the left explorer may not be up-to-date.</figcaption></figure><p id="001a" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">完成所有设置后，让我们从里到外了解一下这个模板。</p><h1 id="2a83" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">3.模板概述</h1><p id="0b5f" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">项目根目录下的<a class="ae mj" href="https://github.com/gmulhearn/dapp-stack-template/blob/main/README.md" rel="noopener ugc nofollow" target="_blank"> README.md </a>详细描述了该项目及其设置，不过，让我们一起来过一遍。</p><h2 id="fa8b" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">后端/安全帽开发环境</h2><p id="5d2c" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">从项目的<code class="eh me mf mg mh b">hardhat</code>目录中，您会看到以下目录:</p><ul class=""><li id="2577" class="lc ld ht kb b kc kx kg ky kk le ko lf ks lg kw lh li lj lk dt translated"><code class="eh me mf mg mh b">contracts</code> —包含项目的所有智能合约的目录。目前，只有一个默认合同:<code class="eh me mf mg mh b">Greeter.sol</code>。</li><li id="7077" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated"><code class="eh me mf mg mh b">scripts</code> —您的hardhat客户端将使用的脚本。目前，主脚本是<code class="eh me mf mg mh b">deploy.ts</code>，它包含hardhat将您的智能合约部署到您选择的网络的指令。</li><li id="2956" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated"><code class="eh me mf mg mh b">test</code> —运行hardhat的集成测试，确保您的合同有效。</li><li id="2ce7" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated"><code class="eh me mf mg mh b">hardhat.config.ts</code> —针对您的hardhat客户端的配置。在本指南中，我们不会过多地涉及这一点，但是，您可以使用它来添加新的部署链(我们将在后面涉及这一点)等等。</li></ul><h2 id="8aab" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">前端</h2><p id="70e2" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">在<code class="eh me mf mg mh b">nextjs</code>目录中是你所有的前端代码。在很大程度上，这是一个非常典型的NextJS项目结构，但是，为了便于开发，还需要一些特殊的部分。</p><p id="5e81" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">很多前端依赖于根<code class="eh me mf mg mh b">artifacts</code>目录中的数据。该目录中将包含以下内容:</p><ul class=""><li id="f3af" class="lc ld ht kb b kc kx kg ky kk le ko lf ks lg kw lh li lj lk dt translated"><code class="eh me mf mg mh b">hardhat</code> —由<code class="eh me mf mg mh b">deploy.ts</code>脚本自动填充的目录。该目录包含智能合同ABI，我们的前端使用这些ABI来连接到我们的智能合同并与之交互。</li><li id="44ac" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated"><code class="eh me mf mg mh b">contractDeployments.json</code> —一个文件，包含关于项目合同的信息以及每个链的部署地址。目前，这个文件只有默认的<code class="eh me mf mg mh b">Greeter</code>合同部署信息。我们的hardhat deploy脚本将在每次部署后用更新的地址填充这个JSON，这样我们就不必担心手动硬编码任何地址。</li><li id="54d7" class="lc ld ht kb b kc ll kg lm kk ln ko lo ks lp kw lh li lj lk dt translated"><code class="eh me mf mg mh b">typechain</code> —由hardhat在每次编译时创建的自动生成的目录，其中包含您的类型脚本代码可以使用的类和类型，以干净和类型化的方式轻松地与您部署的契约进行交互。</li></ul><p id="88a9" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">在NextJS项目本身中，这个模板的一个关键部分是<code class="eh me mf mg mh b">core/ethereum/ethereum.ts</code>中的<code class="eh me mf mg mh b">useDappStatus</code>钩子。这是一个钩子，当你在应用程序中添加更多的契约时，你可以使用和扩展它。该挂钩用于整个前端，以提供一种与智能合约和用户的以太坊钱包客户端(MetaMask或WalletConnect)进行交互的简单方法。</p><h1 id="8ce0" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">4.运行模板</h1><p id="f1a9" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">在我们开始实现我们自己的计数器dApp之前，让我们部署并运行这个模板的默认“欢迎”dApp。</p><p id="21b9" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">首先，让我们打开3个独立的终端。在您的第一个终端中，我们将建立hardhat的本地连锁店，这是一个专为您的本地发展而设的私人连锁店:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="dd2e" class="lq jc ht mh b fv nx ny l nz oa">cd hardhat<br/>hh node</span></pre><p id="2616" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">让它保持运行，在您的第二个终端中，让我们部署默认的欢迎契约:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="2d50" class="lq jc ht mh b fv nx ny l nz oa">cd hardhat<br/>hh run --network localhost scripts/deploy.ts</span></pre><p id="88b4" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">让这个终端晚点开着。最后，在您的第三个终端中，让我们启动NextJS开发服务器:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="74ee" class="lq jc ht mh b fv nx ny l nz oa">cd nextjs<br/>npm run dev</span></pre><p id="ced8" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">您的3个终端现在应该看起来像这样:</p><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff of"><img src="../Images/bbd0eb36d4698c1224ec73c15c30356c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LEerFiaAgmFqj215fXCzZQ.png"/></div></div><figcaption class="ob oc fg fe ff od oe bd b be z ek">Our 3 local development terminals</figcaption></figure><p id="6bd1" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">让我们在您的浏览器中查看dApp的测试环境:</p><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/83b2dc31c9d43342623b602fdb182210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f7x7tXAmBhb3pfGYEE63wg.png"/></div></div><figcaption class="ob oc fg fe ff od oe bd b be z ek">Your locally deployed Greeter dApp</figcaption></figure><p id="9327" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">不算太寒酸！您可以通过点击“获取问候”来测试合同读取请求，但在我们将钱包连接到dApp之前，我们将无法执行任何写入请求。最简单的方法是通过“连接”按钮连接到MetaMask。由于我们的dApp目前被配置为在开发过程中在本地主机链上运行，所以在右上角会提示您切换链并将本地主机链添加到元掩码中。</p><p id="d66c" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">但是，您会注意到您的MetaMask帐户在这个测试链上没有余额，您需要将一个帐户从您的本地hardhat wallet导入MetaMask。为此，您可以运行以下命令来获取项目的hardhat wallet的私钥:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="15d0" class="lq jc ht mh b fv nx ny l nz oa">cd hardhat<br/>node util/bip39tools.js</span></pre><p id="b948" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">复制这个私钥并将其导入元掩码，如下所示:</p><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/5415b4afefa8d5a48b53042760fcb40e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*vCCyAH3E6q-5ouvIJJ-V5A.gif"/></div></div><figcaption class="ob oc fg fe ff od oe bd b be z ek">Import your hardhat project wallet’s private key into MetaMask</figcaption></figure><p id="1162" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">现在断开当前钱包的连接，并重新连接新导入的钱包。让我们试试dApp:</p><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/40971311fcf0d561182414ccdcdeb022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LqLwuoLV3WHavCWS2v3kxg.gif"/></div></div></figure><p id="1097" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">很简单，现在让我们添加我们自己的计数器dApp。</p><h1 id="e2b9" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">5.实施我们自己的反dApp</h1><h2 id="df04" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">智能合同</h2><p id="e096" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">让我们从制定新的智能合同开始。</p><p id="c9f4" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">在您的<code class="eh me mf mg mh b">hardhat/contracts</code>目录中，用以下内容创建一个新的<code class="eh me mf mg mh b">Counter.sol</code>文件:</p><figure class="mx my mz na fq iu"><div class="bz el l di"><div class="og oh l"/></div></figure><p id="aa39" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">这个契约相当简单，因为我们只需要管理一个无符号整数(<code class="eh me mf mg mh b">uint256</code>)状态:<code class="eh me mf mg mh b">count</code>。此计数是私有的，表示计数器的合同当前状态。</p><p id="ed73" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">我们有一个公共只读(用'<code class="eh me mf mg mh b">public view</code>')函数— <code class="eh me mf mg mh b">getCount()</code>，它只是返回<code class="eh me mf mg mh b">count</code>。最后，我们有一个公共写函数<code class="eh me mf mg mh b">increment()</code>，它将<code class="eh me mf mg mh b">count</code>状态递增1。</p><h2 id="2ff0" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">测试它</h2><p id="a3ee" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">我们可以通过在<code class="eh me mf mg mh b">test</code>目录中创建新的测试来测试我们的契约的功能。让我们在<code class="eh me mf mg mh b">test</code>目录下新建一个<code class="eh me mf mg mh b">counter.test.ts</code>文件，并赋予其以下内容:</p><figure class="mx my mz na fq iu"><div class="bz el l di"><div class="og oh l"/></div></figure><p id="68dd" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">该测试将<code class="eh me mf mg mh b">Counter</code>契约部署到本地测试环境，并对计数器的初始状态以及<code class="eh me mf mg mh b">increment</code>之后的状态进行多次检查。Chai用于对期望值进行断言，如果断言不正确，测试将失败。</p><p id="ffcb" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">然后我们可以使用<code class="eh me mf mg mh b">hardhat</code>目录中的<code class="eh me mf mg mh b">hh test</code>来运行这个测试。</p><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/d22f983995866406c60a233b42815e08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*dAmaHXGCxg6SMkpMkB25-A.gif"/></div></div></figure><h2 id="4ba7" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">部署合同</h2><p id="7a39" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">现在，让我们更新我们的<code class="eh me mf mg mh b">hardhat/scripts/deploy.ts</code>脚本来部署我们的计数器。在很大程度上，这只是用新的柜台类型替换现有的迎宾合同:</p><figure class="mx my mz na fq iu"><div class="bz el l di"><div class="og oh l"/></div></figure><p id="5ee7" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">注意<code class="eh me mf mg mh b">updateDeployedContractData</code>负责用新的合同地址更新我们前端的<code class="eh me mf mg mh b">contractDeployments.json</code>文件。</p><p id="65a4" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">现在，让我们重新运行这个脚本来部署新的计数器契约:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="f11d" class="lq jc ht mh b fv nx ny l nz oa">cd hardhat<br/>hh run --network localhost scripts/deploy.ts</span></pre><h2 id="94f3" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">集成前端</h2><p id="b124" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">为了将与这个已部署契约的交互集成到前端，我们将更新我们之前提到的<code class="eh me mf mg mh b">useDappStatus</code>钩子。为此，请进入<code class="eh me mf mg mh b">nextjs/core/ethereum/dappAPIs.ts</code>，我们可以将之前的迎宾员合同换成柜台合同。</p><p id="1648" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">首先，让我们为DappAPIs替换Greeter导入和接口，然后我们可以更新我们的<code class="eh me mf mg mh b">getDappAPI</code>函数内部以使用新的<code class="eh me mf mg mh b">GreeterContract</code>。总的来说，这些更新如下所示:</p><figure class="mx my mz na fq iu"><div class="bz el l di"><div class="og oh l"/></div></figure><p id="b72e" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">我们的<code class="eh me mf mg mh b">useDappStatus</code>钩子现在将返回这个新版本的<code class="eh me mf mg mh b">DappAPIs</code>，带有一个到我们新的<code class="eh me mf mg mh b">counter</code>契约的接口！现在，让我们在前端测试环境中利用这个新接口。</p><h2 id="a235" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">更新前端</h2><p id="7454" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">现在前往测试页面tsx: <code class="eh me mf mg mh b">nextjs/pages/playground/index.tsx</code>。</p><p id="85fa" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">借助新的DApp API，我们将可以访问我们的2个智能合约功能。可以在测试页面中访问它们:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="be0c" class="lq jc ht mh b fv nx ny l nz oa">const { dappAPI } = useDappStatus()<br/>dappAPI?.counter.getCount()<br/>dappAPI?.counter.increment()</span></pre><p id="9c97" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">这不是一个React教程，所以我们不会太关注前端，但是使用这些新的API并遵循以前管理欢迎契约的模式，我们可以更新我们的playground页面来替换欢迎状态，并单击处理程序来使用我们的新API。您的新操场代码应该是这样的:</p><figure class="mx my mz na fq iu"><div class="bz el l di"><div class="og oh l"/></div></figure><p id="c37c" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">太好了！现在，让我们看看它是否有效..</p><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/1c0a594025dc2bb220efd0c7953a898c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*LC_nbYitsOBdmbsy085_Ng.gif"/></div></div></figure><p id="28d9" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">干得好！</p><h1 id="5f5d" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">6.将它推广到全世界</h1><p id="6d88" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">所以，我们在本地做得很好，我们如何把它推向世界？</p><p id="33af" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">对于指南的这一部分，我们将集中于部署到Avalanche Fuji testnet，然而，这些步骤可以应用于任何EVM链:<em class="mi">以太坊、Ropsten、Polygon、Harmony、Evmos等。</em></p><h2 id="f426" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">配置</h2><p id="3261" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">模板项目可以通过一些简单的配置在目标链之间快速切换。在<code class="eh me mf mg mh b">nextjs</code>目录下，会存在两个<code class="eh me mf mg mh b">.env</code>文件:<code class="eh me mf mg mh b">.env.development</code>和<code class="eh me mf mg mh b">.env.production</code>。这两个<code class="eh me mf mg mh b">.env</code>文件都包含一个用于<code class="eh me mf mg mh b">NEXT_PUBLIC_CHAIN_ID</code>的条目，它应该被设置为目标EVM的链ID。在开发中，我们目前使用的是<code class="eh me mf mg mh b">31337</code>，它指向我们本地的安全帽链。默认情况下，该模板的生产配置当前设置为使用<code class="eh me mf mg mh b">43113</code>，它指向Avalanche Fuji testnet。</p><p id="910a" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated"><em class="mi">在</em><a class="ae mj" href="https://chainlist.org/" rel="noopener ugc nofollow" target="_blank"><em class="mi">chainlist.org</em></a><em class="mi">上可以找到EVM连锁id的完整列表。</em></p><p id="c8c4" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">接下来，让我们看看如何在前端的<code class="eh me mf mg mh b">nextjs/config/chain.ts</code>文件中配置链。您将看到许多流行的链配置已经被填充到这个文件中(比如Avalanche testnet)。如果您希望向这个列表添加一个新的链，您可以简单地遵循与其他配置相同的模式。如果您不确定目标链配置的细节，可以使用<a class="ae mj" href="https://chainlist.org/" rel="noopener ugc nofollow" target="_blank">chainlist.org</a>来收集必要的字段。</p><p id="d06c" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">最后，我们需要更新我们的<code class="eh me mf mg mh b">hardhat/hardhat.config.ts</code>,以便hardhat知道如何部署到我们的生产链中。已经在<code class="eh me mf mg mh b">config.networks.avaxTest</code>下为Avalanche Fuji testnet链创建了一个配置字段。如果您希望添加另一个链，您可以再次遵循与<code class="eh me mf mg mh b">avaxTest</code>相同的模式，使用来自<a class="ae mj" href="https://chainlist.org/" rel="noopener ugc nofollow" target="_blank">chainlist.org</a>的链信息。</p><h2 id="495f" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">获取令牌并部署</h2><p id="af6f" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">我们将使用同一个安全帽钱包来部署我们的合同到Avalanche testnet，所以我们需要先获得一些令牌。大多数测试网将有一个水龙头，富士的测试网可以在这里找到<a class="ae mj" href="https://faucet.avax.network/" rel="noopener ugc nofollow" target="_blank"/>。只需复制您的hardhat地址，并请求令牌:</p><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/dd2f1e6f48bdc69f260bcb2112fe2eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*qBnwp4tFxizym4L2mf-zPA.gif"/></div></div></figure><p id="c949" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">现在让我们部署！通过运行相同的部署脚本来实现这一点，但是使用我们的<code class="eh me mf mg mh b">hardhat.config.ts</code>文件中的<code class="eh me mf mg mh b">avaxTest</code>目标:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="cfca" class="lq jc ht mh b fv nx ny l nz oa">cd hardhat<br/>hh run --network avaxTest scripts/deploy.ts</span></pre><p id="b6a7" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">就这么简单。</p><h2 id="3953" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">生产前端</h2><p id="f6af" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">现在，由于我们的<code class="eh me mf mg mh b">.env.production</code>指向Avalance testnet，我们的prod NextJS前端将使用其链配置指向我们的avax部署合同。让我们取消旧的开发NextJS应用服务器，启动我们的生产NextJS应用程序，如下所示:</p><pre class="mx my mz na fq nt mh nu nv aw nw dt"><span id="5da6" class="lq jc ht mh b fv nx ny l nz oa">cd nextjs<br/>npm run build<br/>npm start</span></pre><p id="56db" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">现在让我们来看看:</p><figure class="mx my mz na fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mw"><img src="../Images/bd45338be244f3569d22387878fa15ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5tRweaaE7hErjFiXLdlmSw.gif"/></div></div></figure><p id="25f1" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">不错！<em class="mi">有点慢</em>，当然，但那是给你的测试网..请随意尝试不同的链条，找到最适合您需求的一款。</p><h1 id="631d" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">接下来呢？</h1><p id="55a7" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">就这样，你现在是全栈dApp dev了！</p><p id="6901" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">这个模板现在是你的了，把它拆开，带上钩子和组件，在你自己的项目中使用它们。虽然我们没有时间深入研究solidity代码或web3提供商交互，但本指南应该给你足够的基础，让你开始构建自己的dApps并把它们带上月球🚀。</p><h2 id="d593" class="lq jc ht bd jd lr ls lt jh lu lv lw jl kk lx ly jp ko lz ma jt ks mb mc jx md dt translated">有什么问题吗？</h2><p id="1378" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw hm dt translated">我总是在寻找反馈，也总是乐于帮助社区，所以请随时联系我们！</p><p id="bf65" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">推特:<a class="ae mj" href="https://twitter.com/gtmulhearn" rel="noopener ugc nofollow" target="_blank"> @gtmulhearn </a></p><p id="bf8d" class="pw-post-body-paragraph jz ka ht kb b kc kx ke kf kg ky ki kj kk kz km kn ko la kq kr ks lb ku kv kw hm dt translated">也可以在GitHub上查看我的信息:</p><div class="nb nc fm fo nd ne"><a href="https://github.com/gmulhearn" rel="noopener  ugc nofollow" target="_blank"><div class="nf ab ej"><div class="ng ab nh cl cj ni"><h2 class="bd hu fv z el nj eo ep nk er et hs dt translated">gmulhearn -概述</h2><div class="nl l"><h3 class="bd b fv z el nj eo ep nk er et ek translated">📊我的一些数据👨‍💻个人项目分散式App全栈模板d App栈模板是一个模板…</h3></div><div class="nm l"><p class="bd b gc z el nj eo ep nk er et ek translated">github.com</p></div></div><div class="nn l"><div class="oi l np nq nr nn ns iz ne"/></div></div></a></div><blockquote class="oj"><p id="1954" class="ok ol ht bd om on oo op oq or os kw ek translated">交易新手？试试<a class="ae mj" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或者<a class="ae mj" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>