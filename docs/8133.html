<html>
<head>
<title>CSC School: Cryptography#4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CSC学校:密码学#4</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/csc-school-cryptography-4-30534b2d94dd?source=collection_archive---------62-----------------------#2022-12-27">https://medium.com/coinmonks/csc-school-cryptography-4-30534b2d94dd?source=collection_archive---------62-----------------------#2022-12-27</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="90ef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">跳到区块链对第一步不好。进入其中需要密码学的知识。在这个讲座中，我们将看看我们在区块链需要的密码学(特别是CSC)及其概念。</p><h2 id="1a78" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">密码系统</h2><p id="320f" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">密码学，或称密码学，是在敌对行为存在的情况下对安全通信技术的实践和研究。更一般地说，密码学是关于构造和分析防止第三方或公众读取私人信息的协议。</p><blockquote class="ko"><p id="64aa" class="kp kq ht bd kr ks kt ku kv kw kx jn ek translated">不知道什么时候买卖，试试<a class="ae ky" href="http://coincodecap.com/go/bityard" rel="noopener ugc nofollow" target="_blank">复制交易</a>。</p></blockquote><p id="a5ef" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hm dt translated">加密签名是区块链的关键部分。它们用于证明地址的所有权，而不会暴露其私钥。这主要用于签署事务，但也可用于签署任意消息。在本文中，您将找到在CSC环境中这些签名如何工作的技术解释。</p><h2 id="3c8f" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">公钥和私钥</h2><p id="9e15" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">我们希望从钱包开始这一部分，因为它们是软件，我们需要安装和设置它们，所以我认为密钥是加密钱包为您管理的事情的一部分，所以让我们先开始。钥匙。</p><p id="20b0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">关于密码学，首先要知道的是，你永远不应该丢失你的私钥或初始短语，请永远不要忘记这一点。</p><p id="c11e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">规则是，你必须将你的私钥输入到一个安全的加密钱包程序中，并且永远不要将其作为文本文件保存在你的个人电脑或手机上，并且它太长了，无法在人类的脑海中记住，所以要写在纸上以确保安全，为此，任何有权访问你的个人电脑或手机的人都无法读取它。</p><p id="927d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在一些国家，你担心政府可能会寻找你的钥匙，但有更大的房屋被烧毁或被水破坏的风险，所以确保你在不同的安全地方有备份。</p><p id="1a5f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果开发和测试不需要私钥，在源文件中编码，确保不要在日常交易中使用这个开发密钥，当你的密钥放在GitHub等中也不算太差。</p><p id="59c2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这同样适用于您的seed语句，这是一种将私钥编写为一系列短词的方式，作为开发人员，您直接使用私钥，但最后，用户在加密和纸质钱包之间移动时，会将他们的私钥用作初始表达式。</p><p id="fabe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你还应该知道，你不应该无缘无故地与人分享你的地址和公钥，这样没有人可以在没有你的私钥的情况下直接窃取你的令牌。攻击者可以向您发送钓鱼令牌，这些令牌会将您引向网络上的程序，这些程序会试图欺骗您使用您的私钥来做一些愚蠢的事情。</p><h2 id="f258" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">什么是钥匙？</h2><p id="2340" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">私钥或公钥只是一种数据类型，在ECC的特殊情况下，这两个密钥都是非常大的数字，大到可以存储为string或bigInteger。</p><h2 id="9c9b" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">私人密钥</h2><p id="986a" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">ECC的私钥是一个随机生成的整数，可以是十六进制的形式:</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff le"><img src="../Images/472a8d79571e1e26bbf049984a352bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/0*Wo0S63Q9R484Tqek.png"/></div></figure><p id="a535" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在许多区块链网络中，这个密钥必须小于某个质数。</p><p id="7e22" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这在hexadecimal‌:是个大数字</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff lm"><img src="../Images/0458cc5609d9504b3972e842387135f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/0*Epj1Uorkm95zHMAU.png"/></div></figure><p id="1c14" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用这个质数的原因超出了本课程的范围，但是这个质数设定的极限是很重要的。不是每个随机整数都是有效的私钥，如果你想创建自己的密钥，它必须小于第一个数字。</p><pre class="lf lg lh li fq ln lo lp bn lq lr bi"><span id="5283" class="ls jp ht lo b be lt lu l lv lw">let privateKey  <br/>do {<br/>    privateKey = generateRandomInteger()<br/>  } while(privateKey &gt; 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn)</span></pre><h2 id="4d08" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">公开密钥</h2><p id="40fd" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">ECC的公钥是两个连接在一起的整数，这两个数字可以具有私钥的长度，但它们不是随机的。这两个数字是根据私钥计算出来的。</p><p id="0770" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">公钥如下图所示:</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff lx"><img src="../Images/8209c02f7e14b358c0efa2269a347f38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/0*whsKXZZOpSQSsACT.png"/></div></figure><p id="39ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">从私钥计算公钥的功能，它基于特定的算法和一些预定的参数，所有与CSC网络交互的系统必须使用相同的算法和参数来实现相同的结果。</p><pre class="lf lg lh li fq ln lo lp bn lq lr bi"><span id="995e" class="ls jp ht lo b be lt lu l lv lw">let privateKey<br/>do {<br/>    privateKey = generateRandomInteger()<br/>  } while(privateKey &gt; 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2fn)<br/>const publicKey = generatePublicKey(privateKey)</span></pre><h2 id="3383" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">种子短语</h2><p id="2554" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">种子短语也称为秘密恢复短语，是12到24个短随机单词的列表，用于生成一个或多个私钥，并最终生成公钥和地址。</p><p id="ad40" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">种子语句可能类似于以下示例:</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/b0cf8dce25fc7b63cac28f17ae1f009c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/0*tC2N34EfS11M7dmZ.png"/></div></figure><p id="2a7b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">虽然您可以直接生成一个私钥，但许多加密钱包程序使用一个密钥短语来为您生成它们，许多人使用多个地址。</p><p id="d441" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">种子表达式的概念是它是一个随机的单词列表，但从该表达式创建几个私钥的算法是确定的，这允许您从一个表达式中生成几个密钥，从种子语句中检索所有这些密钥，否则您必须单独记下每个私钥。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff lz"><img src="../Images/b986d92ec5494fbccf5a95d1bd602b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/0*K87aYuV56Kgd_HRs.png"/></div></figure><p id="2b3c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">消极的一点是，如果你的种子短语被盗，所有生成的私钥也将被盗，这意味着无论什么对你的私钥是真的，对你的初始表达式也是十倍真的，因为它与多个私钥是一样的。</p><p id="f3dd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">永远不要在电脑或智能手机上的加密钱包应用程序之外写你的初始短语，永远不要把它存储在S3桶或GitHub中，等等。如果您的智能手机或笔记本电脑丢失或损坏，要找回您的密钥，您可以将种子短语写在一张纸上，并将其保存在安全的地方。</p><h2 id="b5cb" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">钥匙是用来做什么的？</h2><p id="9274" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">到目前为止，你已经知道了键是什么，以及应该如何使用它们，但是它们到底是用来做什么的呢？</p><p id="fad7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">私钥和公钥用于不同的任务。它们的有用性来自于这样一个事实:每个人都可以拥有你的公钥，而任何人都不应该拥有你的私钥。</p><h2 id="cfe9" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">用私钥签署消息</h2><p id="2e84" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">他们使用私钥对数据进行签名，签名意味着在数据上附加一个签名。签名是使用签名算法创建的，该算法使用您的私钥和要签名的数据。</p><p id="9ce6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">关键是没有私钥就不能生成签名数据。</p><p id="fd07" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在Base64版本中，签名可能是这样的:</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff ma"><img src="../Images/68a390138855ce3328e2891d0b3811f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*m8NlXTxF4vSi6y3J.png"/></div></figure><p id="f946" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">公钥是用来验证签名的，如果你用私钥签名的话，相关的公钥结合签名算法，签名和被签名的数据会产生是或否的结果，这个来自私钥的签名是正确的。</p><p id="7adb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当您是唯一拥有您的私钥的人时，您是唯一可以创建这些签名的人，如果您的密钥被盗，其他人可以声称他们是原始所有者，如果您丢失了您的私钥，您将不再能够创建签名，并且您的公钥系统不会相信您是您所说的那个人。</p><p id="c8c7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在图2中，您可以看到这三部分是如何相互作用的。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff ma"><img src="../Images/e5122e7d283c7d5644d4760201eeb19f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*vl-FKQE4zfDR7OeA.png"/></div></figure><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff ma"><img src="../Images/6304c3b9dff1037a3c2942db65e98385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/0*-0BYZU_fCmb2gNhK.png"/></div></figure><h2 id="242b" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">用公钥加密消息</h2><p id="7a22" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">您了解了可以使用公钥来验证签名，但这并不是使用公钥所能做的唯一事情，公钥能够加密只有相应的私钥才能打开的消息。</p><p id="5bdb" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你想使用非对称加密进行私人通信，你必须交换公钥，任何人只要有你的公钥，就可以给你发送只有你能阅读的信息。</p><p id="6cb1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下图显示了简化的流程。出于性能原因，该映像中的消息通常不是您想要发送的实际数据，而是与私钥持有者交换的对称加密密钥，然后用于加密/解密双方之间的所有当前消息。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff mb"><img src="../Images/fc3d79192a269f9f0c3ff93e663e43b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/0*PvffPvH8t2RUikLG.png"/></div></figure><h2 id="31b0" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">ECDSA</h2><p id="d0ea" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">椭圆曲线数字签名算法(ECDSA)是一种数字签名算法(DSA ),它使用从椭圆曲线加密(ECC)导出的密钥。这是一个基于公钥加密(PKC)的特别有效的等式。</p><p id="e1b1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">ECDSA在许多安全系统中使用，在安全消息应用中很受欢迎，它是比特币安全的基础(比特币“地址”充当公钥)。</p><p id="c4ba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">ECDSA还用于传输层安全性(TLS ),它是安全套接字层(SSL)的继任者，通过加密web浏览器和web应用程序之间的连接来实现。HTTPS网站的加密连接(由浏览器中显示的物理挂锁图像表示)是通过使用ECDSA的签名证书实现的。</p><p id="e4e5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">与另一种流行的算法RSA相比，ECDSA的一个主要特征是，ECDSA以较短的密钥长度提供了更高程度的安全性。这进一步增加了它的投资回报率，因为ECDSA比RSA使用更少的计算机能力，这是一个不太安全的竞争等式。</p><p id="cc2f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Elliptic_curve_point_multiplication" rel="noopener ugc nofollow" target="_blank">椭圆曲线点操作</a>，我们可以从私钥中导出一个值，这个值是不可逆的。这样，我们可以创建安全且防篡改的签名。得出这些值的函数被称为<a class="ae ky" href="https://en.wikipedia.org/wiki/Trapdoor_function" rel="noopener ugc nofollow" target="_blank">活板门函数</a>。</p><h2 id="d62a" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">使用ECDSA签名和验证</h2><p id="6c71" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">ECDSA签名包含两个数字(整数):<code class="eh mc md me lo b">r</code>和<code class="eh mc md me lo b">s</code>。CSC还使用一个额外的<code class="eh mc md me lo b">v</code>(恢复标识符)变量。签名可以记为<code class="eh mc md me lo b">{r, s, v}</code>。</p><p id="d822" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">要创建一个签名，你需要要签名的消息和要签名的私钥(<code class="eh mc md me lo b">dₐ</code>)。“简化的”签名过程如下所示:</p><ol class=""><li id="3df6" class="mf mg ht is b it iu ix iy jb mh jf mi jj mj jn mk ml mm mn dt translated">从要签名的消息中计算一个散列值(<code class="eh mc md me lo b">e</code>)。</li><li id="d6e2" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mk ml mm mn dt translated">为<code class="eh mc md me lo b">k</code>生成一个安全随机值。</li><li id="f570" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mk ml mm mn dt translated">通过将<code class="eh mc md me lo b">k</code>乘以椭圆曲线的常数<code class="eh mc md me lo b">G</code>来计算椭圆曲线上的点<code class="eh mc md me lo b">(x₁, y₁)</code>。</li><li id="9a7c" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mk ml mm mn dt translated">计算<code class="eh mc md me lo b">r = x₁ mod n</code>。如果<code class="eh mc md me lo b">r</code>等于零，返回步骤2。</li><li id="e615" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mk ml mm mn dt translated">计算<code class="eh mc md me lo b">s = k⁻¹(e + rdₐ) mod n</code>。如果<code class="eh mc md me lo b">s</code>等于零，返回步骤2。</li></ol><p id="0755" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在CSC中，hash通常用<code class="eh mc md me lo b">Keccak256("\x19CSC Signed Message:\n32" + Keccak256(message))</code>计算。这确保签名不能用于CSC之外的目的。</p><p id="8d9b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">因为我们对<code class="eh mc md me lo b">k</code>使用随机值，所以每次得到的签名都不一样。当<code class="eh mc md me lo b">k</code>不够随机时，或者当值不是秘密时，可以使用两个不同的签名来计算私钥(“故障攻击”)。但是，当你<a class="ae ky" href="https://mycrypto.com/sign-and-verify-message/sign" rel="noopener ugc nofollow" target="_blank">在MyCrypto </a>中对一条消息进行签名时，每次的输出都是一样的，那么这怎么保证安全呢？这些<em class="mt">确定性</em>签名使用<a class="ae ky" href="https://tools.ietf.org/html/rfc6979" rel="noopener ugc nofollow" target="_blank"> RFC 6979标准</a>，该标准描述了如何基于私钥和消息(或散列)为<code class="eh mc md me lo b">k</code>生成安全值。</p><p id="8777" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh mc md me lo b">{r, s, v}</code>签名可以组合成一个65字节长的序列:32字节用于<code class="eh mc md me lo b">r</code>，32字节用于<code class="eh mc md me lo b">s</code>，1字节用于<code class="eh mc md me lo b">v</code>。如果我们将其编码为十六进制字符串，我们最终会得到一个130个字符长的字符串，大多数钱包和接口都使用这个字符串。例如，MyCrypto中的完整签名如下所示:</p><p id="737b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们可以在MyCrypto的“验证消息”页面使用这个，它会告诉我们<code class="eh mc md me lo b">0x76e01859d6cf4a8637350bdb81e3cef71e29b7c2</code>签署了这个消息。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff mu"><img src="../Images/0ce19ce4c8de45a1b0f216c270014914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/0*XzqgGkKuiIWOz1ea.png"/></div></figure><p id="cf37" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你可能会问:为什么要包含所有额外的信息，比如<code class="eh mc md me lo b">address</code>、<code class="eh mc md me lo b">msg</code>和<code class="eh mc md me lo b">version</code>？你就不能验证一下签名本身吗？不完全是。这就像签署一份合同，然后删除合同中的任何信息，只保留签名。与事务签名不同(我们将对此进行更深入的讨论)，消息签名仅仅是一个签名。</p><p id="2cd2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了验证消息，我们需要原始消息、签名时使用的私钥地址以及签名<code class="eh mc md me lo b">{r, s, v}</code>本身。版本号只是MyCrypto使用的任意版本号。MyCrypto的非常老的版本用于将当前日期和时间添加到消息中，创建一个散列，并使用上述步骤进行签名。这后来被改变以匹配JSON-RPC方法<code class="eh mc md me lo b"><a class="ae ky" href="https://eth.wiki/json-rpc/API" rel="noopener ugc nofollow" target="_blank">p</a>ersonal_sign</code>的行为，所以版本“2”被引入。</p><p id="e6fd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">恢复公钥的(再次“简化”)过程如下所示:</p><ul class=""><li id="4977" class="mf mg ht is b it iu ix iy jb mh jf mi jj mj jn mv ml mm mn dt translated">计算要恢复的消息的哈希(<code class="eh mc md me lo b">e</code>)。</li><li id="8af0" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mv ml mm mn dt translated">计算椭圆曲线上的点<code class="eh mc md me lo b">R = (x₁, y₁)</code>，其中<code class="eh mc md me lo b">v = 27</code>为<code class="eh mc md me lo b">r</code>，而<code class="eh mc md me lo b">v = 28</code>为<code class="eh mc md me lo b">r + n</code>。</li><li id="a3fb" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mv ml mm mn dt translated">计算<code class="eh mc md me lo b">u₁ = -zr⁻¹ mod n</code>和<code class="eh mc md me lo b">u₂ = sr⁻¹ mod n</code>。</li><li id="7ba0" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mv ml mm mn dt translated">计算点<code class="eh mc md me lo b">Qₐ = (xₐ, yₐ) = u₁ × G + u₂ × R</code>。</li></ul><p id="6cc6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh mc md me lo b">Qₐ</code>是签名地址的<em class="mt">公钥</em>对<em class="mt">私钥</em>的点。我们可以从中导出一个地址，并检查它是否与提供的地址匹配。如果是，则签名有效。</p><h2 id="f32c" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">恢复标识符(“v”)</h2><p id="d540" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated"><code class="eh mc md me lo b">v</code>是签名的最后一个字节，可以是27 ( <code class="eh mc md me lo b">0x1b</code>)或28 ( <code class="eh mc md me lo b">0x1c</code>)。这个标识符很重要，因为我们正在处理椭圆曲线，曲线上的多个点可以单独从<code class="eh mc md me lo b">r</code>和<code class="eh mc md me lo b">s</code>计算。这将导致可以被恢复的两个不同的公钥(因此是地址)。<code class="eh mc md me lo b">v</code>只是指示使用这些点中的哪一个。</p><p id="8c03" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在大多数实现中，<a class="ae ky" href="https://github.com/ethereum/go-ethereum/issues/19751#issuecomment-504900739" rel="noopener ugc nofollow" target="_blank"/><code class="eh mc md me lo b"><a class="ae ky" href="https://github.com/ethereum/go-ethereum/issues/19751#issuecomment-504900739" rel="noopener ugc nofollow" target="_blank">v</a></code><a class="ae ky" href="https://github.com/ethereum/go-ethereum/issues/19751#issuecomment-504900739" rel="noopener ugc nofollow" target="_blank">在内部只是0或1</a>，但是27被添加为用于签署比特币消息的任意数字，CSC也适应了这一点。</p><p id="1d55" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">由于<a class="ae ky" href="https://eips.ethereum.org/EIPS/eip-155" rel="noopener ugc nofollow" target="_blank"> EIP-155 </a>，我们也使用链ID来计算<code class="eh mc md me lo b">v</code>值。这防止了跨不同链的重放攻击:为CSC签名的事务不能用于Ethereum Classic，反之亦然。然而，目前这仅用于签署交易，而不用于签署消息。</p><h2 id="7493" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">已签名的交易</h2><p id="044e" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated">到目前为止，我们主要讨论了消息上下文中的签名。与消息一样，事务在发送之前也要签名。对于像Ledger和Trezor设备这样的硬件钱包，这发生在设备本身。对于私钥(或密钥库文件、助记短语)，这是直接在MyCrypto上完成的。这使用了一种非常类似于消息签名的方法，但是事务的编码稍有不同。</p><p id="e7df" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">已签名的交易采用<a class="ae ky" href="https://eth.wiki/en/fundamentals/rlp" rel="noopener ugc nofollow" target="_blank"> RLP </a>编码，由所有交易参数(随机数、汽油价格、汽油限额、to、值、数据)和签名(v、r、s)组成。已签名的事务如下所示:</p><pre class="lf lg lh li fq ln lo lp bn lq lr bi"><span id="db76" class="ls jp ht lo b be lt lu l lv lw">0xf86c0a8502540be400825208944bbeeb066ed09b7aed07bf39eee0460dfa261520880de0b6b3a7640000801ca0f3ae52c1ef3300f44df0bcfd1341c232ed6134672b16e35699ae3f5fe2493379a023d23d2955a239dd6f61c4e8b2678d174356ff424eac53da53e17706c43ef871</span></pre><h2 id="bbab" class="jo jp ht bd jq jr js jt ju jv jw jx jy jb jz ka kb jf kc kd ke jj kf kg kh ki dt translated">被推荐的</h2><p id="ba7d" class="pw-post-body-paragraph iq ir ht is b it kj iv iw ix kk iz ja jb kl jd je jf km jh ji jj kn jl jm jn hm dt translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Cryptography" rel="noopener ugc nofollow" target="_blank">密码术</a></p><p id="c8f1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" rel="noopener ugc nofollow" target="_blank"> ECDSA </a></p><p id="3e5a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/RSA_(cryptosystem)" rel="noopener ugc nofollow" target="_blank"> RSA </a></p><blockquote class="ko"><p id="5d4e" class="kp kq ht bd kr ks kt ku kv kw kx jn ek translated">加入Coinmonks <a class="ae ky" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae ky" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="c97e" class="mw jp ht bd jq mx my mz ju na nb nc jy nd ne nf kb ng nh ni ke nj nk nl kh nm dt translated">另外，阅读</h1><ul class=""><li id="f63b" class="mf mg ht is b it kj ix kk jb nn jf no jj np jn mv ml mm mn dt translated"><a class="ae ky" href="https://coincodecap.com/what-are-decentralized-exchanges" rel="noopener ugc nofollow" target="_blank">去中心化交易所</a> | <a class="ae ky" href="https://coincodecap.com/bitbns-fip" rel="noopener ugc nofollow" target="_blank">比特恩斯FIP </a> | <a class="ae ky" href="https://coincodecap.com/pionex-review-exchange-with-crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"> Pionex评论</a></li><li id="938b" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mv ml mm mn dt translated"><a class="ae ky" href="https://coincodecap.com/buy-crypto-with-credit-card" rel="noopener ugc nofollow" target="_blank">用信用卡购买密码的10个最佳地点</a></li><li id="e944" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mv ml mm mn dt translated"><a class="ae ky" href="https://coincodecap.com/best-cardano-wallets" rel="noopener ugc nofollow" target="_blank">最好的卡达诺钱包</a> | <a class="ae ky" href="https://coincodecap.com/bingbon-copy-trading" rel="noopener ugc nofollow" target="_blank"> Bingbon副本交易</a></li><li id="6567" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mv ml mm mn dt translated"><a class="ae ky" href="https://coincodecap.com/how-to-add-arbitrum-to-metamask-wallet" rel="noopener ugc nofollow" target="_blank">如何给MetaMask钱包添加Arbitrum？</a></li><li id="cf6b" class="mf mg ht is b it mo ix mp jb mq jf mr jj ms jn mv ml mm mn dt translated"><a class="ae ky" href="https://coincodecap.com/kucoin-vs-kraken-vs-bityard" rel="noopener ugc nofollow" target="_blank"> KuCoin vs北海巨妖vs BitYard </a></li></ul></div></div>    
</body>
</html>