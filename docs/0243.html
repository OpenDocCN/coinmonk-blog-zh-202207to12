<html>
<head>
<title>Running a Solana Validator on AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在AWS上运行Solana验证程序</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/running-a-solana-validator-on-aws-bb86162eaf29?source=collection_archive---------4-----------------------#2022-07-05">https://medium.com/coinmonks/running-a-solana-validator-on-aws-bb86162eaf29?source=collection_archive---------4-----------------------#2022-07-05</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><div class=""><h2 id="7da4" class="pw-subtitle-paragraph iq hs ht bd b ir is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ek translated">在amazon web services中运行Solana验证器实例的分步指南</h2></div><p id="146f" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">Solana是世界上速度最快但被低估的区块链之一，其生态系统在Web3、Defi、NFTs等加密领域过度增长。</p><p id="858f" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在本文中，我们将讨论Solana中的验证器架构。此外，我们将着手在AWS EC2实例上运行Solana验证器。</p><p id="05d1" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">注意:这是一篇技术文章，而不是投资建议！</p><h2 id="1a9d" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated">用简单的话来说，区块链是如何工作的</h2><p id="c09a" class="pw-post-body-paragraph ji jj ht jk b jl kz iu jn jo la ix jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">对区块链有最起码的了解对于阅读和使用这篇文章是必要的。如果您熟悉区块链的概念，您可以跳过这一部分。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff le"><img src="../Images/337ec40b82184f67c8d9a723713c0b01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*AuFgH78eqW8HUcPQ5Jz2DA.jpeg"/></div><figcaption class="lm ln fg fe ff lo lp bd b be z ek">Fig 1. How a blockchain works [1].</figcaption></figure><p id="b095" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">假设阿里想给莎拉汇些钱(见图1)。该事务的数据在线表示为一个块。该块被广播给网络中的每一方，并且网络中的那些方验证该事务(验证者)。验证该块后，可以将其添加到链中(资金从Ali转移到Sarah)。这一链条为交易提供了不可磨灭的透明记录。这就是为什么它被称为区块链(区块链！).</p><p id="675d" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">首先要熟悉的概念是<em class="lq">事务</em>。交易是由客户签署的一组指令。事务被自动执行，只有两种可能的结果:成功或失败。</p><p id="5917" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">一个<em class="lq">分类账</em>就像一个银行或者一个保存客户交易记录的数据库。所以分类账是包含客户签署的交易的条目列表。</p><blockquote class="lr ls lt"><p id="4a0f" class="ji jj lq jk b jl jm iu jn jo jp ix jq lu js jt ju lv jw jx jy lw ka kb kc kd hm dt translated">交易新手？尝试<a class="ae lx" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae lx" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote><h2 id="9625" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated">索拉纳验证器</h2><p id="ed19" class="pw-post-body-paragraph ji jj ht jk b jl kz iu jn jo la ix jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">如前所述，验证器只是一个计算机实例，用于验证添加到分类帐中的交易。维护分类帐的一组验证器称为群集。</p><p id="116a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">Solana validator使用了<em class="lq">流水线</em>，这是CPU设计中的一个优化标准。当一个输入数据流需要在一系列步骤中处理时，它是正确的工具，并且不同的硬件负责每个步骤[2]。</p><figure class="lf lg lh li fq lj fe ff paragraph-image"><div class="fe ff ly"><img src="../Images/aacf2f4382fbc6bc91fffde88ab61c49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*_Qf4rg9c1Uzq5D7BzZ_jPA.png"/></div><figcaption class="lm ln fg fe ff lo lp bd b be z ek">Fig 2. The anatomy of a validator [2].</figcaption></figure><p id="fb9b" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">索拉纳验证程序有两个管道进程:TVU和TPU。TPU代表事务处理单元。它创建分类帐分录，用于领导模式，TVU用于验证分录。</p><h2 id="37a7" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated">正在准备虚拟机</h2><p id="8dc0" class="pw-post-body-paragraph ji jj ht jk b jl kz iu jn jo la ix jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">可以在AWS这样的云平台上的任何空服务器或虚拟机上安装和运行Solana validator。你需要一个12核24线程或更多的CPU，至少128 GB的内存，Ubuntu 20.04和一个支持cuda的GPU [3]。</p><p id="b81c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">在开始之前，请确保您已经安装了Solana命令行工具。它可以通过以下命令在macOS或Linux上安装[4]:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="ab15" class="ke kf ht ma b fv me mf l mg mh">sh -c “$(curl -sSfL https://release.solana.com/v1.10.29/install)"</span></pre><p id="434c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">可以通过运行<code class="eh mi mj mk ma b">solana --version</code>来测试安装。</p><p id="480e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">因为我们要将我们的验证器连接到Devnet集群，所以需要通过<code class="eh mi mj mk ma b">--url</code>参数来设置配置:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="0f45" class="ke kf ht ma b fv me mf l mg mh">solana config set — url <a class="ae lx" href="http://api.devnet.solana.com" rel="noopener ugc nofollow" target="_blank">http://api.devnet.solana.com</a></span></pre><p id="d830" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">通过<code class="eh mi mj mk ma b">solana transaction-count </code>获取事务计数，我们可以确保集群是可达的。</p><h2 id="cd4e" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated">调整系统</h2><p id="b1e4" class="pw-post-body-paragraph ji jj ht jk b jl kz iu jn jo la ix jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">在运行验证器之前，为了优化的目的，有必要调整一些系统设置(增加OS UDP缓冲区和文件映射限制)。整个过程可以由一个叫做<code class="eh mi mj mk ma b">solana-sys-tuner</code>的守护进程自动完成，这个守护进程包含在Solana二进制版本中[5]。</p><p id="ab81" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">要运行它:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="426c" class="ke kf ht ma b fv me mf l mg mh">sudo $(command -v solana-sys-tuner) --user $(whoami) &gt; sys-tuner.log 2&gt;&amp;1 &amp;</span></pre><h2 id="faa2" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated">生成身份</h2><p id="eace" class="pw-post-body-paragraph ji jj ht jk b jl kz iu jn jo la ix jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">为验证程序创建身份密钥对:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="57bb" class="ke kf ht ma b fv me mf l mg mh">solana-keygen new -o ~/validator-keypair.json</span></pre><p id="a562" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">您的验证器身份密钥对在网络中唯一地标识您的验证器。<strong class="jk hu">备份这些信息至关重要。</strong></p><p id="24dd" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">如果您不备份这些信息，您将无法恢复您的验证器，如果您失去对它的访问。如果发生这种情况，你也将失去你的SOL分配。</p><p id="c907" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">要备份您的validator identify keypair，<strong class="jk hu">将您的“validator-keypair.json”文件或种子短语备份到一个安全的位置。</strong></p><p id="864a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">到目前为止一切顺利，现在是时候设置Solana配置以使用生成的密钥对了:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="4a5f" class="ke kf ht ma b fv me mf l mg mh">solana config set --keypair ~/validator-keypair.json</span></pre><p id="1653" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">输出应该类似于以下内容:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="c6d1" class="ke kf ht ma b fv me mf l mg mh">Config File: /home/solana/.config/solana/cli/config.yml<br/>RPC URL: <a class="ae lx" href="http://api.devnet.solana.com" rel="noopener ugc nofollow" target="_blank">http://api.devnet.solana.com</a><br/>WebSocket URL: ws://api.devnet.solana.com/ (computed)<br/>Keypair Path: /home/solana/validator-keypair.json<br/>Commitment: confirmed</span></pre><p id="8a8a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">下一步是空投一些溶胶开始。请注意，此airdrop仅在Devnet和Testnet上可用:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="7b68" class="ke kf ht ma b fv me mf l mg mh">solana airdrop 1</span></pre><p id="a25c" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">我们还需要一个取款人和一个投票账户。撤回帐户有权撤回您的投票帐户，它可以改变您的投票帐户的所有方面。所以很重要！</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="1c52" class="ke kf ht ma b fv me mf l mg mh">solana-keygen new -o ~/authorized-withdrawer-keypair.json</span></pre><p id="baa4" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">投票帐户:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="44a7" class="ke kf ht ma b fv me mf l mg mh">solana-keygen new -o ~/vote-account-keypair.json</span></pre><h2 id="671b" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated">连接并运行验证程序</h2><p id="025e" class="pw-post-body-paragraph ji jj ht jk b jl kz iu jn jo la ix jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">现在，我们已经准备好通过以下方式将验证器连接到集群:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="208f" class="ke kf ht ma b fv me mf l mg mh">solana-validator \<br/>  --identity ~/validator-keypair.json \<br/>  --vote-account ~/vote-account-keypair.json \<br/>  --rpc-port 8899 \<br/>  --entrypoint entrypoint.devnet.solana.com:8001 \<br/>  --limit-ledger-size \<br/>  --log ~/solana-validator.log</span></pre><p id="83e5" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">验证器将自动记录到一个文件中(在这个例子中是solana-validator.log)。</p><p id="b45e" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">如果验证器连接到网络，其IP地址和公钥将出现在以下列表中:</p><pre class="lf lg lh li fq lz ma mb mc aw md dt"><span id="0d20" class="ke kf ht ma b fv me mf l mg mh">solana gossip</span></pre><p id="c70a" class="pw-post-body-paragraph ji jj ht jk b jl jm iu jn jo jp ix jq jr js jt ju jv jw jx jy jz ka kb kc kd hm dt translated">最后，请不要止步于此，请务必阅读官方文档以获得更多选项和准确信息[6]。</p><h2 id="0411" class="ke kf ht bd kg kh ki kj kk kl km kn ko jr kp kq kr jv ks kt ku jz kv kw kx ky dt translated">参考</h2><p id="6cdf" class="pw-post-body-paragraph ji jj ht jk b jl kz iu jn jo la ix jq jr lb jt ju jv lc jx jy jz ld kb kc kd hm dt translated">*所有链接在本文发表时(2022年7月5日)有效。</p><ul class=""><li id="8e8e" class="ml mm ht jk b jl jm jo jp jr mn jv mo jz mp kd mq mr ms mt dt translated">[1]<a class="ae lx" href="https://www.pinterest.com/pin/654218283351673725/" rel="noopener ugc nofollow" target="_blank">https://www.pinterest.com/pin/654218283351673725/</a></li><li id="3f93" class="ml mm ht jk b jl mu jo mv jr mw jv mx jz my kd mq mr ms mt dt translated"><a class="ae lx" href="https://docs.solana.com/validator/anatomy" rel="noopener ugc nofollow" target="_blank">https://docs.solana.com/validator/anatomy</a></li><li id="0515" class="ml mm ht jk b jl mu jo mv jr mw jv mx jz my kd mq mr ms mt dt translated">[3]<a class="ae lx" href="https://developer.nvidia.com/cuda-gpus" rel="noopener ugc nofollow" target="_blank">https://developer.nvidia.com/cuda-gpus</a></li><li id="d43b" class="ml mm ht jk b jl mu jo mv jr mw jv mx jz my kd mq mr ms mt dt translated"><a class="ae lx" href="https://docs.solana.com/cli/install-solana-cli-tools" rel="noopener ugc nofollow" target="_blank">https://docs.solana.com/cli/install-solana-cli-tools</a></li><li id="6083" class="ml mm ht jk b jl mu jo mv jr mw jv mx jz my kd mq mr ms mt dt translated">[5]<a class="ae lx" href="https://docs.solana.com/running-validator/validator-start#system-tuning" rel="noopener ugc nofollow" target="_blank">https://docs . Solana . com/running-validator/validator-start # system-tuning</a></li><li id="92d1" class="ml mm ht jk b jl mu jo mv jr mw jv mx jz my kd mq mr ms mt dt translated">[6]https://docs.solana.com/running-validator/validator-start<a class="ae lx" href="https://docs.solana.com/running-validator/validator-start" rel="noopener ugc nofollow" target="_blank"/></li></ul></div></div>    
</body>
</html>