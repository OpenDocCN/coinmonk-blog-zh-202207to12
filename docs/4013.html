<html>
<head>
<title>All it takes is one bug to make a platform inoperable — Babylon Finance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">只要一个错误就能让一个平台无法运行——巴比伦金融</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/all-it-takes-is-one-bug-to-make-a-platform-inoperable-babylon-finance-5313e2554064?source=collection_archive---------46-----------------------#2022-09-21">https://medium.com/coinmonks/all-it-takes-is-one-bug-to-make-a-platform-inoperable-babylon-finance-5313e2554064?source=collection_archive---------46-----------------------#2022-09-21</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="a1b3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">随着2016年以太坊的DAO，可重入攻击开始了它的突出旅程，在最初的几个小时内窃取了360万ETH。从那以后，一切都没有改变。可重入性和稳固性一样古老。</p><p id="82e3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在2021年的几次再入攻击之后，2022年已经在DeFi市场上看到了多次再入攻击——黑客们明白，从TVL每天都在扩展的众多项目中可以获得很多好处。</p><p id="af85" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">名单相当长！</p><p id="8cf2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们来关注一下最新的加密资产管理公司Babylon Finance的垮台，该公司由于重入攻击而无法从Rari黑客攻击中恢复。Rari/FEI漏洞让Babylon Finance Investment Gardens损失了340万美元，这促使客户失去信心，收回了75%的TVL。</p><p id="002d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">根据该公司创始人Ramon Recuero在8月31日发表的声明，Babylon Finance将于11月15日停止为DeFi资产管理协议提供服务。</p><p id="f1f8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">重入攻击:检查FEI协议事件</strong></p><p id="2ab4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2022年4月，Fei协议成为重入攻击的受害者。攻击者从易受攻击的合同中提取了大约8000万美元的代币。通过使用从Compound派生的代码，Fei协议将自己置于危险之中。CEther代码中的多个可重入性漏洞在以前的版本中已被修补，但一些易受攻击的函数未被检测到。</p><p id="5343" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">契约的内部状态在外部交互发生之前被更新以反映该外部交互。这可以防止可重入性，因为外部交互可能会在从初始调用更新状态之前重入易受攻击的契约。</p><p id="ee63" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当智能协定向地址发送值而不遵循检查-效果-交互模式时，它会产生可重入性漏洞。简而言之，可重入攻击发生在两个智能契约相互通信时，其中一个利用另一个的代码(易受攻击的契约)从另一个获取资金。</p><p id="df28" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在易受攻击的智能合约有机会更新余额之前，攻击性智能合约反复调用撤销函数。发起攻击的智能合约可以在转移资金和更新余额之间创建的窗口期间进行另一次调用以提取其现金，并且重复该循环，直到所有资金耗尽。这就是漏洞利用继续运行的方式。</p><p id="fc7b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">攻击者在Fei协议的契约中使用了“exitMarket”和“borrow”函数。如果exitMarket功能证明存款不再被用作贷款抵押品，则可以提取存款。借用函数不遵循检查-效果-交互模式，因此容易受到攻击。它使用户能够使用存款资产作为抵押获得贷款。</p><p id="db16" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">通过使用智能协定地址来调用borrow，攻击者就利用了这个漏洞。</p><p id="819a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">借入函数尚未更新其内部状态，以反映当它将借出的金额传送给借入方时，存放的资产目前正被用作抵押品。</p><p id="8083" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">fallback函数执行exitMarket函数，并删除用作贷款抵押品的存款，当贷款传输到获取贷款的智能合同时，调用该函数。</p><p id="2e33" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">由于这个可重入性漏洞，攻击者可以获得贷款，然后提取作为贷款抵押品的存款资产。</p><p id="e01b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">利用各种池，攻击者能够从Fei协议智能合约中提取价值8000万美元的令牌。去年12月与Rari合并的Fei Protocol提出向黑客提供1000万美元作为“赏金”，以换取返还剩余资金。</p><p id="d8b2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在巅峰时期，Babylon持有3000万美元不同的加密货币，是Rari上最大的贷款池之一，拥有1000万美元的用户提供的资产。在Rari漏洞期间，Babylon损失了340万美元，其用户当时撤回了超过75%的资产。</p><p id="2ed1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">结束语</strong></p><p id="afbf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">尽管这是一个广为人知的老问题，可重入性漏洞仍然出现在今天的新智能契约中。直接的解决方案是查看所有进行外部调用的函数，并根据它们的基本原理决定它们是否安全。当涉及到保护和维护智能契约时，理解可重入攻击是一个很好的起点。</p><blockquote class="jo"><p id="8118" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated"><em class="jy">加入Coinmonks </em> <a class="ae jz" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank"> <em class="jy">电报频道</em> </a> <em class="jy">和</em> <a class="ae jz" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> <em class="jy"> Youtube频道</em> </a> <em class="jy">了解加密交易和投资</em></p></blockquote><h1 id="0db7" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">另外，阅读</h1><ul class=""><li id="d680" class="ky kz ht is b it la ix lb jb lc jf ld jj le jn lf lg lh li dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/3commas-review-an-excellent-crypto-trading-bot-2020-1313a58bec92">3商业评论</a> | <a class="ae jz" href="https://coincodecap.com/pionex-review-exchange-with-crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"> Pionex评论</a> | <a class="ae jz" rel="noopener" href="/coinmonks/coinrule-review-2021-a-beginner-friendly-crypto-trading-bot-daf0504848ba"> Coinrule评论</a></li><li id="6c1e" class="ky kz ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/ledger-vs-ngrave-zero-7e40f0c1d694">莱杰vs n rave</a>|<a class="ae jz" rel="noopener" href="/coinmonks/ledger-nano-s-vs-x-battery-hardware-price-storage-59a6663fe3b0">莱杰nano s vs x </a> | <a class="ae jz" rel="noopener" href="/coinmonks/binance-review-ee10d3bf3b6e">币安评论</a></li><li id="a10e" class="ky kz ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a> | <a class="ae jz" href="https://coincodecap.com/bingbon-review" rel="noopener ugc nofollow" target="_blank"> Bingbon审查</a></li><li id="e0ab" class="ky kz ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/bybit-exchange-review-dbd570019b71"> Bybit Exchange评论</a> | <a class="ae jz" href="https://coincodecap.com/bityard-reivew" rel="noopener ugc nofollow" target="_blank"> Bityard评论</a> | <a class="ae jz" href="https://coincodecap.com/jet-bot-review" rel="noopener ugc nofollow" target="_blank"> Jet-Bot评论</a></li><li id="7000" class="ky kz ht is b it lj ix lk jb ll jf lm jj ln jn lf lg lh li dt translated"><a class="ae jz" rel="noopener" href="/coinmonks/3commas-vs-pionex-vs-cryptohopper-best-crypto-bot-6a98d2baa203">3 commas vs crypto hopper</a>|<a class="ae jz" rel="noopener" href="/coinmonks/earn-crypto-interest-b10b810fdda3">赚取加密利息</a></li></ul></div></div>    
</body>
</html>