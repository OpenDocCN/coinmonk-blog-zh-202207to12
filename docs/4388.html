<html>
<head>
<title>Let’s play Solidity — Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让我们来玩“坚实”——第二部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/lets-play-solidity-part-2-6c3bb2878dc?source=collection_archive---------16-----------------------#2022-09-30">https://medium.com/coinmonks/lets-play-solidity-part-2-6c3bb2878dc?source=collection_archive---------16-----------------------#2022-09-30</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="d5ba" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">所以继续上一篇文章，我们正在建立一个公共交易机器人。</p><p id="bfcf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">第一部分—<a class="ae jo" rel="noopener" href="/p/e11b08622667">https://medium.com/p/e11b08622667</a></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff jp"><img src="../Images/7229da20f4621b37afbfef8f656a9a2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rd5ZXPgeoN0m0gB1dAdVWw.png"/></div></div></figure><p id="5f60" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">所以从这里开始是<a class="ae jo" href="https://github.com/JEflyer/CommunalTradingBot/blob/first/file.sol" rel="noopener ugc nofollow" target="_blank">回购</a>。这还没有完成，也没有测试。</p><p id="5377" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">好的，那么我先回顾一下我目前掌握的情况&amp;然后如果你觉得可以接受挑战，你可以试着完成合同草案。</p><p id="8bb2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">变量</strong></p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff kb"><img src="../Images/df65f27aeb87ee19d7f996b78a98a09b.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*PQeErjQP9BRVe6HSYi3Fhg.png"/></div></figure><p id="f04d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们存储管理员、机器人、USDC令牌、WMatic令牌的地址Uniswap路由器接口的一个实例。</p><p id="8ab1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们有3个结构，第一个是特定于赌注者的细节&amp;他们押什么/何时押，最后一个是我们将用于跟踪契约上的动作效果的步骤。</p><p id="0618" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用映射，我们可以存储这些结构的实例。例如，stakingData映射存储给定地址的StakeData结构的一个实例。</p><p id="d28c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">为了确保我们跟踪我们的订单，我做了一个活动和关闭订单数组。</p><p id="1c5a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将存储我们采取的最后一次买入/卖出行动的价格，以及比最后一次行动价格高出2.5%的最后一个价格变量。</p><p id="5a11" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在每次存款/取款/购买/出售时，我们将更新合同中的一个步骤，以便我们可以计算赌注者应得的奖励金额。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff kc"><img src="../Images/7b09078ad7c1eededa847a986f4fc7b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*UjMmof6P7SUQ757wGvzBhw.png"/></div></figure><p id="ed7c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">相当基本的构造函数，尽管我们在这里遗漏了一些安全检查，你能看出它们是什么吗？</p><p id="21de" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">两个基本修饰符，一个检查调用者是管理员，另一个检查给定的地址不为空。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff kd"><img src="../Images/e02d5cf72d300c67732e40567b8d8cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*7od-3jJB4vJc8zhioiC1TA.png"/></div></figure><p id="7dc9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这是一项安全措施，以避免合同管理的意外损失。admin不能设置为空地址，但可以放弃控制权。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff ke"><img src="../Images/5da1bec778b5fbf1ab5ee940055880c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UZtNa_tR3SKrWkJtTH-aZw.png"/></div></div></figure><p id="e2de" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">另外两个admin only函数，用于设置允许调用update函数的地址&amp;用于更新我们将要进行交换的DEX。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff kf"><img src="../Images/46ee568d9be9174171171391d37af8f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LSMHMbz1VLJnOPCekb_kTg.png"/></div></div></figure><p id="861b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">打桩</strong></p><ol class=""><li id="80ec" class="kg kh ht is b it iu ix iy jb ki jf kj jj kk jn kl km kn ko dt translated">检查一下打电话的人是不是在孤注一掷</li><li id="3895" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">检查呼叫者是否允许此合同花费足够的代币来完成交易</li><li id="85d7" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">检查呼叫方是否已经下注</li><li id="3d0f" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">将美元从调用方转移到此合同</li><li id="4956" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">存储此步骤的详细信息</li><li id="fb9f" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">存储此赌注者的详细信息</li></ol><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff ku"><img src="../Images/bb1787e903b0d4312aeddba8b2863da3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wqLdSHbJ-k7ooHu-NKOewA.png"/></div></div></figure><p id="5edf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你准备好了，这部分就是你的任务！如果没有，它将在下次被填充。</p><p id="c0e0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个函数只能被机器人调用。</p><ol class=""><li id="8252" class="kg kh ht is b it iu ix iy jb ki jf kj jj kk jn kl km kn ko dt translated">检查调用者是否是授权的机器人</li><li id="8373" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">检索1 Matic到USDC的当前价格</li><li id="bb2e" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">如果这是第一次调用更新函数，设置lastPrice &amp; lastActionPrice &amp;结束调用</li><li id="b039" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">其他</li><li id="aefc" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">计算当前价格可以与之比较的最高价格</li><li id="85b9" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">如果当前价格大于最后价格&amp;小于最大爬升价格，则将最后价格设置为当前价格</li><li id="f425" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">如果当前价格已经达到购买点，那么就购买并跟踪所有相关信息。</li><li id="b238" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">遍历订单</li><li id="db76" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn kl km kn ko dt translated">如果当前价格已经达到给定订单的卖价，则出售Matic &amp; store相关信息</li></ol><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff kv"><img src="../Images/3bd3ae4d2763dba781d6f4b5893754ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u3JQH5uSGqid-5t8-JEjTA.png"/></div></div></figure><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff kw"><img src="../Images/65903df331e3d131ab6cdfdbf5326142.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mq49l_VaW0LQzaGgzwXFhg.png"/></div></div></figure><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff kx"><img src="../Images/4e82d8d28dca481fa8e5c515fba3601d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H8d9-ZW6cZdeoR1en6a5PQ.png"/></div></div></figure><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff ky"><img src="../Images/558a5fb78ace626da34ef980268d004a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vlCvV5iHRwX1ppwumriHkw.png"/></div></div></figure><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="fe ff kz"><img src="../Images/e6fe1bc1dd94cc4936fdba8f5a178a5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8VSN4kk0iA-LBFyBiHU-qw.png"/></div></div></figure><p id="9fd7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你觉得可以，一定要尝试挑战！</p><p id="ed2f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你觉得这个有趣，那就看看这个吧！<br/><a class="ae jo" rel="noopener" href="/p/28a8bb064e86">https://medium.com/p/28a8bb064e86</a></p><p id="97cc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">坚实发展研究小组—<a class="ae jo" href="https://discord.gg/KzbcGmrnfN" rel="noopener ugc nofollow" target="_blank">https://discord.gg/KzbcGmrnfN</a></p><p id="a02c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">-多边形联盟—<a class="ae jo" href="https://www.polygonalliance.com/" rel="noopener ugc nofollow" target="_blank">https://www.polygonalliance.com/</a></p><p id="def5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">——多边形联盟不和—<a class="ae jo" href="https://discord.gg/kJKPCGQu66" rel="noopener ugc nofollow" target="_blank">https://discord.gg/kJKPCGQu66</a></p><p id="2349" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你喜欢这篇文章吗？想请我喝杯咖啡吗？<br/>Polygon/Eth/Bsc—0x4a 581 E0 EAF 6b 71d 05905 e8e 6014 DC 0277 a1 b 10 ad</p><blockquote class="la lb lc"><p id="b18d" class="iq ir ld is b it iu iv iw ix iy iz ja le jc jd je lf jg jh ji lg jk jl jm jn hm dt translated"><em class="ht">交易新手？试试</em> <a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a"> <em class="ht">加密交易机器人</em> </a> <em class="ht">或</em> <a class="ae jo" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c"> <em class="ht">复制交易</em> </a> <em class="ht">上</em> <a class="ae jo" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769"> <em class="ht">最好的加密交易</em> </a></p></blockquote><blockquote class="lh"><p id="e056" class="li lj ht bd lk ll lm ln lo lp lq jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jo" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h1 id="2e6f" class="lr ls ht bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo dt translated">另外，阅读</h1><ul class=""><li id="e75c" class="kg kh ht is b it mp ix mq jb mr jf ms jj mt jn mu km kn ko dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/free-crypto-signals-48b25e61a8da">免费加密信号</a> | <a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a></li><li id="42a1" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn mu km kn ko dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币</a>终极指南</li><li id="55b1" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn mu km kn ko dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/top-17-folding-electric-bikes-5e296f0918cb"> 16款最佳折叠电动自行车</a></li><li id="d79e" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn mu km kn ko dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/the-28-best-electric-bikes-review-and-buying-guide-in-2023-7bb3146cb403"> 28款最佳电动自行车点评</a></li><li id="8894" class="kg kh ht is b it kp ix kq jb kr jf ks jj kt jn mu km kn ko dt translated">前三名<a class="ae jo" rel="noopener" href="/coinmonks/top-3-binance-futures-trading-bots-e6031f84b3f9">币安期货交易机器人</a></li></ul></div></div>    
</body>
</html>