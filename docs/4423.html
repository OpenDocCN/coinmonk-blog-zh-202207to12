<html>
<head>
<title>How to Generate Random Numbers in Solidity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Solidity中生成随机数</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-generate-random-numbers-in-solidity-16950cb2261d?source=collection_archive---------1-----------------------#2022-10-01">https://medium.com/coinmonks/how-to-generate-random-numbers-in-solidity-16950cb2261d?source=collection_archive---------1-----------------------#2022-10-01</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="4fcd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">链上产生随机数的多种方法。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/40f25e3ab151a1f21e24c191b9c83d81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AwnUyTi9ngljmKhOqD4A2g.png"/></div></div></figure><h1 id="8cb0" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">概观</h1><p id="33eb" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated">智能合约是确定性的，这意味着任何拥有代码和输入的人都可以预测输出。智能合约也是公开的。给定公共代码，我们如何使其不具有确定性？</p><p id="cf31" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下面是一些技巧</p><ul class=""><li id="d89f" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll dt translated">散列伪随机数</li><li id="51e0" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn li lj lk ll dt translated">链上可验证随机函数(VRF)</li><li id="557c" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn li lj lk ll dt translated">离线可验证随机函数(VRF)</li><li id="f38b" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn li lj lk ll dt translated">提交-显示随机性</li></ul><h1 id="b7fe" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">散列伪随机数</h1><p id="c7f2" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated"><strong class="is hu">赞成者</strong></p><ul class=""><li id="7639" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll dt translated">易于在所有EVM上实施</li></ul><p id="3ded" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">缺点</strong></p><ul class=""><li id="a5df" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll dt translated">最不安全</li></ul><p id="060a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个想法是通过散列<code class="eh lr ls lt lu b">blockhash</code>、<code class="eh lr ls lt lu b">timestamp</code>和<code class="eh lr ls lt lu b">transaction origin</code>来产生随机数。这是伪随机的，因为矿工理论上可以在提交块之前生成这些值。</p><p id="9ef7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果大量资金依赖于这个数字，就不要使用这个技巧。</p><pre class="jp jq jr js fq lw lu lx ly aw lz dt"><span id="344c" class="ma kb ht lu b fv mb mc l md me">function random() internal view returns (uint256) {<br/>    return uint256(keccak256(abi.encodePacked(<br/>      tx.origin,<br/>      blockhash(block.number - 1),<br/>      block.timestamp,<br/>    )));<br/>  }</span></pre><p id="45af" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">来源</strong></p><div class="mf mg fm fo mh mi"><a href="https://etherscan.io/token/0xeb834ae72b30866af20a6ce5440fa598bfad3a42#code#F23#L277" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab ej"><div class="mk ab ml cl cj mm"><h2 class="bd hu fv z el mn eo ep mo er et hs dt translated">狼游戏(WGAME)令牌跟踪器|以太扫描</h2><div class="mp l"><h3 class="bd b fv z el mn eo ep mo er et ek translated">概述数千只羊和狼在元宇宙的一个农场竞争。一个诱人的羊毛奖品等待着，与致命的…</h3></div><div class="mq l"><p class="bd b gc z el mn eo ep mo er et ek translated">etherscan.io</p></div></div></div></a></div><h1 id="1733" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">链上可验证随机函数</h1><p id="43c8" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated"><strong class="is hu">优点</strong></p><ul class=""><li id="5070" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll dt translated">论连锁安全</li></ul><p id="9ac7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">缺点</strong></p><ul class=""><li id="a270" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll dt translated">仅限于某些区块链</li></ul><p id="d65d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">概述</strong></p><p id="141c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">一些链已经将VRF直接构建到它们的协议中。例如，哈莫尼用他们的赌注和BLS签名来签署能产生签名的区块。每个签名可以被散列以生成一个随机数。简而言之，某些区块链可以为每个块产生一个随机数。</p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="mr ms l"/></div></figure><p id="c3f9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">演示</strong></p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff mt"><img src="../Images/2ddb2686f19d214ccc397ec0116f9dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qQEfIeHLmOHS2bdFMtk2sw.png"/></div></div></figure><div class="mf mg fm fo mh mi"><a href="https://leon-do.github.io/harmony-vrf/" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab ej"><div class="mk ab ml cl cj mm"><h2 class="bd hu fv z el mn eo ep mo er et hs dt translated">和谐VRF</h2><div class="mp l"><h3 class="bd b fv z el mn eo ep mo er et ek translated">演示</h3></div><div class="mq l"><p class="bd b gc z el mn eo ep mo er et ek translated">莱昂-多. github.io</p></div></div></div></a></div><p id="d3d8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">来源</strong></p><div class="mf mg fm fo mh mi"><a href="https://docs.harmony.one/home/developers/tools/harmony-vrf" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab ej"><div class="mk ab ml cl cj mm"><h2 class="bd hu fv z el mn eo ep mo er et hs dt translated">和谐VRF</h2><div class="mp l"><h3 class="bd b fv z el mn eo ep mo er et ek translated">和谐一号</h3></div></div><div class="mu l"><div class="mv l mw mx my mu mz jy mi"/></div></div></a></div><h1 id="1b6e" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">链外可验证随机函数</h1><p id="e505" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated"><strong class="is hu">优点</strong></p><ul class=""><li id="21da" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll dt translated">比伪随机数更安全</li><li id="53ef" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn li lj lk ll dt translated">可以在多个区块链上工作</li></ul><p id="319e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">缺点</strong></p><ul class=""><li id="553d" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll dt translated">可能需要持有和使用他们的本地令牌。</li></ul><p id="cbc1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">概述</strong></p><p id="3966" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Chainlink是一个解决方案，它使用oracles的外链来产生随机性。这种技术用于dApps，如PoolTogether。获胜者是随机挑选的，以赢得奖品。因为随机性等同于大量的金钱，所以拥有真正的(而不是伪)随机性是很重要的。</p><div class="mf mg fm fo mh mi"><a href="https://docs.chain.link/docs/vrf/v2/introduction/" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab ej"><div class="mk ab ml cl cj mm"><h2 class="bd hu fv z el mn eo ep mo er et hs dt translated">链环VRF</h2><div class="mq l"><p class="bd b gc z el mn eo ep mo er et ek translated">doc . chain . link</p></div></div><div class="mu l"><div class="na l mw mx my mu mz jy mi"/></div></div></a></div><h1 id="e147" class="ka kb ht bd kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx dt translated">提交显示随机性</h1><p id="8c5a" class="pw-post-body-paragraph iq ir ht is b it ky iv iw ix kz iz ja jb la jd je jf lb jh ji jj lc jl jm jn hm dt translated"><strong class="is hu">优点</strong></p><ul class=""><li id="5655" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll dt translated">适用于所有EVM，并且是安全的</li></ul><p id="a198" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">缺点</strong></p><ul class=""><li id="25ae" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn li lj lk ll dt translated">请求两个交易</li></ul><p id="7205" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">另一种技术是使用commit reveal生成一个随机数。</p><p id="b13f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">步骤</strong></p><ol class=""><li id="3489" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn nb lj lk ll dt translated">用户离线生成一个前映像(编号),然后<em class="lv">提交</em>哈希</li><li id="7614" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn nb lj lk ll dt translated">智能合同将哈希保存在链上</li><li id="6a8e" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn nb lj lk ll dt translated">用户至少等待一个程序块</li><li id="a4ae" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn nb lj lk ll dt translated">用户显示前图像。如果前映像的哈希与保存的哈希匹配(在步骤2中)，则在链上生成一个随机数</li><li id="1217" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn nb lj lk ll dt translated">生成随机数:散列<code class="eh lr ls lt lu b">pre-image</code> + <code class="eh lr ls lt lu b">blockhash</code></li></ol><p id="39d6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">步骤(简化)</strong></p><p id="b38a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这个想法是用未来的数据来提交现在的数据。因为没有人能知道未来，所以不可能确定随机数。</p><ol class=""><li id="4cf1" class="ld le ht is b it iu ix iy jb lf jf lg jj lh jn nb lj lk ll dt translated">用户将数字<code class="eh lr ls lt lu b">111</code>保存在链上。这是无法改变的。</li><li id="4b30" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn nb lj lk ll dt translated">用户等待一个街区</li><li id="fbc3" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn nb lj lk ll dt translated">该块现在生成一个<code class="eh lr ls lt lu b">blockhash</code> <code class="eh lr ls lt lu b">222</code></li><li id="5a4e" class="ld le ht is b it lm ix ln jb lo jf lp jj lq jn nb lj lk ll dt translated">新的随机数是<code class="eh lr ls lt lu b">111 + 222 = 333</code></li></ol><p id="f1ef" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果没有等待未来的块，那么技术将类似于:<em class="lv">通过散列的伪随机数。</em></p><p id="a569" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果没有提交，用户可以等待blockhash，然后输入他们的数字来获得想要的“随机”数字:<code class="eh lr ls lt lu b">myInput + 222 = myDesiredNumber</code></p><figure class="jp jq jr js fq jt"><div class="bz el l di"><div class="mr ms l"/></div></figure><p id="1eb3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">演示</strong></p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff nc"><img src="../Images/fde5e8e94ca3c9d635faa3f3fdf5b0ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WavH85_zcq8SNTTBYnlt6g.png"/></div></div></figure><div class="mf mg fm fo mh mi"><a href="https://leon-do.github.io/commit-reveal-randomness/" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab ej"><div class="mk ab ml cl cj mm"><h2 class="bd hu fv z el mn eo ep mo er et hs dt translated">提交显示随机性</h2><div class="mp l"><h3 class="bd b fv z el mn eo ep mo er et ek translated">编辑描述</h3></div><div class="mq l"><p class="bd b gc z el mn eo ep mo er et ek translated">莱昂-多. github.io</p></div></div></div></a></div><p id="02fe" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu">来源</strong></p><div class="mf mg fm fo mh mi"><a rel="noopener follow" target="_blank" href="/gitcoin/commit-reveal-scheme-on-ethereum-25d1d1a25428"><div class="mj ab ej"><div class="mk ab ml cl cj mm"><h2 class="bd hu fv z el mn eo ep mo er et hs dt translated">以太坊上的提交揭露方案</h2><div class="mp l"><h3 class="bd b fv z el mn eo ep mo er et ek translated">隐藏动作和生成随机数</h3></div><div class="mq l"><p class="bd b gc z el mn eo ep mo er et ek translated">medium.com</p></div></div><div class="mu l"><div class="nd l mw mx my mu mz jy mi"/></div></div></a></div><blockquote class="ne"><p id="95b9" class="nf ng ht bd nh ni nj nk nl nm nn jn ek translated">交易新手？尝试<a class="ae no" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae no" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>