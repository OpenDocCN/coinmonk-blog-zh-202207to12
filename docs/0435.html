<html>
<head>
<title>HD Wallets in ethers.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ethers.js中的高清钱包</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/hd-wallets-in-ethers-js-e173190e4858?source=collection_archive---------0-----------------------#2022-07-09">https://medium.com/coinmonks/hd-wallets-in-ethers-js-e173190e4858?source=collection_archive---------0-----------------------#2022-07-09</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/60bc56ce344eadbd56649c9e5be3c8cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQuXq1EgIzSx5GAmm0Iknw.jpeg"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">Photo by <a class="ae jf" href="https://unsplash.com/@emkal?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Emil Kalibradov</a> on <a class="ae jf" href="https://unsplash.com/s/photos/wallet?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="cb6c" class="jg jh ht bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated">什么是高清钱包？</h1><p id="4b02" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">分层确定性钱包是很多区块链的钱包标准，如比特币、以太坊等。首先，让我们理解这些术语的含义，然后看看我们如何使用<strong class="kg hu"> ethers.js </strong>库来创建和操作这些钱包。</p><p id="12f4" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">钱包，在区块链，是一个相当模糊的术语。它通常用于指定管理公钥-私钥对的软件。一开始，钱包创建并管理一组不相关的密钥对。这种钱包被称为JBOX(只是一串钥匙)。</p><p id="6a64" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">不再推荐这种类型的钱包，因为用户必须备份一组私钥，每个地址(帐户)一个。几经提议，确定性钱包成为标准。他们能够从单个种子生成密钥对的集合。</p><p id="3278" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">使用确定性钱包，用户只需要保存种子，因为从那里钱包能够恢复所有账户的所有密钥。确定性钱包的密钥以分层的方式、以树状关系生成，被称为<strong class="kg hu">分层确定性钱包</strong>，或HD钱包。</p><p id="e39d" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">另一个值得一提的重要标准是<strong class="kg hu"> BIP-39 </strong>，它从包含2048个单词的字典中选择12到24个单词来生成种子。这样，不用把种子记成一个64字节的数字，记住一个单词序列就够了。</p><blockquote class="lh li lj"><p id="139d" class="ke kf lk kg b kh lc kj kk kl ld kn ko ll le kr ks lm lf kv kw ln lg kz la lb hm dt translated">交易新手？尝试<a class="ae jf" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae jf" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote><h1 id="4996" class="jg jh ht bd ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd dt translated">使用ethers.js</h1><p id="66e4" class="pw-post-body-paragraph ke kf ht kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb hm dt translated">为了随机创建一个新的钱包，我们使用了<strong class="kg hu"> ethers的<strong class="kg hu"> createRandom() </strong>函数。钱包</strong>对象，如下:</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="dbb4" class="lx jh ht lt b fv ly lz l ma mb">const wallet = ethers.Wallet.createRandom()</span></pre><p id="9eaa" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">12个单词的集合也称为助记码，可以使用以下属性恢复:</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="0903" class="lx jh ht lt b fv ly lz l ma mb">const words = wallet.mnemonic.phrase</span></pre><p id="01e2" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">从这12个字中，可以通过应用哈希函数PBKDF2 HMAC-SHA-512来计算种子，从而生成一个64字节的数。没有必要保存种子，因为它来自助记码，但是为了完整起见，我们将在这里计算它并在控制台上显示它:</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="4b70" class="lx jh ht lt b fv ly lz l ma mb">console.log(ethers.utils.mnemonicToSeed(words))</span></pre><p id="914f" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">让我们看看目前为止的代码:</p><figure class="lo lp lq lr fq iu fe ff paragraph-image"><div class="fe ff mc"><img src="../Images/8323eaffe9d3d7c4b03f1b00974f869c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*DJOwiR1TysI6cxphF3YGrw.png"/></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">I’m using node.js in VS Code.</figcaption></figure><p id="2951" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">为了从种子中生成帐户集，我们使用了<strong class="kg hu"> ethers.utils.HDNode </strong>对象。主节点按如下方式生成:</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="97b3" class="lx jh ht lt b fv ly lz l ma mb">let node = ethers.utils.HDNode.fromMnemonic(words)</span></pre><p id="bb39" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">然而，这不是通常生成钱包中的第一个帐户的节点。我们需要在节点树中指出我们想要的路径。让我们快速看一下Ganache的主屏幕，这是以太坊网络的测试区块链。</p><figure class="lo lp lq lr fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff md"><img src="../Images/e902dd3a9a82283df4908fcd15689e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zkxRUWT3EoviGjFmGbTwvQ.png"/></div></div><figcaption class="jb jc fg fe ff jd je bd b be z ek">A screenshot from Ganache.</figcaption></figure><p id="fb67" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">你有没有注意到，在助记码的右边，有一个路径的指示？它是以太坊网络HD钱包的默认路径，其中的账户遵循一个数字索引，从“m/44'/60'/0'/0/0”的最后一个零开始。也就是说，第一个帐户的路径是“m/44'/60'/0'/0/0”。第二个账号有路径“m/44'/60'/0'/0/1”等。</p><p id="2d78" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">要使用ethers.js生成这两个帐户，可以使用:</p><pre class="lo lp lq lr fq ls lt lu lv aw lw dt"><span id="dae5" class="lx jh ht lt b fv ly lz l ma mb">let account1 = node.derivePath("m/44'/60'/0'/0/0") <br/>let account2 = node.derivePath("m/44'/60'/0'/0/1")</span></pre><p id="72ed" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">我们刚刚在指定的路径中创建了两个帐户。通过修改路径，我们可以在树形结构中创建几个帐户。完整的代码可以在下图中看到:</p><figure class="lo lp lq lr fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff me"><img src="../Images/0f968b94fcfd96f7cb0d597fc588f5ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fSqAvMI2OAWaXfpVNfUzHQ.png"/></div></div></figure><p id="f43c" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">代码生成的结果可以在下图中看到:</p><figure class="lo lp lq lr fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mf"><img src="../Images/a0e0d3cbf412636fef44fc900491e861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hdmveJCBW-u5Tb0AjLrKyQ.png"/></div></div></figure><p id="c94e" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated">通过这种方式，我们看到了如何使用ethers.js来创建分层确定的钱包并使用它们生成帐户。</p><p id="dacf" class="pw-post-body-paragraph ke kf ht kg b kh lc kj kk kl ld kn ko kp le kr ks kt lf kv kw kx lg kz la lb hm dt translated"><strong class="kg hu">感谢阅读！</strong></p></div></div>    
</body>
</html>