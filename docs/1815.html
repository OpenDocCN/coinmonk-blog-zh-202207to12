<html>
<head>
<title>Deploy Solidity Contract using GoLang — Go-Simple-Storage-FCC</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GoLang-Go-Simple-Storage-FCC部署可靠性合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/deploy-solidity-contract-using-golang-go-simple-storage-fcc-b247b29ffa18?source=collection_archive---------2-----------------------#2022-08-06">https://medium.com/coinmonks/deploy-solidity-contract-using-golang-go-simple-storage-fcc-b247b29ffa18?source=collection_archive---------2-----------------------#2022-08-06</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="e27b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我最近开始学习区块链是从一个令人惊叹的<a class="ae jo" href="https://www.youtube.com/watch?v=gyMwXuJrbJQ" rel="noopener ugc nofollow" target="_blank">教程</a>By<a class="jp jq gr" href="https://medium.com/u/8b318225c16a?source=post_page-----b247b29ffa18--------------------------------" rel="noopener" target="_blank">freeCodeCamp</a>&amp;<a class="jp jq gr" href="https://medium.com/u/589c510eb216?source=post_page-----b247b29ffa18--------------------------------" rel="noopener" target="_blank">Patrick Collins</a>。我觉得这是免费提供的关于区块链可靠性的最好的最新教程。它从区块链基础开始，然后解释了solidity契约和使用NodeJS后端进行部署。</p><p id="79c9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">作为一名golang开发者，我想用Golang而不是nodeJs来使用相同的solidity契约。猜猜以太坊golang客户端有什么强大的支持你可以在这里找到<a class="ae jo" href="https://geth.ethereum.org/" rel="noopener ugc nofollow" target="_blank">https://geth.ethereum.org/</a></p><p id="817c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我将使用<a class="ae jo" href="https://github.com/smartcontractkit/full-blockchain-solidity-course-js#lesson-5-ethersjs-simple-storage" rel="noopener ugc nofollow" target="_blank">第5章EtherJs简单存储</a>中的契约。将重用相同的合同&amp;部署在golang后端。</p><h1 id="a117" class="jr js ht bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">装置</h1><ul class=""><li id="fb83" class="kp kq ht is b it kr ix ks jb kt jf ku jj kv jn kw kx ky kz dt translated">戈朗<a class="ae jo" href="https://go.dev/dl/" rel="noopener ugc nofollow" target="_blank">https://go.dev/dl/</a></li><li id="9801" class="kp kq ht is b it la ix lb jb lc jf ld jj le jn kw kx ky kz dt translated">solidity<a class="ae jo" href="https://docs.soliditylang.org/en/v0.8.2/installing-solidity.html" rel="noopener ugc nofollow" target="_blank">https://docs . solidity lang . org/en/v 0 . 8 . 2/installing-solidity . html</a></li><li id="cefa" class="kp kq ht is b it la ix lb jb lc jf ld jj le jn kw kx ky kz dt translated">Go以太坊客户端也称为geth<a class="ae jo" href="https://geth.ethereum.org/docs/install-and-build/installing-geth" rel="noopener ugc nofollow" target="_blank">https://geth . ether eum . org/docs/install-and-build/installing-geth</a></li><li id="eac6" class="kp kq ht is b it la ix lb jb lc jf ld jj le jn kw kx ky kz dt translated">加纳切要跑https://trufflesuite.com/ganache/当地的区块链<a class="ae jo" href="https://trufflesuite.com/ganache/" rel="noopener ugc nofollow" target="_blank"/></li></ul><h1 id="25fd" class="jr js ht bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated"><strong class="ak">编码</strong></h1><p id="7b5b" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">创建一个项目目录，并将其初始化为go模块</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="3355" class="lr js ht ln b fv ls lt l lu lv">mkdir go-simple-storage-fcc<br/>cd go-simple-storage-fcc</span></pre><p id="9d25" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用go mod命令初始化项目</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="4599" class="lr js ht ln b fv ls lt l lu lv">go mod github.com/kunalrsagar/go-simple-storage-fcc</span></pre><p id="088f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在你喜欢的IDE中打开目录，创建一个新的文件名<code class="eh lw lx ly ln b">SimpleStorage.sol</code></p><figure class="li lj lk ll fq lz"><div class="bz el l di"><div class="ma mb l"/></div></figure><p id="a6c2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这与Patrick解释的Solidity契约相同，它维护一个人员列表和他们最喜欢的号码，还具有存储和检索单个favorite Number的功能。</p><p id="ce51" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这里的主要区别是，我们将使用golang、Solidity &amp; Ethereum，而不是Node &amp; npm生态系统。这段代码是在golang 1.19，solidity 0.8.15版本上测试的。</p><h1 id="8f9f" class="jr js ht bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated"><strong class="ak">编译</strong></h1><p id="6741" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">一旦安装成功，我们将使用solc命令编译Solidity文件并生成bin和abi</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="d743" class="lr js ht ln b fv ls lt l lu lv">solc --optimize --abi --bin ./SimpleStorage.sol -o build</span></pre><p id="2745" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><code class="eh lw lx ly ln b">--optimize</code>标志是可选的，但有助于编译成高能效的二进制文件。成功完成后，应该会在构建目录中生成abi和bin文件。</p><p id="a040" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">使用geth client的主要区别是提供了一个使用abigen命令管理合同的接口。</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="0f46" class="lr js ht ln b fv ls lt l lu lv">mkdir api</span></pre><p id="f8d9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">创建一个目录名api</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="4dde" class="lr js ht ln b fv ls lt l lu lv">abigen --abi=./build/SimpleStorage.abi --bin=./build/SimpleStorage.bin --pkg=api --out=./api/SimpleStorage.go</span></pre><p id="4e6d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">上面的命令接收bin和abi文件，并生成一个Go文件<code class="eh lw lx ly ln b">SimpleStorage.go</code>,其中定义了一个接口来创建、访问和管理契约的功能。这是一个自动生成的文件，不应编辑。</p><p id="9662" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在依赖项下添加</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="cf49" class="lr js ht ln b fv ls lt l lu lv">go get github.com/ethereum/go-ethereum</span></pre><p id="ea9a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您在相关/间接依赖关系中遇到一些错误，请运行以下命令</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="f04e" class="lr js ht ln b fv ls lt l lu lv">go get all</span></pre><h1 id="84f4" class="jr js ht bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated"><strong class="ak">加纳切</strong></h1><p id="6fc4" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">让我们确保Ganache正在运行，并从中复制任何钱包的RPC Url和私钥。帕特里克对此做了详细解释。</p><figure class="li lj lk ll fq lz fe ff paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="fe ff mc"><img src="../Images/5cc4bfbb181d310a2490906a4eb713ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jRMXn10vKq80MT7ADC2Jkg.png"/></div></div><figcaption class="mj mk fg fe ff ml mm bd b be z ek">Ganache Desktop app on macOS</figcaption></figure><h1 id="599a" class="jr js ht bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated"><strong class="ak">环境变量</strong></h1><p id="274d" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">在使用终端时，将钱包的RPC_URL &amp; PRIVATE_KEY设置为环境变量。</p><pre class="li lj lk ll fq lm ln lo lp aw lq dt"><span id="46e9" class="lr js ht ln b fv ls lt l lu lv">export RPC_URL=&lt;local_ganache_url:port&gt;</span><span id="d621" class="lr js ht ln b fv mn lt l lu lv">export PRIVATE_KEY=&lt;Wallet Private key&gt;</span></pre><p id="32ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">点击Ganache应用程序中任何钱包地址上的密钥图标，即可找回钱包私钥</p><h1 id="d5a8" class="jr js ht bd jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dt translated">部署.开始</h1><p id="639f" class="pw-post-body-paragraph iq ir ht is b it kr iv iw ix ks iz ja jb lf jd je jf lg jh ji jj lh jl jm jn hm dt translated">这里是我们创建一个基于Go的后端，我们将创建一个<code class="eh lw lx ly ln b">deploy.go</code>。该文件将main函数作为入口点。</p><figure class="li lj lk ll fq lz"><div class="bz el l di"><div class="ma mb l"/></div></figure><p id="aba9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">ethclient使用RPC_URL连接到区块链网络。我们将通过从环境变量中传递实际的PRIVATE_KEY值来创建ECDSA私钥。</p><p id="98fc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将使用<code class="eh lw lx ly ln b">Public()</code>函数从私钥中提取公钥，我们需要它以ECSDA格式用于geth。</p><p id="f0d7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以同样的方式，提取钱包的地址和chainID。</p><p id="b620" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来，我们将需要手动创建一个<strong class="is hu">事务Opts，它将拥有一组授权数据(由块的作者签名)来创建一个有效的以太坊事务</strong>。</p><figure class="li lj lk ll fq lz"><div class="bz el l di"><div class="ma mb l"/></div></figure><p id="7e9d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后，我们将在chainID之后调用主函数中的<code class="eh lw lx ly ln b">GenNextTransaction()</code>函数，并部署我们的契约。</p><figure class="li lj lk ll fq lz"><div class="bz el l di"><div class="ma mb l"/></div></figure><p id="3e24" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们试着运行<code class="eh lw lx ly ln b">deploy.go</code></p><figure class="li lj lk ll fq lz fe ff paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="fe ff mo"><img src="../Images/91e7664851cefb7393750d819f5ffd3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*glx05PLGICvB1Jc13gnFpA.png"/></div></div></figure><p id="7dc3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你看到上面👏🏻作品！🥳</p><p id="0612" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">接下来，我们将调用SimpleStorage契约的检索和存储函数。您可以使用<code class="eh lw lx ly ln b">simpleStorageApi</code>对象访问所有合同功能以及一些其他功能。</p><figure class="li lj lk ll fq lz"><div class="bz el l di"><div class="ma mb l"/></div></figure><p id="8778" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们再运行一次，现在你应该看到0是你最喜欢的数字。这是围棋中的一种<code class="eh lw lx ly ln b">*big.Int</code>。</p><figure class="li lj lk ll fq lz fe ff paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="fe ff mo"><img src="../Images/954d4c1820df9aed3fd83d26d7c773e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_Y_ClzhYGPjoz7H6j7sjJw.png"/></div></div></figure><p id="62b8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">最后，让我们通过调用SimpleStorage contract的Store函数来设置一个新的favorite number，因为它<strong class="is hu">不是一个Gas-free函数</strong>，我们将调用<code class="eh lw lx ly ln b">GetNextTransaction</code>函数来获得一个授权的事务Ops。</p><p id="52c8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">然后我们调用simpleStorageApi。用<code class="eh lw lx ly ln b">big.NewInt(20)</code>存储功能</p><figure class="li lj lk ll fq lz"><div class="bz el l di"><div class="ma mb l"/></div></figure><p id="facd" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">您应该会看到类似这样的输出。恭喜您，您刚刚使用golang部署了智能合同</p><figure class="li lj lk ll fq lz fe ff paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="fe ff mp"><img src="../Images/25de57aafb4357f9a9a5db9785c7a80d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kV7tXCJ6sAJ-AQpf-cjI0A.png"/></div></div></figure><p id="a5a9" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">下面是<code class="eh lw lx ly ln b">deploy.go</code>的完整源代码</p><figure class="li lj lk ll fq lz"><div class="bz el l di"><div class="ma mb l"/></div></figure><p id="0985" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Github回购👇🏻</p><div class="mq mr fm fo ms mt"><a href="https://github.com/kunalrsagar/go-simple-storage-fcc" rel="noopener  ugc nofollow" target="_blank"><div class="mu ab ej"><div class="mv ab mw cl cj mx"><h2 class="bd hu fv z el my eo ep mz er et hs dt translated">GitHub-kunalsagar/go-Simple-Storage-FCC:基于GoLang的简单存储合同，开发于…</h2><div class="na l"><h3 class="bd b fv z el my eo ep mz er et ek translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nb l"><p class="bd b gc z el my eo ep mz er et ek translated">github.com</p></div></div><div class="nc l"><div class="nd l ne nf ng nc nh mh mt"/></div></div></a></div><p id="4e91" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">参考</p><ul class=""><li id="7b78" class="kp kq ht is b it iu ix iy jb ni jf nj jj nk jn kw kx ky kz dt translated">围棋以太坊书—<a class="ae jo" href="https://goethereumbook.org/en/" rel="noopener ugc nofollow" target="_blank">https://goethereumbook.org/en/</a></li><li id="e933" class="kp kq ht is b it la ix lb jb lc jf ld jj le jn kw kx ky kz dt translated">学习区块链、可靠性和使用JavaScript的全栈Web3开发— 32小时课程—<a class="ae jo" href="https://www.youtube.com/watch?v=gyMwXuJrbJQ" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=gyMwXuJrbJQ</a></li><li id="850b" class="kp kq ht is b it la ix lb jb lc jf ld jj le jn kw kx ky kz dt translated"><a class="ae jo" href="https://towardsdev.com/creating-a-simple-ethereum-smart-contract-in-golang-138b9439f64e" rel="noopener ugc nofollow" target="_blank">https://towardsdev . com/creating-a-simple-ether eum-smart-contract-in-golang-138 b 9439 f 64 e</a></li></ul><blockquote class="nl"><p id="70fb" class="nm nn ht bd no np nq nr ns nt nu jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="a8f7" class="jr js ht bd jt ju jv jw jx jy jz ka kb kc nv ke kf kg nw ki kj kk nx km kn ko dt translated">另外，阅读</h1><ul class=""><li id="9681" class="kp kq ht is b it kr ix ks jb kt jf ku jj kv jn kw kx ky kz dt translated"><a class="ae jo" href="https://coincodecap.com/huobi-crypto-trading-signals" rel="noopener ugc nofollow" target="_blank">火币加密交易信号</a> | <a class="ae jo" rel="noopener" href="/coinmonks/swapzone-review-crypto-exchange-data-aggregator-e0ad78e55ed7"> Swapzone审查</a></li><li id="671d" class="kp kq ht is b it la ix lb jb lc jf ld jj le jn kw kx ky kz dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">最佳加密交易机器人</a> | <a class="ae jo" href="https://coincodecap.com/buy-solana" rel="noopener ugc nofollow" target="_blank">购买索拉纳</a> | <a class="ae jo" href="https://coincodecap.com/matrixport-review" rel="noopener ugc nofollow" target="_blank">矩阵导出评论</a></li><li id="c36a" class="kp kq ht is b it la ix lb jb lc jf ld jj le jn kw kx ky kz dt translated"><a class="ae jo" href="https://coincodecap.com/coldcard-review" rel="noopener ugc nofollow" target="_blank"> Coldcard评论</a> | <a class="ae jo" href="https://coincodecap.com/boxtradex-review" rel="noopener ugc nofollow" target="_blank"> BOXtradEX评论</a>|<a class="ae jo" href="https://coincodecap.com/uniswap" rel="noopener ugc nofollow" target="_blank">uni swap指南</a></li><li id="f2b4" class="kp kq ht is b it la ix lb jb lc jf ld jj le jn kw kx ky kz dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/coinbase-review-6ef4e0f56064">比特币基地评论</a> | <a class="ae jo" rel="noopener" href="/coinmonks/deribit-review-options-fees-apis-and-testnet-2ca16c4bbdb2">德里比特评论</a> | <a class="ae jo" rel="noopener" href="/coinmonks/ftx-crypto-exchange-review-53664ac1198f"> FTX评论</a></li><li id="5216" class="kp kq ht is b it la ix lb jb lc jf ld jj le jn kw kx ky kz dt translated"><a class="ae jo" href="https://coincodecap.com/coinmetro-review" rel="noopener ugc nofollow" target="_blank"> Coinmetro评论</a> | <a class="ae jo" href="https://coincodecap.com/virgocx-review" rel="noopener ugc nofollow" target="_blank"> VirgoCX评论</a></li></ul></div></div>    
</body>
</html>