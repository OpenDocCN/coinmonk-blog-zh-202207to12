<html>
<head>
<title>Part 2: Building a Complete API in Go to Interact with a P2P Escrow Smart Contract using go-ethereum Client &amp; GoFiber Framework</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ç¬¬2éƒ¨åˆ†:åœ¨Goä¸­æ„å»ºä¸€ä¸ªå®Œæ•´çš„APIï¼Œä½¿ç”¨go-ethereumå®¢æˆ·ç«¯å’ŒGoFiberæ¡†æ¶ä¸P2Pæ‰˜ç®¡æ™ºèƒ½å¥‘çº¦è¿›è¡Œäº¤äº’</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://medium.com/coinmonks/part-2-building-a-complete-api-in-go-to-interact-with-a-p2p-escrow-smart-contract-using-fa0514531032?source=collection_archive---------21-----------------------#2022-12-11">https://medium.com/coinmonks/part-2-building-a-complete-api-in-go-to-interact-with-a-p2p-escrow-smart-contract-using-fa0514531032?source=collection_archive---------21-----------------------#2022-12-11</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/094b4b7854f4ce57afc59360ad582edf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5a1o8w31T-WzODa3Su3FcQ.png"/></div></div></figure><p id="2327" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™æ˜¯æœ¬ç³»åˆ—ä¸¤ç¯‡æ–‡ç« çš„ç¬¬äºŒéƒ¨åˆ†</p><ul class=""><li id="45ff" class="jz ka ht jd b je jf ji jj jm kb jq kc ju kd jy ke kf kg kh dt translated"><a class="ae ki" rel="noopener" href="/coinmonks/part-1-building-a-complete-api-in-go-to-interact-with-a-p2p-escrow-smart-contract-using-9cf1f681c860">ç¬¬1éƒ¨åˆ†:é¡¹ç›®æ¦‚è¿°ã€è®¾ç½®çº¤ç¨‹ã€ç”ŸæˆGoç»‘å®šã€éƒ¨ç½²åˆåŒã€æ·»åŠ getæ‰˜ç®¡&amp;é’±åŒ…é€»è¾‘åœ°å€ç«¯ç‚¹</a></li><li id="cf43" class="jz ka ht jd b je kj ji kk jm kl jq km ju kn jy ke kf kg kh dt translated">ç¬¬2éƒ¨åˆ†:æ·»åŠ å’Œæ€»ç»“P2P APIç«¯ç‚¹</li></ul><p id="e129" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä½ å¯ä»¥åœ¨GitHubçš„<a class="ae ki" href="https://github.com/alofeoluwafemi/-smart-contract-api-go-ethereum" rel="noopener ugc nofollow" target="_blank">è¿™é‡Œæ‰¾åˆ°ä»£ç åº“ä½œä¸ºå‚è€ƒã€‚</a></p><p id="9a4a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™é‡Œæ˜¯API Postmané›†åˆ<a class="ae ki" href="https://www.getpostman.com/collections/362a5590ccf482592588" rel="noopener ugc nofollow" target="_blank">é“¾æ¥</a>ä¾›ä½ å¯¼å…¥ã€‚</p><h1 id="5371" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">P2Pè®¢å•ç½‘é¡µæŒ‚é’©</h1><h1 id="5f2d" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">è®¾ç½®USDCåœ°å€</h1><p id="0d27" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">åœ¨æœ¬æ–‡çš„ç¬¬ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬éƒ¨ç½²äº†ä¸€ä¸ªUSDCå¥‘çº¦ï¼Œæˆ‘æåˆ°è¿‡å®ƒæ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿçš„USDCï¼Œåœ¨æˆ‘ä»¬çš„P2Pç³»ç»Ÿä¸­ç”¨ä½œå¯¹æŠ—Fiatçš„äº¤æ¢æ‰‹æ®µã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬ä¼šå°†åœ°å€æ›´æ”¹ä¸ºä»¥å¤ªåŠæˆ–æˆ–æˆ´ä¸Šä½¿ç”¨çš„å®é™…åœ°å€ï¼Œæ— è®ºå“ªç§ç¨³å®šçš„è´§å¸é€‚åˆæˆ‘ä»¬çš„ç›®çš„ã€‚</p><p id="0143" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€åšçš„ï¼Œé¦–å…ˆåœ¨<code class="eh lr ls lt lu b">api_router.go</code>æ–‡ä»¶ä¸­æ·»åŠ ä¸€æ¡è·¯çº¿æ¥è®¾ç½®USDCã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="12b0" class="md kp ht lu b be me mf l mg mh">escrow := api.Group("/escrow")<br/><br/>escrow.Post("/set-usdc-address", controllers.SetUSDCTokenAddress)</span></pre><p id="4e57" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨æ§åˆ¶å™¨åŒ…ä¸­ï¼Œåˆ›å»º<code class="eh lr ls lt lu b">escrow_controllers.go</code>æ¥ä¿å­˜ä¸æ‰˜ç®¡åˆåŒç›¸å…³çš„åŠ¨ä½œçš„æ§åˆ¶å™¨æ–¹æ³•ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="38c7" class="md kp ht lu b be me mf l mg mh">package controllers<br/><br/>import (<br/>	"github.com/alofeoluwafemi/go-ethereum-api/pkg/blockchain"<br/>	"github.com/gofiber/fiber/v2"<br/>)<br/><br/>func SetUSDCTokenAddress(c *fiber.Ctx) error {<br/>	conn := blockchain.CurrentConnection<br/>	type Request struct {<br/>		Address string `json:"address"`<br/>	}<br/><br/>	request := new(Request)<br/><br/>	if err := c.BodyParser(request); err != nil {<br/>		return c.Status(fiber.StatusBadRequest).JSON(fiber.Map{<br/>			"status":  "error",<br/>			"message": "Malformed data",<br/>			"data":    err,<br/>		})<br/>	}<br/><br/>	err := conn.SetUSDCAddress(request.Address)<br/><br/>	if err != nil {<br/>		return c.Status(fiber.StatusUnauthorized).JSON(fiber.Map{<br/>			"status":  "error",<br/>			"message": err,<br/>			"data":    nil,<br/>		})<br/>	}<br/><br/>	return c.Status(fiber.StatusOK).JSON(fiber.Map{<br/>		"status": "success",<br/>		"data":   request.Address,<br/>	})<br/>}</span></pre><p id="795a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æœ€åï¼Œåœ¨åŒºå—é“¾åŒ…ä¸­ï¼Œæ·»åŠ ä¸€ä¸ªæ–°æ–‡ä»¶<code class="eh lr ls lt lu b">escrow.go</code>ï¼Œå¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="be90" class="md kp ht lu b be me mf l mg mh">package blockchain<br/><br/>import (<br/>	"github.com/alofeoluwafemi/go-ethereum-api/pkg/ethereum"<br/>	"github.com/ethereum/go-ethereum/common"<br/>	"log"<br/>)<br/><br/>var EscrowInstance *Escrow<br/><br/>const (<br/>	EscrowAddress = "0xd27adc3848dE1324AF87e5C235355e4a017Aa1CF"<br/>)<br/><br/>type Escrow struct {<br/>	Address  common.Address<br/>	Instance *ethereum.Escrow<br/>}<br/><br/>func (clientCon ClientConnection) newEscrow(address string) *ethereum.Escrow {<br/>	EscrowInstance = new(Escrow)<br/><br/>	contractAddress := common.HexToAddress(address)<br/><br/>	EscrowInstance.Address = contractAddress<br/><br/>	instance, err := ethereum.NewEscrow(contractAddress, clientCon.Client)<br/>	if err != nil {<br/>		log.Fatalln("Cannot get Factory contract at address ", address, " due to: ", err)<br/>	}<br/><br/>	return instance<br/>}<br/><br/>func (clientCon ClientConnection) SetUSDCAddress(address string) error {<br/><br/>	_, err := getEscrow().SetUsdcTokenAddress(clientCon.trxOpts, common.HexToAddress(address))<br/><br/>	if err != nil {<br/>		log.Printf("Cannot set new USDC token on Escrow due to: %v", err)<br/><br/>		return err<br/>	}<br/><br/>	return nil<br/>}<br/><br/>func getEscrow() *ethereum.Escrow {<br/>	return CurrentConnection.newEscrow(EscrowAddress)<br/>}</span></pre><p id="cf8f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™ä¸éœ€è¦æ›´å¤šçš„è§£é‡Šï¼Œå› ä¸ºå®ƒä¸æˆ‘ä»¬ä¹‹å‰éµå¾ªçš„æ ¼å¼ç›¸åŒã€‚å¦‚æœæ‚¨è¿˜æ²¡æœ‰é˜…è¯»æœ¬ç³»åˆ—çš„ç¬¬1éƒ¨åˆ†ï¼Œæˆ‘å»ºè®®æ‚¨é˜…è¯»ä¸€ä¸‹ã€‚</p><p id="ac9d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">é‡å¯FiberæœåŠ¡å™¨ï¼Œåœ¨Postmanä¸­å‘<a class="ae ki" href="http://127.0.0.1:3000/api/v1/escrow/set-usdc-address" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/escrow/set-usdc-address</a>å‘å‡ºPOSTè¯·æ±‚ï¼Œå·¥å‚å¥‘çº¦å°†è¢«éƒ¨ç½²ã€‚</p><p id="b4aa" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">æˆåŠŸAPIè°ƒç”¨</strong></p><figure class="lv lw lx ly fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mi"><img src="../Images/d143ca7bb1e0cecac82b6d5d3df6ebe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7uLeDYbttPKWJrZZ.png"/></div></div></figure><p id="22d0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">é”™è¯¯APIè°ƒç”¨</strong></p><p id="c3a3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™å°†åœ¨æ‚¨å‘ä½¿ç”¨ç›¸åŒnonceçš„APIå‘å‡ºç¬¬äºŒä¸ªè¯·æ±‚åç«‹å³å‘ç”Ÿã€‚</p><figure class="lv lw lx ly fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mj"><img src="../Images/3975c0e07fa2286c7bdd56f287d75a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*rBdgkri1P5CbSCbi.png"/></div></div></figure><h1 id="1b02" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">åˆ›å»ºä¿ç®¡äººé’±åŒ…</h1><p id="b7f4" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">æˆ‘ä»¬å°†åˆ›å»ºçš„ä¸‹ä¸€ä¸ªè·¯ç”±æ˜¯<code class="eh lr ls lt lu b">/api/v1/factory/new-wallet/:uuid</code>ï¼Œè¿™æ ·å½“æˆ‘ä»¬å‘è¿™ä¸ªç«¯ç‚¹å‘å‡ºPOSTè¯·æ±‚æ—¶ï¼Œå®ƒå°†è°ƒç”¨å·¥å‚å¥‘çº¦ä¸Šçš„å‡½æ•°<code class="eh lr ls lt lu b">newCustodian</code>ã€‚è¿™å°†éƒ¨ç½²ä¸€ä¸ªåä¸º<code class="eh lr ls lt lu b">CustodianWalletProxy</code>çš„ä»£ç†å¥‘çº¦ï¼Œå°†è°ƒç”¨å§”æ‰˜ç»™<code class="eh lr ls lt lu b">CustodianWalletLogic</code>ã€‚</p><p id="3ea7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">é¦–å…ˆï¼Œåƒå¾€å¸¸ä¸€æ ·ã€‚å°†è·¯çº¿æ·»åŠ åˆ°<code class="eh lr ls lt lu b">api_router.go</code>ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="30ee" class="md kp ht lu b be me mf l mg mh">api.Post("/factory/new-wallet/:uuid", controllers.NewWallet)</span></pre><p id="7b08" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ¥ä¸‹æ¥æ˜¯æ§åˆ¶å™¨ï¼Œè¿™æ¬¡æ˜¯åœ¨<code class="eh lr ls lt lu b">factory_controller</code>æ–‡ä»¶ä¸­ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="42ee" class="md kp ht lu b be me mf l mg mh">func NewWallet(c *fiber.Ctx) error {<br/>	conn := blockchain.CurrentConnection<br/>	uuid := c.Params("uuid")<br/><br/>	trx, err := conn.NewWallet(uuid)<br/><br/>	if err != nil {<br/>		return c.Status(fiber.StatusUnauthorized).JSON(fiber.Map{<br/>			"status":  "error",<br/>			"message": err,<br/>			"data":    nil,<br/>		})<br/>	}<br/><br/>	return c.Status(fiber.StatusOK).JSON(fiber.Map{<br/>		"status": "success",<br/>		"hash":   trx.Hash(),<br/>	})<br/>}</span></pre><p id="01ed" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œä¸ºäº†åˆ›å»ºæ–°çš„é’±åŒ…ï¼Œæ™ºèƒ½å¥‘çº¦éœ€è¦ä¸€ä¸ªæƒŸä¸€çš„æ ‡è¯†ç¬¦æ¥å°†å…¶ä¿å­˜åœ¨æ§åˆ¶å™¨é€šè¿‡URLå‚æ•°æ¥å—çš„æ˜ å°„ä¸­ã€‚æ‚¨å¾ˆå¿«å°±ä¼šçœ‹åˆ°ï¼Œæ¯ä¸ªå”¯ä¸€çš„IDä¸èƒ½åˆ†é…ç»™å¦ä¸€ä¸ªç”¨æˆ·ã€‚</p><p id="d6e9" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æœ€åï¼Œå°†<code class="eh lr ls lt lu b">NewWallet</code>æ–¹æ³•æ·»åŠ åˆ°<code class="eh lr ls lt lu b">factory.go</code>æ–‡ä»¶çš„<code class="eh lr ls lt lu b">blockchain</code>åŒ…ä¸­ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="b0bf" class="md kp ht lu b be me mf l mg mh">func (clientCon ClientConnection) NewWallet(uuid string) (*types.Transaction, error) {<br/><br/>	trx, err := getFactory().NewCustodian(clientCon.trxOpts, uuid)<br/><br/>	if err != nil {<br/>		log.Printf("Cannot create new wallet: %v", err)<br/><br/>		return new(types.Transaction), err<br/>	}<br/><br/>	return trx, nil<br/>}</span></pre><p id="9f5f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åƒå¾€å¸¸ä¸€æ ·é‡æ–°å¯åŠ¨å…‰çº¤æœåŠ¡å™¨ï¼Œå¹¶å‘http://127 . 0 . 0 . 1:3000/API/v1/factory/new-wallet/CEC 3d d14-339 a-11ed-a261-0242 AC 120002å’Œ<a class="ae ki" href="http://127.0.0.1:3000/api/v1/factory/new-wallet/b93e42b0-33a2-11ed-a261-0242ac120002" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/factory/new-wallet/b 93 e 42 b 0-33 a2-11ed-a 266å‘å‡ºPOSTè¯·æ±‚è¿™å°†ä¸ºé™„åŠ åœ¨ä¸¤ä¸ªURLæœ«å°¾çš„æ¯ä¸ªUUIDåˆ›å»ºä¸€ä¸ªå¸æˆ·ã€‚</a></p><p id="c0bc" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åˆ›å»ºä¸¤ä¸ªå¸æˆ·çš„ç›®çš„æ˜¯ï¼Œå½“æˆ‘ä»¬è¿›ä¸€æ­¥åˆ›å»ºè®¢å•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªå¸æˆ·ã€‚</p><figure class="lv lw lx ly fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mj"><img src="../Images/c73ec9c1365ee075dd4976b847d3bf6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*b2lPRPT1qKWlCsTA.png"/></div></div></figure><p id="56df" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">å¦‚æœæ‚¨ä½¿ç”¨ç›¸åŒçš„UUIDé‡è¯•ï¼Œæ‚¨å°†å¾—åˆ°ä¸€ä¸ªå¸æˆ·å­˜åœ¨é”™è¯¯ã€‚</p><figure class="lv lw lx ly fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mk"><img src="../Images/d73e14b4396ffaa6ecaabcb85a4a66b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-Bji3woP_PuOXDiX.png"/></div></div></figure><h1 id="a898" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">ä½¿ç”¨UUIDè·å–é’±åŒ…åœ°å€</h1><p id="470c" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">è¿™å°†æ˜¯ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„ï¼Œæ·»åŠ ä½¿ç”¨UUIDè·å¾—é’±åŒ…åœ°å€çš„è·¯çº¿ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="11cb" class="md kp ht lu b be me mf l mg mh">api.Get("/factory/wallet/:uuid", controllers.GetWallet)</span></pre><p id="aba1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨<code class="eh lr ls lt lu b">factory_controller.go</code></p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="0992" class="md kp ht lu b be me mf l mg mh">func GetWallet(c *fiber.Ctx) error {<br/>	conn := blockchain.CurrentConnection<br/>	uuid := c.Params("uuid")<br/><br/>	address, err := conn.GetAccountByUUID(uuid)<br/><br/>	if err != nil {<br/>		return c.Status(fiber.StatusUnauthorized).JSON(fiber.Map{<br/>			"status":  "error",<br/>			"message": err,<br/>			"data":    nil,<br/>		})<br/>	}<br/><br/>	return c.Status(fiber.StatusOK).JSON(fiber.Map{<br/>		"status": "success",<br/>		"hash":   address.String(),<br/>	})<br/>}</span></pre><p id="b4d3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨åŒºå—é“¾åŒ…ä¸­ï¼Œæ·»åŠ <code class="eh lr ls lt lu b">GetAccountByUUID</code>æ–¹æ³•æ¥è°ƒç”¨å¥‘çº¦æ–¹æ³•ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="e4d5" class="md kp ht lu b be me mf l mg mh">func (clientCon ClientConnection) GetAccountByUUID(uuid string) (*common.Address, error) {<br/><br/>	address, err := getFactory().Accounts(clientCon.callOpts, uuid)<br/><br/>	if err != nil {<br/>		log.Printf("Cannot get account: %v due to error %v", uuid, err)<br/><br/>		return new(common.Address), err<br/>	}<br/><br/>	return &amp;address, nil<br/>}</span></pre><p id="9a2e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">é‡å¯æœåŠ¡å™¨å¹¶ä½¿ç”¨Postmanå‘<a class="ae ki" href="http://127.0.0.1:3000/api/v1/factory/wallet/b93e42b0-33a2-11ed-a261-0242ac120002" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/factory/wallet/b 93 e 42 b 0-33 a2-11ed-a261-0242 AC 120002</a>å‘å‡ºGETè¯·æ±‚ã€‚è®°å¾—å°†UUIDæ›´æ”¹ä¸ºæ‚¨ä¹‹å‰ä½¿ç”¨çš„é‚£ä¸ªï¼Œå¹¶æ³¨æ„è¿”å›çš„ä¸¤ä¸ªå¸æˆ·åœ°å€ã€‚</p><p id="bcd2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨æˆ‘è‡ªå·±çš„æƒ…å†µä¸‹ï¼Œæˆ‘è¿”å›çš„ä¸¤ä¸ªå¸æˆ·åœ°å€æ˜¯</p><figure class="lv lw lx ly fq iu"><div class="bz el l di"><div class="ml mm l"/></div></figure><h1 id="cfcb" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">ä¿®å¤éšæœºæ•°è¿‡ä½é”™è¯¯</h1><p id="0794" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å¯èƒ½å·²ç»é‡åˆ°äº†ä¸€ä¸ªå›å¤é”™è¯¯ï¼Œè¿”å›çš„<strong class="jd hu"> nonceå¤ªä½</strong>ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘èŠ±äº†ä¸€æ®µæ—¶é—´æ‰æ„è¯†åˆ°æˆ‘åœ¨å°†nonceè®¾ç½®ä¸ºtransacté€‰é¡¹æ—¶å¼•å…¥äº†è¿™ä¸ªé—®é¢˜ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€æ·»åŠ ä¸‹é¢çš„æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªä¼ é€’<code class="eh lr ls lt lu b">clientCon.trxOpts</code>çš„æ–¹æ³•ä¸­ï¼Œè¿™æ„å‘³ç€å®ƒæ˜¯ä¸€ä¸ªçŠ¶æ€æ”¹å˜æ–¹æ³•ï¼Œè°ƒç”¨å®ƒæ¥å¢åŠ ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„nonceã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="e1df" class="md kp ht lu b be me mf l mg mh">func (clientCon ClientConnection) postTransact() {<br/>	clientCon.trxOpts.Nonce = new(big.Int).SetUint64(clientCon.nonceAt(clientCon.SignerPublicAddress))<br/>}</span></pre><p id="dfd6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">ç”¨é€”</strong></p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="7660" class="md kp ht lu b be me mf l mg mh">func (clientCon ClientConnection) NewWallet(uuid string) (*types.Transaction, error) {<br/><br/>	trx, err := getFactory().NewCustodian(clientCon.trxOpts, uuid)<br/><br/>	if err != nil {<br/>		log.Printf("Cannot create new wallet: %v", err)<br/><br/>		return new(types.Transaction), err<br/>	}<br/><br/>	clientCon.postTransact()<br/><br/>	return trx, nil<br/>}</span></pre><h1 id="d2ba" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">å‘USDCçš„å¸æˆ·åœ°å€æä¾›èµ„é‡‘(æ¨¡æ‹Ÿ)</h1><p id="4fdd" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">æ‰“å¼€Metamaskå¹¶å•å‡»<strong class="jd hu"> import token </strong>ï¼Œè¾“å…¥å·²éƒ¨ç½²çš„USDCåœ°å€ï¼Œå¹¶ç¡®ä¿å¯¹é’±åŒ…åœ°å€æ‰§è¡Œæ­¤æ“ä½œï¼Œæ‚¨åœ¨envä¸­å°†ç§é’¥ç”¨ä½œéƒ¨ç½²è€…å¸æˆ·ã€‚æ‰€æœ‰åˆå§‹ä»¤ç‰Œéƒ½å°†åˆ†é…ç»™è¯¥å¸æˆ·ï¼Œè¯·å‚è§ä¸‹å›¾ã€‚</p><figure class="lv lw lx ly fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mn"><img src="../Images/603936da97319d3283733a16d782f480.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9rfexc1cvVCtF8Px.png"/></div></div></figure><p id="9921" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä½¿ç”¨å…ƒæ©ç ä¸ºè¿™ä¸¤ä¸ªåœ°å€åˆ†é…100ä¸ªUSDCã€‚</p><h1 id="8d79" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">æ‰“å¼€P2Pè´­ä¹°è®¢å•</h1><p id="dc29" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">è¯¥åŠŸèƒ½åœ¨é’±åŒ…åœ°å€ä¸Šç›´æ¥å¯ç”¨ã€‚è¯·è®°ä½ï¼Œæ¯ä¸ªé’±åŒ…éƒ½æ˜¯ä¸€ä¸ªæ™ºèƒ½åˆåŒï¼Œè€Œä¸æ˜¯ä½ æ‰€æœŸæœ›çš„EOAã€‚æˆ‘ä»¬çš„éƒ¨ç½²è€…å¸æˆ·æ‹¥æœ‰è¶…çº§ç®¡ç†å‘˜æƒé™æ¥è°ƒç”¨å®ƒçš„æ–¹æ³•ã€‚</p><p id="da86" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™ç§æ–¹æ³•åˆ©ç”¨äº†ä»£ç†æ¨¡å¼ï¼Œå› æ­¤ï¼Œå°†æ¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ç®€å•åœ°å‡çº§é’±åŒ…é€»è¾‘æ¥ä¸ºå·²ç»éƒ¨ç½²çš„é’±åŒ…æ·»åŠ æ›´å¤šåŠŸèƒ½ï¼Œé’±åŒ…é€»è¾‘ä¸ä¼šè‡ªè¡Œæ‰§è¡Œï¼Œè€Œæ˜¯é€šè¿‡ä½¿ç”¨å·²éƒ¨ç½²çš„é’±åŒ…ä»£ç†çš„çŠ¶æ€é€šè¿‡<code class="eh lr ls lt lu b">delegatecall</code>è°ƒç”¨å…¶åŠŸèƒ½ã€‚</p><p id="b7ed" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">æ·»åŠ è·¯çº¿</strong></p><p id="bece" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¿™é‡Œçš„<code class="eh lr ls lt lu b">:address</code>å‚æ•°æ˜¯ä¿ç®¡é’±åŒ…çš„åœ°å€ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="ab20" class="md kp ht lu b be me mf l mg mh">api.Post("/wallet/order/new/:address", controllers.NewBuyOrder)</span></pre><p id="abda" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">æ·»åŠ æ§åˆ¶å™¨çš„æ–¹æ³•</strong></p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="fbe2" class="md kp ht lu b be me mf l mg mh">func NewBuyOrder(c *fiber.Ctx) error {<br/>	conn := blockchain.CurrentConnection<br/>	request := new(blockchain.Order)<br/>	wallet := c.Params("address")<br/><br/>	blockchain.WalletAddress = wallet<br/><br/>	if err := c.BodyParser(request); err != nil {<br/>		return c.Status(fiber.StatusBadRequest).JSON(fiber.Map{<br/>			"status":  "error",<br/>			"message": "Malformed data",<br/>			"data":    err,<br/>		})<br/>	}<br/><br/>	trx, err := conn.OpenBuyOrder(*request)<br/><br/>	if err != nil {<br/>		return c.Status(fiber.StatusUnauthorized).JSON(fiber.Map{<br/>			"status":  "error",<br/>			"message": err,<br/>			"data":    nil,<br/>		})<br/>	}<br/><br/>	return c.Status(fiber.StatusOK).JSON(fiber.Map{<br/>		"status": "success",<br/>		"data":   trx.Hash(),<br/>	})<br/>}</span></pre><p id="1a03" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æœ€ååœ¨åŒºå—é“¾åŒ…è£¹çš„<code class="eh lr ls lt lu b">wallet.go</code>é‡Œé¢ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="6d20" class="md kp ht lu b be me mf l mg mh">func (clientCon ClientConnection) OpenBuyOrder(order Order) (*types.Transaction, error) {<br/><br/>	trx, err := getWalletLogic().NewBuyOrder(<br/>		clientCon.trxOpts,<br/>		common.HexToAddress(order.Seller),<br/>		common.HexToAddress(order.Receiver),<br/>		big.NewInt(order.Amount),<br/>		big.NewInt(order.Rate),<br/>		big.NewInt(order.Fee),<br/>	)<br/><br/>	if err != nil {<br/>		log.Printf("Cannot open order : %v", err)<br/><br/>		return new(types.Transaction), err<br/>	}<br/><br/>	clientCon.postTransact()<br/><br/>	return trx, nil<br/>}</span></pre><p id="14c4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä½¿ç”¨Postmanå‘<a class="ae ki" href="http://127.0.0.1:3000/api/v1/wallet/order/new/0xC1F07Db647Aa3002c12BbaF8D598F0ef19c4ddd3" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/wallet/order/new/0x C1 f 07 db 647 aa 3002 c 12 BBA F8 d 598 f 0 ef 19 C4 DDD 3</a>å‘å‡ºPOSTè¯·æ±‚å°†è¿”å›äº‹åŠ¡å“ˆå¸Œã€‚</p><p id="218c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è¯·è®°ä½ç”¨é€‚ç”¨äºæ‚¨çš„å‚æ•°æ›¿æ¢URLä¸­çš„é’±åŒ…åœ°å€å‚æ•°ã€‚</p><h1 id="3a11" class="ko kp ht bd kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll dt translated">è·å–æœªç»“è®¢å•åçš„è´¦æˆ·æ€»ä½™é¢</h1><p id="7fde" class="pw-post-body-paragraph jb jc ht jd b je lm jg jh ji ln jk jl jm lo jo jp jq lp js jt ju lq jw jx jy hm dt translated">ç»ˆäºåˆ°æœ€åä¸€ç‚¹äº†ï¼</p><p id="bab6" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">é’±åŒ…åˆåŒçš„<code class="eh lr ls lt lu b">GetTotalBalance</code>è¿”å›é’±åŒ…ä½™é¢å‡å»å½“å‰æœªå®Œæˆçš„è®¢å•ï¼Œå› æ­¤ä¸€æ—¦æˆ‘ä»¬æ‰“å¼€è®¢å•ï¼Œæˆ‘ä»¬ä¸å¸Œæœ›ä»–ä»¬èŠ±è´¹å’Œæ— æ³•å±¥è¡Œè®¢å•ã€‚</p><p id="2dd2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">æ·»åŠ è·¯çº¿</strong></p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="4cbc" class="md kp ht lu b be me mf l mg mh">api.Post("/wallet/balance/:address", controllers.GetWalletUSDCBalance)</span></pre><p id="aabb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">æ·»åŠ æ§åˆ¶å™¨æ–¹æ³•</strong></p><p id="0af7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">åœ¨<code class="eh lr ls lt lu b">wallet_controller</code>æ·»åŠ </p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="e52a" class="md kp ht lu b be me mf l mg mh">func GetWalletUSDCBalance(c *fiber.Ctx) error {  <br/>  conn := blockchain.CurrentConnection  <br/>  walletAddress := c.Params("address")  <br/>  <br/>   blockchain.WalletAddress = walletAddress  <br/>  <br/>   balance, err := conn.GetUSDCBalance()  <br/>  <br/>   if err != nil {  <br/>      return c.Status(fiber.StatusUnauthorized).JSON(fiber.Map{  <br/>         "status":  "error",  <br/>         "message": err,  <br/>         "data":    nil,  <br/>      })  <br/>   }  <br/>  <br/>  <br/>   return c.Status(fiber.StatusOK).JSON(fiber.Map{  <br/>      "status": "success",  <br/>      "data":   balance,  <br/>   })  <br/>}</span></pre><p id="fc08" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ç°åœ¨åœ¨åŒºå—é“¾åŒ…çš„<code class="eh lr ls lt lu b">wallet.go</code>ä¸­æ·»åŠ <code class="eh lr ls lt lu b">GetUSDCBalance</code>æ–¹æ³•ã€‚</p><pre class="lv lw lx ly fq lz lu ma bn mb mc bi"><span id="d891" class="md kp ht lu b be me mf l mg mh">func (clientCon ClientConnection) GetUSDCBalance() (*big.Int, error) {<br/><br/>	balance, err := getWalletLogic().GetTotalBalance(clientCon.callOpts)<br/><br/>	if err != nil {<br/>		log.Printf("Cannot open order : %v", err)<br/><br/>		return new(big.Int), err<br/>	}<br/><br/>	return balance, nil<br/>}</span></pre><p id="5c48" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">ä½¿ç”¨Postmanå‘<a class="ae ki" href="http://127.0.0.1:3000/api/v1/wallet/balance/0xC1F07Db647Aa3002c12BbaF8D598F0ef19c4ddd3" rel="noopener ugc nofollow" target="_blank">http://127 . 0 . 0 . 1:3000/API/v1/wallet/balance/0x C1 f 07 db 647 aa 3002 c 12 BBA F8 d 598 f 0 ef 19 C4 DDD 3</a>å‘å‡ºPOSTè¯·æ±‚ã€‚é’±åŒ…ä½™é¢è¢«è¿”å›ã€‚</p><p id="74e4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">æ­å–œä½ ï¼ï¼ğŸ‰ğŸ‰</p><p id="cfed" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">è°¢è°¢ä½ ä¸€ç›´å…³æ³¨æˆ‘ï¼Œå¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥ä¸ºè¿™ç¯‡æ–‡ç« é¼“æŒå¹¶è®¢é˜…æˆ‘çš„youtubeé¢‘é“æ¥æ”¯æŒæˆ‘ã€‚</p><blockquote class="mo"><p id="aa4e" class="mp mq ht bd mr ms mt mu mv mw mx jy ek translated">äº¤æ˜“æ–°æ‰‹ï¼Ÿå°è¯•<a class="ae ki" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">åŠ å¯†äº¤æ˜“æœºå™¨äºº</a>æˆ–<a class="ae ki" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">å¤åˆ¶äº¤æ˜“</a></p></blockquote></div></div>    
</body>
</html>