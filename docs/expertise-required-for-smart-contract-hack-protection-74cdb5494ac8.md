# 智能合同黑客保护所需的专业知识

> 原文：<https://medium.com/coinmonks/expertise-required-for-smart-contract-hack-protection-74cdb5494ac8?source=collection_archive---------49----------------------->

## 根据 Harbor 对黑客事件的分析，在加密货币生态系统中，截至 2022 年 11 月，对 DeFi 目标和跨链桥的黑客攻击导致超过 36 亿美元的资金被盗

智能合同已被用于供应链、众筹、知识产权和数字资产交易等其他商业领域。但是在智能合同中发现了许多安全缺陷，其中一些已经导致了巨大的经济损失。聪明的合同依赖于这样一个事实，即区块链是分散的，不能改变。这给安全研究人员提出了新的问题。

> 交易新手？在[最佳密码交易所](/coinmonks/crypto-exchange-dd2f9d6f3769)上尝试[密码交易机器人](/coinmonks/crypto-trading-bot-c2ffce8acb2a)或[复制交易](/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c)

*事实上，DeFi 和 Web 3 项目的安全性充其量是开发团队技能和黑客技能之间的微妙平衡。*

在全球范围内，认识并解决日益增多的智能合约安全问题至关重要。特别是在公共场合通过区块链或分布式账本技术与陌生人通信时。

例如，公共分类账允许你验证和信任智能合约的代码，从而实现与完全陌生的人进行交易，这在传统金融中是不可能或不可行的:

*   根据产品和服务的提供转移资金
*   如有必要，任命一个值得信赖的外部第三方作为调解人来解决争端
*   存放代币以实现借款人的贷款请求
*   存放代币以借马币
*   获得保险以降低黑客攻击和利用的风险
*   参与项目或协议的决策过程
*   令牌化资产、传统股票、商品、艺术、音乐、收藏品、贵金属、法定货币和矿物
*   为其他智能合同提供现实世界中的发现服务
*   获得无限或非常高的贷款金额，而无需提供任何抵押品

区块链本质上是安全的。鉴于接管网络和篡改块中记录的数据是多么具有挑战性，智能合约漏洞通常会引起黑客的更大兴趣。

## 是什么使智能合同容易受到网络攻击？

透明性、自主性、分布性、不变性和不信任是智能合约的一些主要特征。具有讽刺意味的是，正是因为这些品质，智能合约才成为黑客的高价值目标。

此外，黑客一直在关注“跨链桥”，这是一种使用户能够交易来自不同区块链的令牌的协议。仅在 2022 年，这些跨桥攻击给黑客带来的成本将超过 10 亿美元。

## 可升级性

智能合同不能更新，但有多种方法可以实现“可升级性”。它通过启动一个新的智能合同并指向依赖项来运行。许多智能合约通常包含在广受欢迎的 DeFi 协议中，其中大多数可能会升级。

这种类型的分散式协议的可升级性特征使其暴露于黑客可能用来对付它的许多弱点。黑客可能能够操纵全部或部分协议代码来满足他们的需求。只要有利润可赚，欺诈者就会不断想出新的方法来利用智能合同的弱点。

## 疯狂的

智能合约代码中存在的缺陷会产生一个漏洞，即使没有蓄意攻击，该漏洞也可能被利用。此外，因为这些协议中的大多数都是开源的，所以攻击者可以更容易地查看源代码以发现潜在的安全漏洞。人们不需要很长时间就能识别出代码中的一个缺陷，这将允许他们进入系统。

## 写得不好的代码

黑客攻击的最大原因之一是智能合约的代码编写不充分。大多数智能合同审计只持续很短的一段时间，审计团队最初可能甚至没有完全理解源代码。尽管需要广泛的审计，智能合同提供零安全保证。

## 不适当

黑客也可能利用团队的不称职，或极其粗心地使用密钥，作为攻击的媒介。最有可能的是，你听说过私钥黑客或破坏。但是，首先，私钥是如何被“破解”的呢？

如果您正在讨论使用私钥以编程方式签署事务，建议将私钥、访问密钥、密码和其他敏感信息保存在 secrets manager 中，而不是保存在环境变量中，这是一种很好的安全策略。一个写得很差的应用程序会主动泄露所有的应用程序秘密，即使使用了秘密管理器。如果遵循“基本的网络安全卫生”原则，一些破坏性的攻击本来是可以轻易避免的。

Harbor 的安全专家可以在安全的各个方面为您提供帮助，包括前端和后端安全、DNS 安全和智能合同评估。

在创建智能合同时，应遵循“最小特权原则”，并应使用 RBAC(基于角色的访问控制)。当您知道您的签名者密钥将在不安全的“托管”环境中使用时，请确保 wallet 对您的应用程序具有非常有限的权限。

## 矿工操纵漏洞

这是指智能合约漏洞的一大类，其中矿工试图操纵智能合约构建范围之外的变量。最终目标是改变体制，使之对他们有利。

这看起来不太可能，但是矿工确实有能力影响事务的时间戳。时间戳依赖性漏洞是一个典型的例子，在这种情况下，挖掘者可以通过利用新块添加到区块链的时间的可接受漂移或波动来更改事务的时间戳。

尽管这种变化通常不是引起警报的原因，但是这种差异仍然可能为矿工提供机会来影响正在生成的块的时间戳以对他们有利。

## 整数溢出和下溢

当算术运算的输出小于最小尺寸时，发生下溢，而当结果大于最大尺寸时，发生上溢。

汽车的里程表无法记录 999999 以上的里程数是整数溢出(6 位数)的典型例子。出现这种情况时，即使里程数实际上是 1000000，汽车的里程表也会错误地将这个新的七位数(1000000)显示为最后六位数字(000000)。

如果你不考虑溢出和下溢，你会从智能合约中得到错误的数据和意想不到的结果。这是因为您希望尽可能准确地显示数据。

当检查数千行代码时，很容易忽略这些漏洞，但这样做是至关重要的。形式验证使用数学证明来判断溢出和下溢是否会发生，这是确保代码不会发生溢出和下溢的一种方法。

## 重入攻击

恶意契约可能会在函数完成之前回调调用契约，这就是为什么智能契约攻击并不总是外部的或类似外部的。

换句话说，恶意智能协定被编码到受害者智能协定中，以便能够通过在受害者协定完成之前再次调用受害者协定(使用回退函数)或调用完全不同的函数来干扰受害者协定的初始执行。因为它在第一个调用完成之前进入了契约的另一个调用，所以它被视为可重入。

通过这种类型的缺陷，邪恶的用户或合同编写者可能会破坏受害者的智能合同的原始目的，并操纵系统以对他们有利，从而发起内部攻击。

## 逻辑错误

这指的是智能合约逻辑中的根本缺陷。这些可能是小的印刷错误或对业务假设的误解的结果。无论逻辑错误是如何产生的，它们都会对网络及其应用的安全性产生重大影响。

## 未处理的异常

在 Solidity 中，异常可能以多种不同的方式发生。但是，并不是所有的异常都以相同的方式处理。异常处理的基本构件是契约之间的交互。因此，合同可能会受到不良用户的攻击，如果这些异常没有得到正确处理，事务将会回滚。

## 不正确的 ERC-20 标准实施

众所周知的 OpenZeppelin 标准实现可用于 ERC-20 令牌。它通常是完全适用的，并且其功能对于适当的业务活动是足够的。然而，自定义令牌标准的实现有其存在的理由。

因此，最近铸造的令牌和实际的 ERC-20 标准之间的不一致是可能的。然而，经过如此小的改动，契约方法可能不再有效，因为它无法识别接口。即使这是一个小错误，它也会妨碍合同的完成，使资金冻结在生产中。

## 闪贷攻击

DeFi 中的一种无担保贷款是“闪贷”在没有抵押品的情况下，你可以借很多加密货币和代币，但你必须在同一个区块链街区内的一次交易中偿还全部金额。如果贷款没有及时偿还，整个交易就无效。加密货币交易商经常使用闪贷来利用套利(差价)机会。这个想法简单明了，可行，并通过智能合约实现自动化。

在“快速贷款攻击”中，犯罪者获得一笔快速贷款，并利用它操纵加密资产的价格，使其对自己有利。一般来说，他们通过诱导虚假抛售来实现这一点，这样他们就可以从随之而来的价格变化中赚很多钱。在 2020 年至 2022 年期间，由于对几个 DeFi 系统和应用程序的快速贷款攻击，损失了超过 3 亿美元。

## 结论

尽管有彻底的审计和其他安全预防措施，智能合同仍然容易受到许多威胁。这些漏洞可能是由不合格的编码、疏忽的软件缺陷或从依赖性到 oracle 故障等各种原因造成的，可能会导致重大的财务损失，并普遍削弱投资者的信心。

> *加入 Coinmonks* [*电报频道*](https://t.me/coincodecap) *和* [*Youtube 频道*](https://www.youtube.com/c/coinmonks/videos) *了解加密交易和投资*

# 另外，阅读

*   [Bookmap 评论](https://coincodecap.com/bookmap-review-2021-best-trading-software) | [美国 5 大最佳加密交易所](https://coincodecap.com/crypto-exchange-usa)
*   [加密交易机器人](/coinmonks/crypto-trading-bot-c2ffce8acb2a) | [造币评论](https://coincodecap.com/coingate-review)
*   最佳加密[硬件钱包](/coinmonks/hardware-wallets-dfa1211730c6) | [Bitbns 评论](/coinmonks/bitbns-review-38256a07e161)
*   [新加坡十大最佳加密交易所](https://coincodecap.com/crypto-exchange-in-singapore) | [购买 AXS](https://coincodecap.com/buy-axs-token)
*   [红狗赌场评论](https://coincodecap.com/red-dog-casino-review) | [Swyftx 评论](https://coincodecap.com/swyftx-review)