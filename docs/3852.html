<html>
<head>
<title>Offensive Smart Contract Hacking Part1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">进攻性智能合同黑客第一部分</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/offensive-smart-contract-hacking-part1-ce8da6e3c097?source=collection_archive---------1-----------------------#2022-09-19">https://medium.com/coinmonks/offensive-smart-contract-hacking-part1-ce8da6e3c097?source=collection_archive---------1-----------------------#2022-09-19</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="19e1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我建议复制本课程的报告，以便您能够跟上。<br/><a class="ae jo" href="https://github.com/JEflyer/Offensive-Smart-Contract-Hacking-Course" rel="noopener ugc nofollow" target="_blank">https://github . com/JEflyer/Offensive-Smart-Contract-Hacking-Course</a></p><p id="1eb2" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">挑战1 —立桩</p><p id="85f7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">场景——有一个赌注合同，允许你下注和撤回你的赌注。目前在这个合同中有100个ETH。</p><p id="9a6d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">目标——偷走所有的ETH！</p><p id="d67e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">好的，让我们看看合同。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div class="fe ff jp"><img src="../Images/e00d593e9dea9d8b4706845b6e307cc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*n7WZaFVJs3VyPhnFfMP_LA.png"/></div></figure><p id="6a58" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">首先，任何地方都不会用到admin，所以我们可以忽略它。我们有一个很好的存款映射。我们有stake &amp; unstake功能，这也是下面界面的一部分。</p><p id="8f81" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">木桩()<br/> 1。检索用户发送的值。<br/> 2。请检查它是否大于零。<br/> 3。将金额添加到呼叫者的存款中。</p><p id="af8c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Unstake() <br/> 1。取回呼叫者下注的金额。<br/> 2。请检查该金额是否大于零。<br/> 3。检查该合同是否有足够的时间供呼叫者提取。<br/> 4。把资金发给打电话的人。<br/> 5。检查呼叫是否成功。<br/> 6。将呼叫者余额设置为零。</p><p id="1ac7" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你看到漏洞了吗？</p><p id="faf1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这不是最明显的漏洞&amp;它需要一些关于契约如何工作的知识，以及我们自己可以使用哪些功能。</p><p id="478c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">该漏洞存在于unstake函数中&amp;我将解释这是如何在攻击契约中被利用的。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="fe ff jx"><img src="../Images/a06c8c9a595d016b61364281aff38740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*sUXzH04x9rhnG8xXmujGlw.png"/></div></div></figure><p id="78df" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">首先，我们有一个IStake接口的实例&amp;攻击者的地址。</p><p id="6cd5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在构造函数中，我们设置攻击者的地址&amp;构建IStake接口的实例。</p><p id="1549" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">攻击()<br/> 1。查找调用者发送的值。<br/> 2。检查它是否大于或等于1 ETH。<br/> 3。桩1 ETH。<br/> 4。解散。</p><p id="de03" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">Receive() —每次将ETH发送给我们的合同时都会运行该函数。<br/> 1。检查是否赌注合同仍然有足够的ETH去偷。<br/> 2。如果有足够的资金，请再次调用拆分函数。<br/> 3。否则发送资金的攻击者&amp;检查转账是否成功。</p><p id="35e8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">好吧。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="fe ff kc"><img src="../Images/d269db4b4a133b64e27f76c846244c24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VRttiH5SekAAn6lEK8BWQA.png"/></div></div></figure><p id="61d0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们再仔细看看分解函数。</p><figure class="jq jr js jt fq ju fe ff paragraph-image"><div role="button" tabindex="0" class="jy jz di ka bf kb"><div class="fe ff kd"><img src="../Images/3fbc8706033ae2bec873482d432fab40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jaA0w7-OiLxTTqF3HHhYVA.png"/></div></div></figure><p id="7216" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">当我们点击这个函数中的红色x时，代码执行的流程会因为我们的代码而改变。当ETH发送给我们时，我们重新进入黄色x处的函数。</p><p id="debf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这意味着我们在重新进入时已经跳过了unstake函数的最后两行。</p><p id="084c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">现在，当我们用完了要窃取的资金时，资金将被发送给攻击者&amp;我们跳过了unstake函数的最后两行的所有实例现在都将运行，结束初始的unstake函数调用。</p><p id="7fe4" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">嗯，我希望你学到了一些东西！</p><p id="1d13" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果你觉得这很有趣，为什么不看看这个呢！<br/><a class="ae jo" rel="noopener" href="/p/e8454dfe8189">https://medium.com/p/e8454dfe8189</a></p><p id="697f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">坚实发展研究小组—<a class="ae jo" href="https://discord.gg/KzbcGmrnfN" rel="noopener ugc nofollow" target="_blank">https://discord.gg/KzbcGmrnfN</a></p><p id="a02c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">-多边形联盟—<a class="ae jo" href="https://www.polygonalliance.com/" rel="noopener ugc nofollow" target="_blank">https://www.polygonalliance.com/</a></p><p id="def5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">-多边形联盟不和——【https://discord.gg/kJKPCGQu66 T2】</p><p id="af30" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你喜欢这篇文章吗？<br/>想给我买杯咖啡吗？<br/>Polygon/Eth/Bsc—0x4a 581 E0 EAF 6b 71d 05905 e8e 6014 DC 0277 a1 b 10 ad</p><blockquote class="ke kf kg"><p id="adcd" class="iq ir kh is b it iu iv iw ix iy iz ja ki jc jd je kj jg jh ji kk jk jl jm jn hm dt translated"><em class="ht">交易新手？试试</em> <a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a"> <em class="ht">加密交易机器人</em> </a> <em class="ht">或</em> <a class="ae jo" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c"> <em class="ht">复制交易</em> </a> <em class="ht">上</em> <a class="ae jo" rel="noopener" href="/coinmonks/crypto-exchange-dd2f9d6f3769"> <em class="ht">最好的加密交易</em> </a></p></blockquote><blockquote class="kl"><p id="e056" class="km kn ht bd ko kp kq kr ks kt ku jn ek translated">加入Coinmonks <a class="ae jo" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jo" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>获取每日<a class="ae jo" href="http://coincodecap.com/" rel="noopener ugc nofollow" target="_blank">加密新闻</a></p></blockquote><h1 id="2e6f" class="kv kw ht bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls dt translated">另外，阅读</h1><ul class=""><li id="e75c" class="lt lu ht is b it lv ix lw jb lx jf ly jj lz jn ma mb mc md dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/free-crypto-signals-48b25e61a8da">免费加密信号</a> | <a class="ae jo" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a></li><li id="42a1" class="lt lu ht is b it me ix mf jb mg jf mh jj mi jn ma mb mc md dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/leveraged-token-3f5257808b22">杠杆代币的终极指南</a></li><li id="55b1" class="lt lu ht is b it me ix mf jb mg jf mh jj mi jn ma mb mc md dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/top-17-folding-electric-bikes-5e296f0918cb"> 16款最佳折叠电动自行车</a></li><li id="d79e" class="lt lu ht is b it me ix mf jb mg jf mh jj mi jn ma mb mc md dt translated"><a class="ae jo" rel="noopener" href="/coinmonks/the-28-best-electric-bikes-review-and-buying-guide-in-2023-7bb3146cb403"> 28款最佳电动自行车点评</a></li><li id="8894" class="lt lu ht is b it me ix mf jb mg jf mh jj mi jn ma mb mc md dt translated">前三名<a class="ae jo" rel="noopener" href="/coinmonks/top-3-binance-futures-trading-bots-e6031f84b3f9">币安期货交易机器人</a></li></ul></div></div>    
</body>
</html>