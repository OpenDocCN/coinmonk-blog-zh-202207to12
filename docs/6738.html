<html>
<head>
<title>CSC101- Pausable Smart Contract</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CSC101-可暂停智能合同</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/csc101-pausable-smart-contract-a47ab9ad1f67?source=collection_archive---------19-----------------------#2022-11-25">https://medium.com/coinmonks/csc101-pausable-smart-contract-a47ab9ad1f67?source=collection_archive---------19-----------------------#2022-11-25</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="6402" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在可暂停的智能合约中，我们可以暂停智能合约中的功能。智能合约的所有者有权暂停或启动智能合约中的某项功能。可暂停智能合同的使用案例是什么？</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/78db353f85d00a7149d8bc2b6bc3c9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nYib8N6wIy-Papn96wyEKg.png"/></div></div></figure><p id="f15a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">假设我们正在创建一个NFT铸币智能合约，我们希望暂停铸币一段时间以持有NFT，我们可以禁用将暂停该功能的功能。</p><p id="2e3b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">可暂停智能合约的另一个用例可以是初始硬币发行(ico)。当我们为用户创建新令牌并希望限制用户不得交易这些令牌时。</p><p id="c1db" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">如果您的合约有任何错误，并且黑客试图利用它，可暂停智能合约会很有用。作为智能合约的所有者，您可以暂停合约，以便我们可以阻止智能合约的滥用。</p><p id="a1f5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">因此，让我们看看如何编写一个可暂停的智能合同。在代码解释之后，我将解释可暂停智能合约的缺点。</p><pre class="jp jq jr js fq ka kb kc bn kd ke bi"><span id="a283" class="kf kg ht kb b be kh ki l kj kk">// SPDX-License-Identifier: MIT<br/>pragma solidity ^0.8.10;<br/><br/>contract Pausable {<br/><br/>    address public owner;<br/>    bool public isPaused;<br/><br/>    constructor() {<br/>        owner = msg.sender;<br/>    }<br/><br/>    modifier onlyOwner() {<br/>      require(msg.sender == owner, "On owner have access");<br/>      _;<br/>    }<br/><br/>    function setPaused(bool _paused) public onlyOwner {<br/>        isPaused = _paused;<br/>    }<br/><br/>    function withdraw(address payable _recipient) public onlyOwner {<br/>        require(isPaused == false, "Contract Paused");<br/>        payable(_recipient).transfer(address(this).balance);<br/>    }<br/>}</span></pre><p id="790a" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">例如，我采用了一个智能合约，它将智能合约金额转移给调用该函数的用户。为了展示可暂停智能合约的功能，我必须选择该示例代码。</p><p id="c20c" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们来破解密码。</p><pre class="jp jq jr js fq ka kb kc bn kd ke bi"><span id="c63c" class="kf kg ht kb b be kh ki l kj kk">// SPDX-License-Identifier: MIT<br/>pragma solidity ^0.8.10;<br/><br/>contract Pausable {</span></pre><p id="ec91" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在前2行中，我们已经添加了将要编译的许可证和可靠性版本。在那之后，我们将我们的智能合约命名为<strong class="is hu"> Pausable </strong></p><pre class="jp jq jr js fq ka kb kc bn kd ke bi"><span id="a22c" class="kf kg ht kb b be kh ki l kj kk">address public owner;<br/>bool public isPaused;<br/><br/>constructor() {<br/>   owner = msg.sender;<br/>}</span></pre><p id="31e8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们初始化了两个状态变量owner和<strong class="is hu"> isPaused </strong>，之后，我们在构造函数<strong class="is hu"> msg.sender </strong>中初始化了owner地址，这是一个全局变量，包含将要部署智能联系人的用户的钱包地址。</p><pre class="jp jq jr js fq ka kb kc bn kd ke bi"><span id="d5ff" class="kf kg ht kb b be kh ki l kj kk">modifier onlyOwner() {<br/>      require(msg.sender == owner, "On owner have access");<br/>      _;<br/>    }</span></pre><p id="9a42" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">之后，我们添加了一个修饰符，它检查调用函数的人的所有权条件，调用方应该是智能契约的所有者。</p><pre class="jp jq jr js fq ka kb kc bn kd ke bi"><span id="e3d0" class="kf kg ht kb b be kh ki l kj kk">function setPaused(bool _paused) public onlyOwner {<br/>        isPaused = _paused;<br/>    }</span></pre><p id="c85e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><strong class="is hu"> setPaused </strong>功能用于更新<strong class="is hu"> isPaused </strong>状态变量。<strong class="is hu"> isPaused </strong>是一个布尔变量，所以我们可以对它设置true或false。只有智能合约的所有者被授权调用这个函数，因为已经使用了我们在上面创建的onlyOwner修饰符。</p><pre class="jp jq jr js fq ka kb kc bn kd ke bi"><span id="a33d" class="kf kg ht kb b be kh ki l kj kk">function withdraw(address _recipient) public onlyOwner {<br/>        require(isPaused == false, "Contract Paused");<br/>        payable(_recipient).transfer(address(this).balance);<br/> }</span></pre><p id="39a1" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">之后，我们有一个撤销功能，该功能将检查<strong class="is hu"> isPaused </strong>状态，然后将智能合同金额转移给调用该功能的用户。</p><pre class="jp jq jr js fq ka kb kc bn kd ke bi"><span id="8f40" class="kf kg ht kb b be kh ki l kj kk">require(isPaused == false, "Contract Paused");</span></pre><p id="c295" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这一行确保了作为智能合约的所有者，我对这一特定功能拥有可中止的控制权。我可以随时暂停和启动该功能，这样我们就可以在智能合约中添加可暂停的功能。</p><p id="af17" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这就是我们如何创建可暂停的功能。正如我前面提到的，可暂停功能也有一些缺点，所以让我们来看看这些缺点。</p><h2 id="b9d4" class="kl kg ht bd km kn ko kp kq kr ks kt ku jb kv kw kx jf ky kz la jj lb lc ld le dt translated">可暂停智能合同的缺点</h2><p id="b8cd" class="pw-post-body-paragraph iq ir ht is b it lf iv iw ix lg iz ja jb lh jd je jf li jh ji jj lj jl jm jn hm dt translated">正如我们所知，智能合约代码是公开的，任何人都可以阅读它，因此暂停功能会影响用户的信任，因为在看到智能合约的代码后，用户会知道您可以在智能合约中暂停该功能。假设您有ICO智能合约，并且您已经在其中添加了该功能，因此用户可能没有兴趣购买令牌，因为您可以随时暂停撤销功能。</p><p id="5902" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">一般来说，如果用户知道你的智能合约是可暂停的，那么用户就不会有兴趣使用你的dApp。为了解决这个问题，我们还可以实现基于时间的暂停，这将确保在一定时间后暂停将被删除，并且所有者无法控制暂停合同。</p><p id="48cc" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们将在接下来的教程中学习基于时间的暂停。</p><blockquote class="lk"><p id="a266" class="ll lm ht bd ln lo lp lq lr ls lt jn ek translated">交易新手？试试<a class="ae lu" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或者<a class="ae lu" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>