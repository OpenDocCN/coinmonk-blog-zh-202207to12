<html>
<head>
<title>Journey through Cairo IV — A deep dive into Cairo’s Storage with Starklings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">开罗四号之旅——与星人一起深入探索开罗的仓库</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/journey-through-cairo-iv-a-deep-dive-into-cairos-storage-with-starklings-d7e3549470ff?source=collection_archive---------3-----------------------#2022-09-07">https://medium.com/coinmonks/journey-through-cairo-iv-a-deep-dive-into-cairos-storage-with-starklings-d7e3549470ff?source=collection_archive---------3-----------------------#2022-09-07</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/9a71db6005a5c5a00f5af1990345ab69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fUl7yt9SYXqAOhpW6vMmyA.png"/></div></div></figure><p id="4250" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">欢迎来到我们系列的第四集，“穿越开罗的旅程”。在我们的上一篇文章中，你可以在这里找到<a class="ae jz" rel="noopener" href="/coinmonks/journey-through-cairo-iii-a-deep-dive-into-strings-and-felts-with-starklings-2bb6abff2d83"/>，我们仔细看了一下felt数据类型，以及Cairo中的短字符串。</p><p id="f11e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">像往常一样，如果你刚刚加入飞行中，我建议你检查以前的文章，因为我们将从我们的最后一个检查站开始。</p><p id="579c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><em class="ka">注:本教程中使用的所有代码片段都使用了Cairo-lang v0.9.0中的旧Cairo语法，因为在撰写本文时，我们的Starklings练习中也使用了这些语法。</em></p><h1 id="377a" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">开罗的仓库</h1><p id="eaaa" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hm dt translated">在本系列的第二部分中，我们区分了Cairo程序和Cairo契约，注意到程序是无状态的，而契约运行在Starknet VM上，因此具有持久状态(存储)。</p><p id="75de" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">契约存储是一个持久的存储空间，你可以在这里写、读和修改数据。根据官方文件，这是一个具有2^251槽的地图，其中每个槽是一个被初始化为0的毛毡。</p><p id="8012" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">Cairo中的存储变量如下所示:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="f262" class="ln kc ht lj b fv lo lp l lq lr">@storage_var</span><span id="b280" class="ln kc ht lj b fv ls lp l lq lr">func id() -&gt; (number: felt):</span><span id="0785" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><p id="f477" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">其中<strong class="jd hu"> @storage_var </strong>被称为装饰器，用于指定存储变量。</p><h1 id="e3ef" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated"><strong class="ak">装修工</strong></h1><p id="b052" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hm dt translated">与solidity不同，Cairo中的所有函数执行都是由关键字<strong class="jd hu"> func </strong>指定的，很难区分。为了解决这个问题，Cairo使用了我们称之为decorators的东西来区分这些功能。所有的装饰者都以@开头。</p><p id="f379" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">以下是你在开罗会遇到的最常见的装修工:</p><ol class=""><li id="7d9e" class="lt lu ht jd b je jf ji jj jm lv jq lw ju lx jy ly lz ma mb dt translated">@storage_var —用于指定状态变量。</li><li id="69d3" class="lt lu ht jd b je mc ji md jm me jq mf ju mg jy ly lz ma mb dt translated">@constructor —用于指定构造函数。</li><li id="08f1" class="lt lu ht jd b je mc ji md jm me jq mf ju mg jy ly lz ma mb dt translated">@external —用于指定写入状态变量的函数。</li><li id="65c9" class="lt lu ht jd b je mc ji md jm me jq mf ju mg jy ly lz ma mb dt translated">@view —用于指定从状态变量读取的函数。</li><li id="77fd" class="lt lu ht jd b je mc ji md jm me jq mf ju mg jy ly lz ma mb dt translated">@event —用于指定事件</li><li id="f3b3" class="lt lu ht jd b je mc ji md jm me jq mf ju mg jy ly lz ma mb dt translated">@l1_handler —用于指定处理从消息传递桥中的l1协定发送的消息的函数。</li></ol><h1 id="603f" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated"><strong class="ak">如何读写合同存储器</strong></h1><p id="0e61" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hm dt translated"><strong class="jd hu">写入存储器</strong></p><p id="31e5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如前所述，写入状态变量的函数必须用@external decorator指定。下面是一个Cairo函数的示例，它更新了前面的存储变量:</p><p id="8bd2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> <em class="ka"> PS </em> </strong> <em class="ka">:如果你不明白这里的一切，不要担心，因为我们还没有处理Cairo函数</em></p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="a8f2" class="ln kc ht lj b fv lo lp l lq lr">@external</span><span id="60b7" class="ln kc ht lj b fv ls lp l lq lr">func update_id{</span><span id="c9bc" class="ln kc ht lj b fv ls lp l lq lr">      syscall_ptr : felt*,</span><span id="7988" class="ln kc ht lj b fv ls lp l lq lr">      pedersen_ptr : HashBuiltin*,</span><span id="7fe9" class="ln kc ht lj b fv ls lp l lq lr">      range_check_ptr</span><span id="cd8c" class="ln kc ht lj b fv ls lp l lq lr">    }(_number: felt):</span><span id="42af" class="ln kc ht lj b fv ls lp l lq lr">    id.write(_number)</span><span id="55b5" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><p id="dadd" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这里主要关注的，是<strong class="jd hu"> id.write(_number) </strong>。</p><p id="9ff1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">为了写或更新状态变量，我们使用variablename.write()。</p><p id="0ba7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">从存储器中读取数据</strong></p><p id="be19" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">读取状态变量的值非常容易。如前所述，读取状态变量的函数必须用@view decorator指定。下面是一个从<strong class="jd hu"> id </strong>状态变量读取的示例函数:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="6bbb" class="ln kc ht lj b fv lo lp l lq lr">@view</span><span id="fa64" class="ln kc ht lj b fv ls lp l lq lr">func read_id{</span><span id="6e16" class="ln kc ht lj b fv ls lp l lq lr">      syscall_ptr : felt*,</span><span id="7885" class="ln kc ht lj b fv ls lp l lq lr">      pedersen_ptr : HashBuiltin*,</span><span id="df15" class="ln kc ht lj b fv ls lp l lq lr">      range_check_ptr</span><span id="8276" class="ln kc ht lj b fv ls lp l lq lr">    }(_number: felt):</span><span id="69ff" class="ln kc ht lj b fv ls lp l lq lr">    id.read()</span><span id="f3ad" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><p id="2a37" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">重点关注<strong class="jd hu"> id.read() </strong>，我们可以看到，与写入存储类似，读取只需要使用variablename.read()。</p><h1 id="9278" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">存储映射</h1><p id="6d96" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hm dt translated">与Solidity不同，映射有自己的特殊关键字，Cairo也使用存储变量进行映射。</p><p id="4db3" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在我们前面的id示例中，我们有一个状态变量只存储一个值，但是我们也可以创建更复杂的状态变量，它们有<strong class="jd hu"> key - &gt; value </strong>对。这里有一个例子:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="479f" class="ln kc ht lj b fv lo lp l lq lr">@storage_var</span><span id="58bf" class="ln kc ht lj b fv ls lp l lq lr">func balance(address: felt) -&gt; (amount: felt):</span><span id="a897" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><p id="e126" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在这里，状态变量<strong class="jd hu"> balance </strong>，是地址到它们持有的数量的映射。</p><p id="a440" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">写入这种类型的状态变量</strong>:</p><p id="7007" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们需要提供键(地址)和值(金额)，如下所示:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="0513" class="ln kc ht lj b fv lo lp l lq lr">@external</span><span id="4df1" class="ln kc ht lj b fv ls lp l lq lr">func update_balance{</span><span id="33eb" class="ln kc ht lj b fv ls lp l lq lr">      syscall_ptr : felt*,</span><span id="21d3" class="ln kc ht lj b fv ls lp l lq lr">      pedersen_ptr : HashBuiltin*,</span><span id="4649" class="ln kc ht lj b fv ls lp l lq lr">      range_check_ptr</span><span id="b8a9" class="ln kc ht lj b fv ls lp l lq lr">    }(_address: felt, _amount: felt):</span><span id="c8f5" class="ln kc ht lj b fv ls lp l lq lr">    balance.write(_address, _amount)</span><span id="9412" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><p id="4459" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如您所见，我们提供了写括号内的键和值，因为我们需要指定要更新其值的键。</p><p id="202d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu">并从该状态变量</strong>中读取:</p><p id="9e19" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们只需要这样的地址:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="54b5" class="ln kc ht lj b fv lo lp l lq lr">@view</span><span id="27de" class="ln kc ht lj b fv ls lp l lq lr">func read_balance{</span><span id="a7fe" class="ln kc ht lj b fv ls lp l lq lr">      syscall_ptr : felt*,</span><span id="46b7" class="ln kc ht lj b fv ls lp l lq lr">      pedersen_ptr : HashBuiltin*,</span><span id="e761" class="ln kc ht lj b fv ls lp l lq lr">      range_check_ptr</span><span id="0a4a" class="ln kc ht lj b fv ls lp l lq lr">    }(_address: felt, _amount: felt):</span><span id="7ba0" class="ln kc ht lj b fv ls lp l lq lr">    balance.read(_address)<br/>end</span></pre><p id="c059" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们在这里只使用了键(地址),因为我们只想获得特定键的值，而不是更新或改变它。所以使用<strong class="jd hu"> balance.read(_address) </strong>，向我们返回该特定地址的金额或余额。</p><p id="3cb7" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">理解了这一切之后，让我们直接投入到一些与Starklings相关的实际工作中吧！</p><p id="3cc0" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> storage01.cairo </strong></p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mh"><img src="../Images/48e1233607290cd1d7694f264c050945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xr4yJsalq1pcKgy1NDfoCA.png"/></div></div></figure><p id="4c74" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在这里，我们被期望创建一个名为<strong class="jd hu"> bool </strong>的存储，存储一个毛毡。</p><p id="8c7e" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这非常简单，因为它类似于我们的第一个id为的存储示例。这就是我们想要创建bool状态变量的方式:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="92b3" class="ln kc ht lj b fv lo lp l lq lr">@storage_var</span><span id="b467" class="ln kc ht lj b fv ls lp l lq lr">func bool () -&gt; (value: felt):</span><span id="d0f9" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mh"><img src="../Images/0261597701a73344e92419e7197cd4f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_YSl8qf4HjAMf5bLr4sEHg.png"/></div></div></figure><p id="ef94" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在让我们看看我们是否通过了挑战..</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mi"><img src="../Images/e8250f7053240151024a4a741fa15ece.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*coB2-Y49rfHCjjQKH8dZRA.png"/></div></div></figure><p id="cf06" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">耶！我们做到了。进入下一个挑战</p><p id="1797" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> storage02.cairo </strong></p><p id="595b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">你知道我们也可以存储结构体吗？这就是我们在本练习中要探讨的内容。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mj"><img src="../Images/097d0eb3d91d4854d9499ea65aefcca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2dUCLdDeGvTxSsQ2PIDF3Q.png"/></div></div></figure><p id="56c1" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">所以我们有三个目标。</p><ol class=""><li id="be54" class="lt lu ht jd b je jf ji jj jm lv jq lw ju lx jy ly lz ma mb dt translated">我们预计将创建一个名为<strong class="jd hu">钱包</strong>的存储，将一种感觉映射到另一种感觉。</li></ol><p id="9b8c" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">此挑战所需的存储变量与我们使用<strong class="jd hu">平衡</strong>状态变量(值映射的关键)时所做的非常相似:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="0630" class="ln kc ht lj b fv lo lp l lq lr">@storage_var</span><span id="8625" class="ln kc ht lj b fv ls lp l lq lr">func wallet (id: felt) -&gt; (amount: felt):</span><span id="afdd" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><p id="7a2d" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">2.我们需要创建一个名为<strong class="jd hu"> height_map </strong>的存储，将两个毛毡映射到另一个毛毡。</p><p id="f8a2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这也类似于我们对<strong class="jd hu"> balance </strong>状态变量所做的，但是这一次，我们将2个键映射到1个值:</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="764b" class="ln kc ht lj b fv lo lp l lq lr">@storage_var</span><span id="543f" class="ln kc ht lj b fv ls lp l lq lr">func height_map (length: felt, width: felt)  -&gt; (height: felt):</span><span id="53fe" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><p id="c773" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">3.这是最后也是最强大的挑战！我们需要将一个毛毡映射到一个Id(结构)。如您所见，用户值是一个Id类型的结构。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="7014" class="ln kc ht lj b fv lo lp l lq lr">@storage_var</span><span id="03b3" class="ln kc ht lj b fv ls lp l lq lr">func id (address: felt) -&gt; (user: Id):</span><span id="f92b" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mj"><img src="../Images/3c96ad10c2bea5cdd53bf006ec27f674.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kSiO1awRGJy1mk0ojgIvIw.png"/></div></div></figure><p id="34d8" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">让我们祈祷，看看我们是否通过了测试。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mk"><img src="../Images/b29418f7cbd1637c44c615d067bef3e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MiFZLaOeqGm5-RY3UcBrhQ.png"/></div></div></figure><p id="c7f2" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">是啊。我们做到了。</p><p id="990b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated"><strong class="jd hu"> storage03.cairo </strong></p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ml"><img src="../Images/0fd843df3642f17c00e2a306c9c5cc1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j81h1Vu4oBkRBzPXWUDSVg.png"/></div></div></figure><p id="536a" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在这里，我们期望实现外部和视图函数来读写<strong class="jd hu"> bool </strong>状态变量。</p><p id="1836" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">正如我们之前所说，当一个函数写入存储变量时，它是一个外部函数，应该用<strong class="jd hu"> @external </strong> decorator指定，而如果它从存储变量读取，它是一个视图函数，应该用<strong class="jd hu"> @view </strong> decorator指定。</p><p id="4426" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">我们要修复的第一个函数是<strong class="jd hu">切换函数</strong>，它应该在被调用时更新<strong class="jd hu"> bool </strong>状态变量，但是这里有一个问题..</p><p id="7568" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">布尔值只能是0或1，所以我们要以这样一种方式实现它，即每次调用<strong class="jd hu"> toggle </strong>函数时，如果布尔值是0，我们就将其更新为1，如果是1，我们就将其更新为0。为此，我们恳求使用<strong class="jd hu">条件句:</strong></p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="3bd4" class="ln kc ht lj b fv lo lp l lq lr">@external</span><span id="ecae" class="ln kc ht lj b fv ls lp l lq lr">func toggle{syscall_ptr : felt*, pedersen_ptr : HashBuiltin*, range_check_ptr}():</span><span id="0b37" class="ln kc ht lj b fv ls lp l lq lr">  let (value) = bool.read()</span><span id="e8c7" class="ln kc ht lj b fv ls lp l lq lr">  if value == 0:</span><span id="a5b4" class="ln kc ht lj b fv ls lp l lq lr">    bool.write(1)</span><span id="eca7" class="ln kc ht lj b fv ls lp l lq lr">  else:</span><span id="1714" class="ln kc ht lj b fv ls lp l lq lr">    bool.write(0)</span><span id="8d6c" class="ln kc ht lj b fv ls lp l lq lr">  end</span><span id="b95c" class="ln kc ht lj b fv ls lp l lq lr">  return () </span><span id="174c" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><p id="13fb" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">接下来，我们需要修复<strong class="jd hu"> view_bool </strong>函数，以便在调用时返回<strong class="jd hu"> bool </strong>状态变量的值。</p><pre class="le lf lg lh fq li lj lk ll aw lm dt"><span id="f9ba" class="ln kc ht lj b fv lo lp l lq lr">@view</span><span id="6558" class="ln kc ht lj b fv ls lp l lq lr">func view_bool{syscall_ptr : felt*, pedersen_ptr : HashBuiltin*, range_check_ptr}() -&gt; (bool : felt):</span><span id="6fd1" class="ln kc ht lj b fv ls lp l lq lr">  let (value) = bool.read()</span><span id="d18a" class="ln kc ht lj b fv ls lp l lq lr">  return (value)</span><span id="8788" class="ln kc ht lj b fv ls lp l lq lr">end</span></pre><p id="a10f" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">这是完整的代码。</p><figure class="le lf lg lh fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ml"><img src="../Images/f93b9e29b003d9c14119f887dde04401.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SZ9DYV6J2A0qGuJS79f1-w.png"/></div></div></figure><p id="81ad" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">现在让我们来看看我们所做的是否足以通过挑战。</p><p id="9925" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">瞧啊。我们做到了。</p><h1 id="7156" class="kb kc ht bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky dt translated">结论</h1><p id="61c9" class="pw-post-body-paragraph jb jc ht jd b je kz jg jh ji la jk jl jm lb jo jp jq lc js jt ju ld jw jx jy hm dt translated">恭喜你！你刚刚掌握了Cairo的储物方式。</p><p id="bf71" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">请记住，如果你遇到了什么困难，我在这里有这些练习的解决方案。</p><p id="7f77" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">在我们的下一篇文章中，我们将详细研究<strong class="jd hu">隐含论点</strong>。</p><p id="7ce4" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">如果你从这篇文章中得到了价值，请与他人分享。</p><p id="ca64" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">你也可以在以下社交网站上与我联系，尤其是在Twitter上，我在那里分享我在开罗的小发现！</p><p id="6bf5" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">推特:https://twitter.com/0xdarlington</p><p id="3659" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">领英:<a class="ae jz" href="https://www.linkedin.com/in/nnamdarlington?source=about_page-------------------------------------" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/nnamdarlington</a></p><p id="c41b" class="pw-post-body-paragraph jb jc ht jd b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy hm dt translated">github:<a class="ae jz" href="https://github.com/Darlington02?source=about_page-------------------------------------" rel="noopener ugc nofollow" target="_blank">https://github.com/Darlington02</a></p><blockquote class="mm"><p id="3d95" class="mn mo ht bd mp mq mr ms mt mu mv jy ek translated">交易新手？尝试<a class="ae jz" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae jz" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>