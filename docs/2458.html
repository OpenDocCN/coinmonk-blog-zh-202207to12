<html>
<head>
<title>Truth Behind the Celer Network cBridge cross-chain bridge incident: BGP hijacking</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">策勒网络cBridge跨链桥事件背后的真相:BGP劫持</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/truth-behind-the-celer-network-cbridge-cross-chain-bridge-incident-bgp-hijacking-52556227e940?source=collection_archive---------1-----------------------#2022-08-20">https://medium.com/coinmonks/truth-behind-the-celer-network-cbridge-cross-chain-bridge-incident-bgp-hijacking-52556227e940?source=collection_archive---------1-----------------------#2022-08-20</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/1e5f784706b0c70aeec50508148f5515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-mQ8aZ1zRL263rDUDnKNNA.png"/></div></div></figure><h2 id="1819" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">背景</h2><p id="00ac" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">Celer Network官员在8月18日声明，在北京时间3:45到6:00之间，某些cBridge用户被定向到恶意智能合同。最初，cBridge前端接口疑似遭到DNS劫持。</p><p id="4703" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">完全不同于以往的游牧、虫洞、浪人、和谐等跨链桥黑客事件。，此次攻击并非由智能合约和跨链协议中的bug或相关服务器的入侵引起，锁定在cBridge中的跨链资产也一直保持安全。<strong class="kb hu">在此次攻击中，黑客直接针对Celer系统之外的互联网架构中的底层基础设施，通过欺骗互联网底层路由协议(BGP)，允许跨链用户在一段时间内访问一个“钓鱼”前端用户界面。</strong>由于响应迅速，Celer network能够限制损失。这是因为Celer网络团队拥有24小时监控系统。他们的客户服务团队能够及时发现问题并提醒社区。Celer Network团队授权SlowMist安全团队对这一紧急事件做出响应，并进行深入调查。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff kz"><img src="../Images/4b13d5a34cfcd6681b17c957184b5cec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*63j3BzU5QBECuawJfX7myQ.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://twitter.com/CelerNetwork/status/1560022871564775424" rel="noopener ugc nofollow" target="_blank">https://twitter.com/CelerNetwork/status/1560022871564775424</a></figcaption></figure><h2 id="d974" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">分析处理</h2><p id="2df5" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">Celer Network团队最初怀疑是DNS劫持，在与他们沟通后，我们能够了解到有关该域名的更多信息:cbridge-prod2.celer.network。我们发现浏览器在攻击期间没有报告证书错误。因此，我们的调查首先从解决DNS劫持的可能性开始。(特别感谢<a class="ae li" href="https://twitter.com/greysign1" rel="noopener ugc nofollow" target="_blank"> @greysign1 </a>帮助我们快速排查DNS劫持的可能性)</p><p id="ea56" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">我们首先查看相关的证书信息:</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lj"><img src="../Images/ed53cb98ce596b4a24f0d20ff0dfe9dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JkjdQgcfYWsh7XnX0-P_zg.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://crt.sh/?q=celer.network" rel="noopener ugc nofollow" target="_blank">https://crt.sh/?q=celer.network</a></figcaption></figure><p id="0782" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">该证书似乎已被意外更改，由Let's Encrypt颁发的原始证书被替换为由GoGetSSL颁发的伪造证书。</p><p id="f66f" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">GoGetSSL可以免费发放90天的证书:</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lk"><img src="../Images/8f77ca4c2333219eeac8c5c5fd8d7e2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bc55av7dlb7Z72bCsUKLnA.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://www.gogetssl.com/sslcerts/free-ssl/" rel="noopener ugc nofollow" target="_blank">https://www.gogetssl.com/sslcerts/free-ssl/</a></figcaption></figure><ul class=""><li id="0ee4" class="ll lm ht kb b kc ku kg kv jm ln jq lo ju lp kt lq lr ls lt dt translated">证书1分析:【https://crt.sh/?id=7356185959 T4】</li></ul><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lu"><img src="../Images/676fbe2031819a3b3b576086e03201c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iZ5DCc_Pbe5SLL0KePO1iw.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://search.censys.io/certificates/a01a34fe398e56d80bdda40efb555d14654856b5faa6c92bfebef2861d712732" rel="noopener ugc nofollow" target="_blank">https://search.censys.io/certificates/a01a34fe398e56d80bdda40efb555d14654856b5faa6c92bfebef2861d712732</a></figcaption></figure><p id="07dc" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">证书上在以下时间出现CRL检查错误:</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lv"><img src="../Images/85e8782c86b35c04006f6579ea531149.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2aGc2XjZ4LkVGeWcabykOw.png"/></div></div></figure><ul class=""><li id="719d" class="ll lm ht kb b kc ku kg kv jm ln jq lo ju lp kt lq lr ls lt dt translated">证书2的分析:<a class="ae li" href="https://crt.sh/?id=7356184952" rel="noopener ugc nofollow" target="_blank">https://crt.sh/?id=7356185959</a></li></ul><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lw"><img src="../Images/6c692a83dd17cd3db9c829b65a1fbd76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N10PbBvThIkOuegjJrI9XQ.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://search.censys.io/certificates/579fabee3a9f7efecd43c99795744c4b93dc49a4fb93e174b201f8a333990c1a" rel="noopener ugc nofollow" target="_blank">https://search.censys.io/certificates/579fabee3a9f7efecd43c99795744c4b93dc49a4fb93e174b201f8a333990c1a</a></figcaption></figure><p id="4226" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">此证书在以下时间也有一个CRL检查错误:</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lx"><img src="../Images/c0a0bf4c41b05ab78802930b850a6314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZU068fAHhsUWYOQXyNWMdQ.png"/></div></div></figure><p id="3058" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">在检查了IP地址、证书以及与证书1相关的其他信息后，我们发现该证书绑定的IP地址是44.235.216.69。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ly"><img src="../Images/ac0d3851f36fcc7bfe74cbb63c04f947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1HeKiFrATtM2Z2MbJmHcSg.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://search.censys.io/hosts/44.235.216.69" rel="noopener ugc nofollow" target="_blank">https://search.censys.io/hosts/44.235.216.69</a></figcaption></figure><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lv"><img src="../Images/8684d517f30e4c3a125d590f979ec1a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*47NpGNNHclT1kM8U3fW2GQ.png"/></div></div></figure><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lz"><img src="../Images/59334dde1998c7c95ca8c05b32c6cfb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DioQ9zajkYWK5LYeGxiXAQ.png"/></div></div></figure><p id="9ca7" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">证书2的IP地址未能查询到证书2对应的IP地址，可能是由于攻击持续时间短，互联网搜索引擎未能收集到相关信息。</p><p id="41c0" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">因此，我们重点分析了cbridge-prod2.celer.network域的IP解析数据:</p><p id="81c7" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">IP地址44.235.216.69与cbridge-prod2.celer.network关联了很长一段时间。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ma"><img src="../Images/9a7d4617d6ae54842f6a9c8e05e46cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I67LoDegK-Mu48iv4e350Q.png"/></div></div></figure><p id="a9b5" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">问题是:这个IP地址44.235.216.69与cbridge-prod2.celer.network关联了很长一段时间，这一事实证明它属于官方的Celer Network服务器。Celer Network团队也证实了这一点。那么为什么会有一个伪造的证书与这个IP相关联呢？</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mb"><img src="../Images/42a3bb209df919b7b91f389840102e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j6hAc4peY4FMUCNr01ymZA.png"/></div></div></figure><p id="f4c3" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">于是我们开始调查44.235.216.69的AS，发现这个IP对应的AS不一般。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mb"><img src="../Images/64b2fdad147af61b0c5f3f8ca6177827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8GGTWM8PDg-NRJ2zOy86zA.png"/></div></div></figure><p id="d288" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">AS16509 <em class="mc">宣布波哥大</em>:</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff md"><img src="../Images/45bb7ae8730c6ce7a81b941bf3f13138.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PMtEGW1p1X6QfPetXjvqPA.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://bgp.he.net/AS16509" rel="noopener ugc nofollow" target="_blank">https://bgp.he.net/AS16509</a></figcaption></figure><p id="d01b" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">浏览bogons，我们能够确定这通常是攻击者假冒IP地址来执行攻击的情况:<br/><a class="ae li" href="https://networkdirection.net/articles/routingandswitching/bgp-bogonsandmartians/" rel="noopener ugc nofollow" target="_blank">https://network direction . net/articles/routingandswitching/BGP-bogonsandmarshall/</a><br/><a class="ae li" href="https://forum.networklessons.com/t/what-are-bogons/6333" rel="noopener ugc nofollow" target="_blank">https://forum.networklessons.com/t/what-are-bogons/6333</a></p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff me"><img src="../Images/1e62a99bac09b21217931bfbad199ed0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sytOHc18k8yBmFhsEvwk4w.png"/></div></div></figure><p id="a175" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">由于44.235.216.69的AS出现异常，我们首先怀疑是BGP的问题，因此我们联系了Celer Network以获取攻击者54.84.236.100的IP地址。我们发现IP地址所在的AS14618也有异常。(AS14618也宣布博贡)</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mf"><img src="../Images/c6873edcf42a231a8b7a4a72b6d48398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E9rpEHSD8K7CsZMJHPMbEg.png"/></div></div></figure><p id="c092" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">巧合的是，AS14618的上游是AS16509 (AS16509也是44.235.216.69所在的AS)。这提醒我们BGP劫持攻击的可能性。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mg"><img src="../Images/d314aa07da6e2787c326765819261531.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xu03GVF7aWfgvi3d7WWyCg.png"/></div></div></figure><p id="5985" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">我们的调查显示，IP:54.84.236.100被标记为恶意。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mh"><img src="../Images/02c0f24625c95946f7d5bfa327b9211d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chGsSTE3Id93OnjjGXWQHw.png"/></div></div></figure><p id="241a" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">我们从我们的社区收集了关于IP:54.84.236.100的相关信息，发现其中提到该IP地址与2014年发生的另一起BGP劫持事件有关。但是，因为这件事发生在很久以前，所以可能不再相关。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mf"><img src="../Images/07e1a73a3f4096eb94e2a59375149b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eUFSIrKPEbZs65WoDbAc-Q.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://www.secureworks.com/research/bgp-hijacking-for-cryptocurrency-profit" rel="noopener ugc nofollow" target="_blank">https://www.secureworks.com/research/bgp-hijacking-for-cryptocurrency-profit</a></figcaption></figure><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mi"><img src="../Images/7ea89003b849ae2df7fa31adec9c4121.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RD3OGzR-JZbU_-OToE6kag.png"/></div></div></figure><p id="137f" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">然后，我们根据BGP劫持留下的记录继续调查:</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mj"><img src="../Images/e63f514c68c8940ae53907243c98e9b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uXVBtBCGXTIXD31UNqWQLA.png"/></div></div></figure><p id="b68c" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">追踪攻击IP的BGP记录:54.84.236.100透露该路由不再可用。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mk"><img src="../Images/0fa08248ac5617d2930cde2cb15eac87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0qwdSj-F3xeuHxCor-TDIA.png"/></div></div></figure><p id="5085" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">我们继续跟踪celer的IP:44.235.216.69的BGP路由器踪迹，并且能够找到正确的路由。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ml"><img src="../Images/eb0bca2183660786c916c7339093fced.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AGTBqbRTFTzPZiRK2ownWA.png"/></div></div></figure><p id="f166" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">然后我们查看了BGP节点变更日志:<br/>北京时间:2022年8月18日上午2:48—2022年8月18日上午7:48 UTC+8</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff ly"><img src="../Images/e1c74842d92462bd6aea6485ece5ff60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9x1RLqPQb5wGQpXU24dxaQ.png"/></div></div></figure><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mm"><img src="../Images/455b275ec4c78431fb0db83738f3e107.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eU9-qZVqCeVOESsDFYA59Q.png"/></div></div></figure><p id="2e08" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">在2022年8月18日，在英国夏令时凌晨2:48-7:48之间的时间段发现有大量节点添加和删除变更记录。</p><p id="6ce1" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">我们继续监控AS更改日志，发现AS14618以前有路由信息44.235.216.0/24，但该路径后来被更改为撤销，这证明:</p><ol class=""><li id="bb1d" class="ll lm ht kb b kc ku kg kv jm ln jq lo ju lp kt mn lr ls lt dt translated">AS14618中的44.235.216.0/24曾经是最佳路径</li><li id="aa85" class="ll lm ht kb b kc mo kg mp jm mq jq mr ju ms kt mn lr ls lt dt translated">现在AS14618中的44.235.216.0/24不再是最优路径；它被撤回了。</li></ol><p id="7f49" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">(当BGP劫持发生时，攻击者将发布一条最佳路径，将流量定向到自己的服务器)</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mt"><img src="../Images/94b2e73bf3db4e3da34c154f8acd1926.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OfcX7C8HGo6p_zJkgkLfzw.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://smakd.potaroo.net/cgi-bin/per-as?as=14618" rel="noopener ugc nofollow" target="_blank">https://smakd.potaroo.net/cgi-bin/per-as?as=14618</a></figcaption></figure><p id="0066" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">为了获得更准确的数据，我们使用以下bgplay来检查攻击前后与44.235.216.69相关的路径变化。</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mu"><img src="../Images/a0a0d672698b6fc72056f8f24dfed207.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b1S8fZPOCcfE5cnM6AyfUA.png"/></div></div><figcaption class="le lf fg fe ff lg lh bd b be z ek"><a class="ae li" href="https://stat.ripe.net/special/bgplay#bgplay_fetch.resource=44.235.216.69" rel="noopener ugc nofollow" target="_blank">https://stat.ripe.net/special/bgplay#bgplay_fetch.resource=44.235.216.69</a></figcaption></figure><p id="9bce" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">在2022年8月17日，我们可以看到在19:19:23 +UTC和23:19:23 +UTC之间的时间段内，BGP路由路径的信息出现了明显的波动。</p><p id="4208" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">这种变化反映在将流量从44.235.216.0/24定向到AS14618，在攻击后，流量从44.235.216.0/24通过AS16509出去。</p><p id="756a" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">因此，我们认为这一事件很可能是BGP劫持事件，其中AS14618似乎是受攻击者控制的节点(AS14618的路由器可能存在安全问题，可能被攻击者利用)，攻击持续约4小时。</p><p id="25f2" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">攻击者能够将证书1(伪造的证书)绑定到Celer Network的IP:44.235.216.69，因为攻击者有一个具有相同IP的恶意服务器。由于gogetssl支持http进行身份验证，他们可以将gogetssl提供的文本输入到恶意服务器中。因此，可以通过BGP劫持将流量定向到具有相同IP的恶意服务器来绑定证书1。因此，浏览器会收到证书错误的警告。</p><p id="1c7b" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">我们确定AS14618是由攻击者控制的，原因如下。</p><ol class=""><li id="b25d" class="ll lm ht kb b kc ku kg kv jm ln jq lo ju lp kt mn lr ls lt dt translated">攻击者首先将44.235.216.69的流量定向到AS14618，并在攻击后将44.235.216.69路由回AS16509。</li><li id="b1ef" class="ll lm ht kb b kc mo kg mp jm mq jq mr ju ms kt mn lr ls lt dt translated">攻击IP:54.84.236.100也在AS14618里面。</li><li id="8dc7" class="ll lm ht kb b kc mo kg mp jm mq jq mr ju ms kt mn lr ls lt dt translated">袭击发生后，AS14618被撤回44.235.216.69。</li></ol><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff mv"><img src="../Images/8a96138e3404126085aafe88a3127b5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Bzgs1_GPe6itb6EvspRN_w.png"/></div></div></figure><p id="d246" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">要回答这个问题:这个IP地址44.235.216.69与cbridge-prod2.celer.network关联了很长一段时间，这一事实证明它属于官方的Celer Network服务器。Celer Network团队也证实了这一点。那么为什么会有一个伪造的证书与这个IP相关联呢？</p><p id="6bf4" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">如果您使用HTTPS协议进行通信，在没有获得证书的私钥的情况下，您无法加密/解密数据(包括客户端/服务器通信的数据)。因此，为了确保证书的正确性并能够实施中间人攻击，攻击者需要将权威机构申请的证书重新绑定到具有相同IP 44.235.216.69的恶意服务器上。这使得攻击者能够解密客户端的数据，并将恶意代码插入到响应数据包的数据中。</p><h2 id="02d1" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">分析结论</h2><p id="4984" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">我们与Celer Network团队合作调查了这次攻击。尽管事实上这是Celer网络上一次复杂的BGP劫持尝试，攻击者准备了从攻击时机、证书伪造、as控制和其他操作的一切。</p><p id="a6e1" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">最终，我们认识到许多项目已经意识到与BGP劫持攻击相关的风险，并采取了适当的预防措施。然而，许多人仍然没有意识到，特别是当涉及到由AS变化引起的网络路径修改时。如果没有足够的准备和响应措施，同一攻击者或其他攻击者发动进一步攻击的风险相当大。因此，我们敦促组织、ISP和服务器托管提供商认识到这种风险，并协调防御策略，以防止类似事件再次发生。和往常一样，如果您需要帮助，请联系SlowMist安全团队。</p><h2 id="9e2a" class="jb jc ht bd jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dt translated">附件</h2><p id="dc65" class="pw-post-body-paragraph jz ka ht kb b kc kd ke kf kg kh ki kj jm kk kl km jq kn ko kp ju kq kr ks kt hm dt translated">BGP劫持原理参考链接:<br/><a class="ae li" href="https://www.cloudflare.com/en-us/learning/security/glossary/bgp-hijacking/" rel="noopener ugc nofollow" target="_blank">https://www . cloud flare . com/en-us/learning/security/glossary/BGP-jacking/</a></p><p id="2b1d" class="pw-post-body-paragraph jz ka ht kb b kc ku ke kf kg kv ki kj jm kw kl km jq kx ko kp ju ky kr ks kt hm dt translated">cbridge-prod2.celer.network DNS图表:</p><figure class="la lb lc ld fq iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff lw"><img src="../Images/2d872d1bb8e3dfbc8dd38cc6f1b4bb67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iGp66wVLjL_d6KZnBOKuBA.png"/></div></div></figure><blockquote class="mw"><p id="3348" class="mx my ht bd mz na nb nc nd ne nf kt ek translated">交易新手？试试<a class="ae li" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">密码交易机器人</a>或者<a class="ae li" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>