<html>
<head>
<title>The unlimited approval feature helps save time and money on gas, but it was abused in the LiFi hack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无限制的批准功能有助于节省汽油的时间和金钱，但它在LiFi黑客中被滥用了</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/the-unlimited-approval-feature-helps-save-time-and-money-on-gas-but-it-was-abused-in-the-lifi-hack-5a2df40a65f2?source=collection_archive---------59-----------------------#2022-09-21">https://medium.com/coinmonks/the-unlimited-approval-feature-helps-save-time-and-money-on-gas-but-it-was-abused-in-the-lifi-hack-5a2df40a65f2?source=collection_archive---------59-----------------------#2022-09-21</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="338f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">通过LI，用户可以方便地在各种主要连锁店之间进行各种资产转移和交换。FI，一种高级桥接和分散交换(DEX)聚合器。对于DeFi开发者来说，将所有不同的桥集成到跨链去中心化应用程序(d apps)中是一个巨大的挑战。菲，你不需要理解那些桥的所有错综复杂。</p><p id="c2a6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">2022年3月20日，一名黑客利用交换功能，利用李。菲的智能合同。</p><p id="cbd5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">李。FI攻击是一个跨链桥漏洞，其根本原因是由于未经检查的外部调用。事实上，整个攻击相当简单，没有部署恶意的智能合约。同样缺席现场的还有闪贷。</p><p id="bd2f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">袭击者瞄准了李。菲的智能合同。该契约具有交换功能，允许在桥接之前进行交换。攻击者跳过交换，直接在LI的上下文中调用令牌契约。菲的智能合同。</p><p id="3fb0" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">攻击者可以设法击中29个钱包来偷钱。基于用户给予的具有无限批准的令牌契约，攻击者可以彻底搜查各种令牌。</p><p id="1765" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">攻击者只是调用了CBridgeFacet契约的swapAndStartBridgeTokensViaCBridge(0x 01 c0a 31 a)函数。因此，它将多个代币从不同的消费者转移到EOA。</p><p id="4553" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">智能路由发生在链外，可以为用户确定最佳路线。前端网站确定最佳路线，并将参数提供给swapAndStartBridgeTokensViaCBridge函数。</p><p id="0512" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">由于该函数不检查参数，包括白名单和互换滑动，LIFI项目不允许区块链上的任何帐户调用该函数。</p><p id="10ee" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">包含风险的部分是CBridgeFacet合同。通过这份合同，用户认可代币，将他们的钱置于风险之中。</p><p id="0517" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">用户调用了函数swapAnStartBridgeTokensViaCBridge并批准了令牌。不同令牌的transferFrom函数也会被调用，导致59.6万美元的损失。</p><p id="b175" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">以下令牌是被盗走的:贾维斯奖励令牌()，多边形(MATIC)，火箭池()，灵知()，系绳()，元宇宙指数()，奥迪斯(Audius)，AAVE (AAVE)，戴(戴)。</p><p id="cd4f" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">任何对合同给予无限赞同的人都变得脆弱。为了消除漏洞，该团队立即禁用了公司智能合同中的交换方法。</p><p id="2a1e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">分散化金融领域的这一黑客行为表明，给予智能合约无限批准会增加用户资金的风险。</p><p id="4507" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">这种利用再次说明了安全是最重要的。他们没有尽到个人责任，没有通过推迟完成审计来提供最大程度的安全。通过无限批准，用户可以无限制地交换硬币，而不必批准更多的交易。</p><blockquote class="jo"><p id="e197" class="jp jq ht bd jr js jt ju jv jw jx jn ek translated">交易新手？试试<a class="ae jy" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或者<a class="ae jy" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>