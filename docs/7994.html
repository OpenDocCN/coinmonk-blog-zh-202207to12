<html>
<head>
<title>Ethernaut Level 8 Vault [Foundry-Hardhat]</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">以太8级金库[铸造厂-安全帽]</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/ethernaut-level-8-vault-foundry-hardhat-ed135ba10978?source=collection_archive---------25-----------------------#2022-12-25">https://medium.com/coinmonks/ethernaut-level-8-vault-foundry-hardhat-ed135ba10978?source=collection_archive---------25-----------------------#2022-12-25</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><figure class="fi fk ir is it iu fe ff paragraph-image"><div role="button" tabindex="0" class="iv iw di ix bf iy"><div class="fe ff iq"><img src="../Images/69ba34bab550505e0c034c35d598a165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tvXlaDWxkMWp4tn4yLFYFg.png"/></div></div></figure><blockquote class="jb"><p id="8e39" class="jc jd ht bd je jf jg jh ji jj jk jl ek translated"><em class="jm"/><a class="ae jn" href="https://github.com/Chirag21/Ethernaut-solutions" rel="noopener ugc nofollow" target="_blank"><em class="jm">以太解决方案</em> </a> <em class="jm">库包含使用Foundry和Hardhat的解决方案。</em></p></blockquote><h1 id="bae4" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated">目标</h1><ul class=""><li id="ff18" class="km kn ht ko b kp kq kr ks kt ku kv kw kx ky jl kz la lb lc dt translated">解锁保险库以通过，即将<code class="eh ld le lf lg b">locked</code>存储变量设置为<code class="eh ld le lf lg b">false</code>。</li></ul></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><p id="d218" class="pw-post-body-paragraph lo lp ht ko b kp lq lr ls kr lt lu lv kt lw lx ly kv lz ma mb kx mc md me jl hm dt translated">每个智能合约都有自己的存储空间。存储是智能合约的永久数据存储。存储中的数据在不同的函数调用中保持不变。以太坊将数据存储在存储“<a class="ae jn" href="https://docs.soliditylang.org/en/latest/internals/layout_in_storage.html" rel="noopener ugc nofollow" target="_blank">槽</a>”中，这是32字节大小的槽。每次将变量保存到存储器时，它会自动占用序列中当前槽或下一个槽的剩余空间。数据按照声明的顺序存储在这些槽中。存储在区块链上的所有数据都是公开可见的；谁都可以看。</p><blockquote class="jb"><p id="6c58" class="jc jd ht bd je jf mf mg mh mi mj jl ek translated">从顶级交易者那里复制交易机器人。免费试用<a class="ae jn" href="https://coincodecap.com/go/pionex-coinmonks" rel="noopener ugc nofollow" target="_blank"/>。</p></blockquote><blockquote class="mk ml mm"><p id="38bd" class="lo lp mn ko b kp mo lr ls kr mp lu lv mq mr lx ly ms mt ma mb mu mv md me jl hm dt translated">将变量设为私有意味着它只能在声明它的契约中被访问；它不隐藏变量。</p></blockquote><p id="b739" class="pw-post-body-paragraph lo lp ht ko b kp lq lr ls kr lt lu lv kt lw lx ly kv lz ma mb kx mc md me jl hm dt translated">我们可以使用声明变量的槽号直接访问契约的存储。</p></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><h1 id="d4b5" class="jo jp ht bd jq jr mw jt ju jv mx jx jy jz my kb kc kd mz kf kg kh na kj kk kl dt translated">分析</h1><p id="da39" class="pw-post-body-paragraph lo lp ht ko b kp kq lr ls kr ks lu lv kt nb lx ly kv nc ma mb kx nd md me jl hm dt translated">看一下保险库合同。</p><pre class="ne nf ng nh fq ni lg nj bn nk nl bi"><span id="be2b" class="nm jp ht lg b be nn no l np nq">contract Vault {<br/>  bool public locked;          // slot 0<br/>  bytes32 private password;    // slot 1<br/><br/>  constructor(bytes32 _password) {<br/>    locked = true;<br/>    password = _password;<br/>  }<br/>  function unlock(bytes32 _password) public {<br/>    if (password == _password) {<br/>      locked = false;<br/>    }<br/>  }<br/>}</span></pre><p id="3c5e" class="pw-post-body-paragraph lo lp ht ko b kp lq lr ls kr lt lu lv kt lw lx ly kv lz ma mb kx mc md me jl hm dt translated">请注意，在保险存储合同中，密码存储在插槽1”的私有变量中。我们可以通过读取“插槽1”并调用<code class="eh ld le lf lg b">unlock()</code>函数来轻松获得密码，从而解锁金库。</p></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><h1 id="5fa9" class="jo jp ht bd jq jr mw jt ju jv mx jx jy jz my kb kc kd mz kf kg kh na kj kk kl dt translated">剥削</h1><ul class=""><li id="31e5" class="km kn ht ko b kp kq kr ks kt ku kv kw kx ky jl kz la lb lc dt translated">在浏览器上打开开发控制台。使用<a class="ae jn" href="https://web3js.readthedocs.io/en/v1.2.11/web3-eth.html#getstorageat" rel="noopener ugc nofollow" target="_blank"> </a> <code class="eh ld le lf lg b"><a class="ae jn" href="https://web3js.readthedocs.io/en/v1.2.11/web3-eth.html#getstorageat" rel="noopener ugc nofollow" target="_blank">web3.eth.getStorageAt()</a></code>获取密码。这将返回字节32形式的密码。</li></ul><pre class="ne nf ng nh fq ni lg nj bn nk nl bi"><span id="05ff" class="nm jp ht lg b be nn no l np nq">const password = await web3.eth.getStorageAt(instance,1)</span></pre><ul class=""><li id="f348" class="km kn ht ko b kp lq kr lt kt nr kv ns kx nt jl kz la lb lc dt translated">打开保险库</li></ul><pre class="ne nf ng nh fq ni lg nj bn nk nl bi"><span id="6945" class="nm jp ht lg b be nn no l np nq">await contract.unlock(password)</span></pre><ul class=""><li id="6cb5" class="km kn ht ko b kp lq kr lt kt nr kv ns kx nt jl kz la lb lc dt translated">要查看实际的密码，请使用十六进制到字符串的转换器。</li></ul><pre class="ne nf ng nh fq ni lg nj bn nk nl bi"><span id="f107" class="nm jp ht lg b be nn no l np nq">web3.utils.hexToAscii(password)</span></pre><p id="ead7" class="pw-post-body-paragraph lo lp ht ko b kp lq lr ls kr lt lu lv kt lw lx ly kv lz ma mb kx mc md me jl hm dt translated">该函数将字节32 <code class="eh ld le lf lg b">password</code>转换为人类可读的文本，从而显示<code class="eh ld le lf lg b">“A very strong secret password :)”</code>。</p><ul class=""><li id="7e5c" class="km kn ht ko b kp lq kr lt kt nr kv ns kx nt jl kz la lb lc dt translated">您可以通过读取插槽0来检查<code class="eh ld le lf lg b">locked</code>变量的值</li></ul><pre class="ne nf ng nh fq ni lg nj bn nk nl bi"><span id="9e7d" class="nm jp ht lg b be nn no l np nq">await web3.eth.getStorageAt(instance,0)  // returns false</span></pre><p id="a1fb" class="pw-post-body-paragraph lo lp ht ko b kp lq lr ls kr lt lu lv kt lw lx ly kv lz ma mb kx mc md me jl hm dt translated">提交实例。</p><p id="69c6" class="pw-post-body-paragraph lo lp ht ko b kp lq lr ls kr lt lu lv kt lw lx ly kv lz ma mb kx mc md me jl hm dt translated">关卡通过！！！😄</p></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><h1 id="ae48" class="jo jp ht bd jq jr mw jt ju jv mx jx jy jz my kb kc kd mz kf kg kh na kj kk kl dt translated">关键要点</h1><ul class=""><li id="e6c6" class="km kn ht ko b kp kq kr ks kt ku kv kw kx ky jl kz la lb lc dt translated">重要的是要记住，将变量标记为私有只会阻止其他契约访问它。标记为私有和局部变量的状态变量仍然可以公开访问。</li><li id="fb39" class="km kn ht ko b kp nu kr nv kt nw kv nx kx ny jl kz la lb lc dt translated">不要在智能合约中存储敏感数据。</li><li id="5862" class="km kn ht ko b kp nu kr nv kt nw kv nx kx ny jl kz la lb lc dt translated">当使用带有存储变量的契约的<a class="ae jn" rel="noopener" href="/coinmonks/ethernaut-lvl-7-walkthrough-how-to-selfdestruct-and-create-an-ether-blackhole-eb5bb72d2c57"> delegatecall </a>时，要小心数据损坏。</li><li id="63b3" class="km kn ht ko b kp nu kr nv kt nw kv nx kx ny jl kz la lb lc dt translated">私有函数和状态变量在派生契约中不可见；它们只能在定义它们的合同中访问。</li><li id="7f42" class="km kn ht ko b kp nu kr nv kt nw kv nx kx ny jl kz la lb lc dt translated">为了确保数据的私密性，需要在将数据放入区块链之前对其进行加密。在这种情况下，解密密钥不应该在链上发送，因为任何寻找它的人都会看到它。</li></ul></div><div class="ab cl lh li hb lj" role="separator"><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm ln"/><span class="lk bw bk ll lm"/></div><div class="hm hn ho hp hq"><blockquote class="jb"><p id="4f7e" class="jc jd ht bd je jf mf mg mh mi mj jl ek translated"><em class="jm"/><a class="ae jn" href="https://github.com/Chirag21/Ethernaut-solutions" rel="noopener ugc nofollow" target="_blank"><strong class="ak"><em class="jm">Ethernaut-Solutions</em></strong></a><em class="jm">资源库包含使用Foundry和Hardhat的解决方案。</em></p><p id="fbf4" class="jc jd ht bd je jf mf mg mh mi mj jl ek translated"><em class="jm">使用铸造厂的解决方案:- </em></p><p id="11f5" class="jc jd ht bd je jf mf mg mh mi mj jl ek translated"><a class="ae jn" href="https://github.com/Chirag21/Ethernaut-Solutions-using-Foundry-Hardhat/blob/main/test/foundry/8_Vault.t.sol" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> <em class="jm">测试</em></strong></a><strong class="ak"><em class="jm"/></strong><a class="ae jn" href="https://github.com/Chirag21/Ethernaut-Solutions-using-Foundry-Hardhat/blob/main/script/8_VaultScript.sol" rel="noopener ugc nofollow" target="_blank"><strong class="ak"><em class="jm">漏洞利用脚本</em> </strong> </a></p><p id="749f" class="jc jd ht bd je jf mf mg mh mi mj jl ek translated"><em class="jm">使用安全帽的解决方案:- </em></p><p id="b7ad" class="jc jd ht bd je jf mf mg mh mi mj jl ek translated"><a class="ae jn" href="https://github.com/Chirag21/Ethernaut-Solutions-using-Foundry-Hardhat/blob/main/test/hardhat/8_vault.test.ts" rel="noopener ugc nofollow" target="_blank"> <strong class="ak"> <em class="jm">测试</em></strong></a><strong class="ak"><em class="jm"/></strong><a class="ae jn" href="https://github.com/Chirag21/Ethernaut-Solutions-using-Foundry-Hardhat/blob/main/scripts/8_vault_exploit.ts" rel="noopener ugc nofollow" target="_blank"><strong class="ak"><em class="jm">漏洞利用脚本</em> </strong> </a></p></blockquote><figure class="oa ob oc od oe iu fe ff paragraph-image"><a href="https://www.buymeacoffee.com/0xcsp"><div class="fe ff nz"><img src="../Images/679392ad412abc67dd16f3b9fefa799d.png" data-original-src="https://miro.medium.com/v2/resize:fit:420/format:webp/1*769MixcK_s6-z4fwRrIpMQ.png"/></div></a></figure><h1 id="f9d9" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz of kb kc kd og kf kg kh oh kj kk kl dt translated">更多级别</h1><div class="oi oj fm fo ok ol"><a rel="noopener follow" target="_blank" href="/coinmonks/ethernaut-level-9-king-foundry-hardhat-528cea17a8b1"><div class="om ab ej"><div class="on ab oo cl cj op"><h2 class="bd hu fv z el oq eo ep or er et hs dt translated">以太9级王者[铸造-安全帽]</h2><div class="os l"><h3 class="bd b fv z el oq eo ep or er et ek translated">Ethernaut-Solutions存储库包含使用Foundry和Hardhat的解决方案。</h3></div><div class="ot l"><p class="bd b gc z el oq eo ep or er et ek translated">medium.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz iz ol"/></div></div></a></div><div class="oi oj fm fo ok ol"><a rel="noopener follow" target="_blank" href="/coinmonks/ethernaut-level-7-force-foundry-hardhat-581e92687422"><div class="om ab ej"><div class="on ab oo cl cj op"><h2 class="bd hu fv z el oq eo ep or er et hs dt translated">以太7级力量[铸造-安全帽]</h2><div class="os l"><h3 class="bd b fv z el oq eo ep or er et ek translated">Ethernaut-Solutions存储库包含使用Foundry和Hardhat的解决方案。</h3></div><div class="ot l"><p class="bd b gc z el oq eo ep or er et ek translated">medium.com</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz iz ol"/></div></div></a></div><blockquote class="jb"><p id="4274" class="jc jd ht bd je jf jg jh ji jj jk jl ek translated">加入Coinmonks <a class="ae jn" href="https://t.me/coincodecap" rel="noopener ugc nofollow" target="_blank">电报频道</a>和<a class="ae jn" href="https://www.youtube.com/c/coinmonks/videos" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解加密交易和投资</p></blockquote><h1 id="4189" class="jo jp ht bd jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl dt translated">另外，阅读</h1><ul class=""><li id="289c" class="km kn ht ko b kp kq kr ks kt ku kv kw kx ky jl kz la lb lc dt translated"><a class="ae jn" href="https://coincodecap.com/grid-trading" rel="noopener ugc nofollow" target="_blank">网格交易机器人</a> | <a class="ae jn" rel="noopener" href="/coinmonks/cryptohopper-review-a388ff5bae88"> Cryptohopper审查</a> | <a class="ae jn" href="https://coincodecap.com/bexplus-review" rel="noopener ugc nofollow" target="_blank"> Bexplus审查</a></li><li id="4dfd" class="km kn ht ko b kp nu kr nv kt nw kv nx kx ny jl kz la lb lc dt translated"><a class="ae jn" href="https://coincodecap.com/zero-fee-crypto-exchanges" rel="noopener ugc nofollow" target="_blank"> 7个最佳零费用加密交易平台</a></li><li id="e85c" class="km kn ht ko b kp nu kr nv kt nw kv nx kx ny jl kz la lb lc dt translated"><a class="ae jn" href="https://coincodecap.com/anny-trade-review" rel="noopener ugc nofollow" target="_blank">氹欞侊贸易评论</a> | <a class="ae jn" rel="noopener" href="/coinmonks/huobi-margin-trading-b3b06cdc1519">火币保证金交易</a></li><li id="dd76" class="km kn ht ko b kp nu kr nv kt nw kv nx kx ny jl kz la lb lc dt translated"><a class="ae jn" href="https://coincodecap.com/what-are-decentralized-exchanges" rel="noopener ugc nofollow" target="_blank">分散交易所</a> | <a class="ae jn" href="https://coincodecap.com/bitbns-fip" rel="noopener ugc nofollow" target="_blank">比特FIP </a> | <a class="ae jn" href="https://coincodecap.com/pionex-review-exchange-with-crypto-trading-bot" rel="noopener ugc nofollow" target="_blank"> Pionex评论</a></li><li id="37b6" class="km kn ht ko b kp nu kr nv kt nw kv nx kx ny jl kz la lb lc dt translated"><a class="ae jn" href="https://coincodecap.com/buy-crypto-with-credit-card" rel="noopener ugc nofollow" target="_blank">用信用卡购买密码的10个最佳地点</a></li></ul></div></div>    
</body>
</html>