<html>
<head>
<title>How to create donation system using web3.js and metamask on CSC</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在CSC上使用web3.js和metamask创建捐赠系统</h1>
<blockquote>原文：<a href="https://medium.com/coinmonks/how-to-create-donation-system-using-web3-js-and-metamask-on-csc-b4ee9837227e?source=collection_archive---------8-----------------------#2022-07-01">https://medium.com/coinmonks/how-to-create-donation-system-using-web3-js-and-metamask-on-csc-b4ee9837227e?source=collection_archive---------8-----------------------#2022-07-01</a></blockquote><div><div class="ef hh hi hj hk hl"/><div class="hm hn ho hp hq"><div class=""/><p id="7c1b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">嘿嘿嘿</p><p id="f3bf" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">0Xlive在这里</p><p id="316e" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">在本教程中，我们将使用web3.js和coinex智能链上的metamask为我们的网站创建一个捐赠系统。</p><figure class="jp jq jr js fq jt fe ff paragraph-image"><div role="button" tabindex="0" class="ju jv di jw bf jx"><div class="fe ff jo"><img src="../Images/a06978ee5f3898954c8e40fea3a34ff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oq89mdL4TwP-RpS_c_7Nkg.png"/></div></div><figcaption class="ka kb fg fe ff kc kd bd b be z ek">How to donate crypto source: coinbase.com</figcaption></figure><h2 id="f82a" class="ke kf ht bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky dt translated">Web3.js</h2><p id="70d4" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hm dt translated">这是以太坊兼容的<a class="ae le" href="https://github.com/ethereumproject/wiki/wiki/JavaScript-API" rel="noopener ugc nofollow" target="_blank"> JavaScript API </a>，它实现了<a class="ae le" href="https://github.com/ethereumproject/wiki/wiki/JSON-RPC" rel="noopener ugc nofollow" target="_blank">通用JSON RPC </a>规范。它以可嵌入js和meteor.js包的形式提供给component。</p><p id="a365" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将此内容放入head标记中以导入web3.js:</p><pre class="jp jq jr js fq lf lg lh li aw lj dt"><span id="2da4" class="ke kf ht lg b fv lk ll l lm ln"> <br/>&lt;script src=”https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.3/web3.min.js" integrity=”sha512-Ws+qbaGHSFw2Zc1e7XRpvW+kySrhmPLFYTyQ95mxAkss0sshj6ObdNP3HDWcwTs8zBJ60KpynKZywk0R8tG1GA==” crossorigin=”anonymous” referrerpolicy=”no-referrer”&gt;&lt;/script&gt;</span></pre><h2 id="67b0" class="ke kf ht bd kg kh ki kj kk kl km kn ko jb kp kq kr jf ks kt ku jj kv kw kx ky dt translated">donate.html</h2><p id="7181" class="pw-post-body-paragraph iq ir ht is b it kz iv iw ix la iz ja jb lb jd je jf lc jh ji jj ld jl jm jn hm dt translated">让我们创建一个名为donate.html的文件。我们将在此创建捐赠表格。</p><p id="5ce8" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们创建一个名为付款的部分:</p><pre class="jp jq jr js fq lf lg lh li aw lj dt"><span id="f526" class="ke kf ht lg b fv lk ll l lm ln">&lt;section id=”payment” class=”payment”&gt;&lt;/section&gt;</span></pre><p id="250d" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">将付款表格放入付款部分:</p><pre class="jp jq jr js fq lf lg lh li aw lj dt"><span id="22ec" class="ke kf ht lg b fv lk ll l lm ln">&lt;form class=”credit-card”&gt;</span><span id="512e" class="ke kf ht lg b fv lo ll l lm ln">&lt;div class=”form-header”&gt;</span><span id="0e73" class="ke kf ht lg b fv lo ll l lm ln">&lt;h4 class=”title”&gt;Payment&lt;/h4&gt;</span><span id="e2a8" class="ke kf ht lg b fv lo ll l lm ln">&lt;/div&gt;</span><span id="4a94" class="ke kf ht lg b fv lo ll l lm ln">&lt;div class=”form-body”&gt;</span><span id="37fa" class="ke kf ht lg b fv lo ll l lm ln">&lt;input class=”card-number” id=”Amount” type=”number” placeholder=”Amount”&gt;</span><span id="ed6c" class="ke kf ht lg b fv lo ll l lm ln">&lt;button class=”pay-button” type=”submit”&gt; &lt;a href=”#”&gt;Buy&lt;/a&gt;&lt;/button&gt;</span><span id="e5f5" class="ke kf ht lg b fv lo ll l lm ln">&lt;div id=”status”&gt;&lt;/div&gt;</span><span id="00f4" class="ke kf ht lg b fv lo ll l lm ln">&lt;/div&gt;</span><span id="1b98" class="ke kf ht lg b fv lo ll l lm ln">&lt;/form&gt;</span></pre><p id="38d5" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">让我们设置web3.js和metamask。打开<script>标签，输入以下代码:&lt;/root&gt;</script></p><pre class="jp jq jr js fq lf lg lh li aw lj dt"><span id="c478" class="ke kf ht lg b fv lk ll l lm ln">window.addEventListener('load', async () =&gt; {</span><span id="446e" class="ke kf ht lg b fv lo ll l lm ln">if (window.ethereum) {</span><span id="af68" class="ke kf ht lg b fv lo ll l lm ln">window.web3 = new Web3(ethereum);</span><span id="650b" class="ke kf ht lg b fv lo ll l lm ln">try {</span><span id="d7de" class="ke kf ht lg b fv lo ll l lm ln">await ethereum.eth_requestAccounts;</span><span id="67a9" class="ke kf ht lg b fv lo ll l lm ln">initPayButton()</span><span id="4bd7" class="ke kf ht lg b fv lo ll l lm ln">} catch (err) {</span><span id="37eb" class="ke kf ht lg b fv lo ll l lm ln">$('#status').html('User denied account access', err)</span><span id="4ba3" class="ke kf ht lg b fv lo ll l lm ln">}</span><span id="16c2" class="ke kf ht lg b fv lo ll l lm ln">} else if (window.web3) {</span><span id="a9fc" class="ke kf ht lg b fv lo ll l lm ln">window.web3 = new Web3(web3.currentProvider)</span><span id="d1b8" class="ke kf ht lg b fv lo ll l lm ln">initPayButton()</span><span id="ba84" class="ke kf ht lg b fv lo ll l lm ln">} else {</span><span id="2408" class="ke kf ht lg b fv lo ll l lm ln">$('#status').html('No Metamask (or other Web3 Provider) installed')</span><span id="f971" class="ke kf ht lg b fv lo ll l lm ln">}</span><span id="b414" class="ke kf ht lg b fv lo ll l lm ln">})</span></pre><p id="caa3" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">有一个向metamask提交数据的付费按钮。将此代码写入脚本标记:</p><pre class="jp jq jr js fq lf lg lh li aw lj dt"><span id="24e9" class="ke kf ht lg b fv lk ll l lm ln">const initPayButton = () =&gt; {</span><span id="d638" class="ke kf ht lg b fv lo ll l lm ln">$(‘.pay-button’).click(() =&gt; {</span><span id="f7a9" class="ke kf ht lg b fv lo ll l lm ln">const paymentAddress = ‘Enter Your Address’</span><span id="4e4e" class="ke kf ht lg b fv lo ll l lm ln">const amountEth = document.getElementById(“Amount”).value;</span><span id="d582" class="ke kf ht lg b fv lo ll l lm ln">web3.eth.sendTransaction({</span><span id="c3a1" class="ke kf ht lg b fv lo ll l lm ln">to: paymentAddress,</span><span id="5c61" class="ke kf ht lg b fv lo ll l lm ln">value: web3.toWei(amountEth, ‘ether’)</span><span id="b117" class="ke kf ht lg b fv lo ll l lm ln">}, (err, transactionId) =&gt; {</span><span id="8c38" class="ke kf ht lg b fv lo ll l lm ln">if (err) {</span><span id="7d17" class="ke kf ht lg b fv lo ll l lm ln">console.log(‘Payment failed’, err)</span><span id="2f91" class="ke kf ht lg b fv lo ll l lm ln">$(‘#status’).html(‘Payment failed’)</span><span id="3f00" class="ke kf ht lg b fv lo ll l lm ln">} else {</span><span id="45c0" class="ke kf ht lg b fv lo ll l lm ln">document.getElementById(“status”).innerHTML = transactionId;</span><span id="50a8" class="ke kf ht lg b fv lo ll l lm ln">$(‘#status’).html(‘Payment successful’)</span><span id="ddbb" class="ke kf ht lg b fv lo ll l lm ln">}</span><span id="ae36" class="ke kf ht lg b fv lo ll l lm ln">})</span><span id="7f3d" class="ke kf ht lg b fv lo ll l lm ln">})</span><span id="797e" class="ke kf ht lg b fv lo ll l lm ln">}</span></pre><p id="f403" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">恭喜你！</p><p id="f42b" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">我们已经使用js为我们的网站/博客创建了一个捐赠系统</p><p id="e786" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated">你也可以查看我之前关于csc加密支付系统的文章:</p><p id="51c6" class="pw-post-body-paragraph iq ir ht is b it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn hm dt translated"><a class="ae le" rel="noopener" href="/coinmonks/simple-crypto-payment-system-using-php-and-coinex-net-api-45d38cf2131">https://medium . com/coin monks/simple-crypto-payment-system-using-PHP-and-coinex-net-API-45d 38 cf 2131</a></p><blockquote class="lp lq lr"><p id="19da" class="iq ir ls is b it iu iv iw ix iy iz ja lt jc jd je lu jg jh ji lv jk jl jm jn hm dt translated">交易新手？尝试<a class="ae le" rel="noopener" href="/coinmonks/crypto-trading-bot-c2ffce8acb2a">加密交易机器人</a>或<a class="ae le" rel="noopener" href="/coinmonks/top-10-crypto-copy-trading-platforms-for-beginners-d0c37c7d698c">复制交易</a></p></blockquote></div></div>    
</body>
</html>